"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[204],{7678:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var s=i(9430);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}},9175:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"contributor-handbook","title":"Contributor Handbook","description":"This guide covers day-to-day development in the Idle Engine monorepo. Pair it","source":"@site/../../docs/contributor-handbook.md","sourceDirName":".","slug":"/contributor-handbook","permalink":"/Idle-Game-Engine/contributor-handbook","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/contributor-handbook.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Contributor Handbook","sidebar_position":2},"sidebar":"developerSidebar","previous":{"title":"Overview","permalink":"/Idle-Game-Engine/"},"next":{"title":"Role Index","permalink":"/Idle-Game-Engine/role-index"}}');var t=i(5270),r=i(7678);const o={title:"Contributor Handbook",sidebar_position:2},c="Contributor Handbook",d={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Pre-commit hooks",id:"pre-commit-hooks",level:2},{value:"Repository layout",id:"repository-layout",level:2},{value:"Common workflows",id:"common-workflows",level:2},{value:"Coding style",id:"coding-style",level:2},{value:"Type-only imports and exports",id:"type-only-imports-and-exports",level:3},{value:"Regenerate coverage report",id:"regenerate-coverage-report",level:3},{value:"Documentation contributions",id:"documentation-contributions",level:2},{value:"Documentation Infrastructure",id:"documentation-infrastructure",level:2},{value:"Pull request expectations",id:"pull-request-expectations",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"contributor-handbook",children:"Contributor Handbook"})}),"\n",(0,t.jsx)(n.p,{children:"This guide covers day-to-day development in the Idle Engine monorepo. Pair it\nwith the design documents linked throughout when you need deeper architectural\ncontext."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Node.js \u226520.10 (matches the docs site requirement; stay on the 20.x LTS stream)"}),"\n",(0,t.jsxs)(n.li,{children:["pnpm \u22658 (we track the exact version in ",(0,t.jsx)(n.code,{children:"packageManager"})," inside ",(0,t.jsx)(n.code,{children:"package.json"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Playwright system dependencies (",(0,t.jsx)(n.code,{children:"pnpm exec playwright install-deps"}),") on fresh\nLinux hosts before running accessibility smoke tests"]}),"\n",(0,t.jsxs)(n.li,{children:["Lefthook hooks (",(0,t.jsx)(n.code,{children:"pnpm prepare"}),") to ensure lint, test, and build checks run\nlocally before commits"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"pre-commit-hooks",children:"Pre-commit hooks"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Lefthook inspects staged files and only runs the commands they need:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"pnpm lint"}),", ",(0,t.jsx)(n.code,{children:"pnpm typecheck"}),", and ",(0,t.jsx)(n.code,{children:"pnpm build"})," fire when JavaScript/TypeScript\nworkspace code or shared config changes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"pnpm generate --check"})," runs for ",(0,t.jsx)(n.code,{children:"content/**"}),", content tooling, and schema\nupdates so packs stay fresh."]}),"\n",(0,t.jsxs)(n.li,{children:["Runtime/service changes trigger ",(0,t.jsx)(n.code,{children:"pnpm --filter @idle-engine/core --filter @idle-engine/social-service run --if-present test:ci"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Content pipeline changes trigger ",(0,t.jsx)(n.code,{children:"pnpm --filter @idle-engine/content-compiler --filter @idle-engine/content-schema --filter @idle-engine/content-sample --filter @idle-engine/content-validation-cli run --if-present test:ci"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Shell or a11y harness edits run ",(0,t.jsx)(n.code,{children:"pnpm --filter @idle-engine/a11y-smoke-tests run test:ci"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["The targeted markdown checks for ",(0,t.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines-design.md"}),"\nremain unchanged."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Typical warm-cache timings:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Docs-only commits finish in ~3s (doc lint only)."}),"\n",(0,t.jsx)(n.li,{children:"Core/runtime edits run lint/typecheck/build plus targeted Vitest in \u224817s."}),"\n",(0,t.jsx)(n.li,{children:"Content pack/schema edits (including property-based tests) finish in \u224826s."}),"\n",(0,t.jsxs)(n.li,{children:["Forced full runs (",(0,t.jsx)(n.code,{children:"pnpm exec lefthook run pre-commit --all-files --force"}),")\nstill execute the entire matrix (~3m40s) for comparison with CI."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"LEFTHOOK=0 git commit ..."})," sparingly when you must bypass hooks; CI still\nruns the full ",(0,t.jsx)(n.code,{children:"pnpm test:ci"})," matrix and remains the ultimate gate."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"repository-layout",children:"Repository layout"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/core"})," \u2014 deterministic runtime, command queue, telemetry"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/shell-web"})," \u2014 Vite/React shell that embeds the runtime worker"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/content-*"})," \u2014 declarative content DSL and sample packs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"services/"})," \u2014 backend experiments (leaderboards, guild services, auth)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tools/"})," \u2014 validation CLIs, a11y harnesses, and development helpers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"docs/"})," \u2014 design documents and the source for this documentation site"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.code,{children:"docs/implementation-plan.md"})," for the current roadmap and open milestones."]}),"\n",(0,t.jsx)(n.h2,{id:"common-workflows",children:"Common workflows"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# install dependencies\npnpm install\n\n# run the entire test matrix\npnpm test\n\n# focused package scripts\npnpm --filter @idle-engine/core test\npnpm --filter @idle-engine/shell-web dev\n\n# run accessibility smoke tests (headless)\npnpm test:a11y\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The accessibility workspace shells out to ",(0,t.jsx)(n.code,{children:"tools/a11y-smoke-tests/scripts/run-playwright.cjs"}),", which bootstraps both the Vite preview and dev servers with ",(0,t.jsx)(n.code,{children:"start-server-and-test"}),". Running ",(0,t.jsx)(n.code,{children:"pnpm exec playwright test"})," directly is still supported, but you must start the appropriate servers yourself\u2014otherwise the suite aborts early during the new server readiness check with guidance to use ",(0,t.jsx)(n.code,{children:"pnpm test:a11y"}),". When reusing a locally running ",(0,t.jsx)(n.code,{children:"pnpm dev"}),"/",(0,t.jsx)(n.code,{children:"pnpm preview"}),", point the harness at those ports via ",(0,t.jsx)(n.code,{children:"PLAYWRIGHT_DEV_PORT"}),"/",(0,t.jsx)(n.code,{children:"PLAYWRIGHT_PREVIEW_PORT"})," and export ",(0,t.jsx)(n.code,{children:"PLAYWRIGHT_A11Y_SKIP_BUILD=1"})," after the first build so the ",(0,t.jsx)(n.code,{children:"pretest"})," hook stops rebuilding the world each run."]}),"\n",(0,t.jsxs)(n.p,{children:["We use ",(0,t.jsx)(n.code,{children:"vitest-llm-reporter"}),", so test runs print a final JSON object. Avoid extra\nconsole output around that summary to keep downstream tooling happy."]}),"\n",(0,t.jsx)(n.h2,{id:"coding-style",children:"Coding style"}),"\n",(0,t.jsx)(n.h3,{id:"type-only-imports-and-exports",children:"Type-only imports and exports"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Always mark symbols that only exist during type-checking with ",(0,t.jsx)(n.code,{children:"import type"})," / ",(0,t.jsx)(n.code,{children:"export type"}),". The ESLint preset (",(0,t.jsx)(n.code,{children:"@idle-engine/config-eslint"}),") enforces ",(0,t.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/366",children:"issue #366"}),", so mixing runtime and type-only imports on the same line will fail lint."]}),"\n",(0,t.jsxs)(n.li,{children:["Keep runtime values in a dedicated ",(0,t.jsx)(n.code,{children:"import { ... }"})," statement and put types in a separate ",(0,t.jsx)(n.code,{children:"import type { ... }"})," statement so bundlers such as Vite/esbuild do not attempt to load phantom exports and break hot reloads."]}),"\n",(0,t.jsxs)(n.li,{children:["When you create a new ",(0,t.jsx)(n.code,{children:"tsconfig"}),", carry over ",(0,t.jsx)(n.code,{children:"verbatimModuleSyntax: true"})," and ",(0,t.jsx)(n.code,{children:"preserveValueImports: true"})," (see ",(0,t.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/367",children:"issue #367"}),") so TypeScript preserves the explicit syntax instead of rewriting the statements during emit."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// \u2705 Do: value imports stay live, types are marked as such.\nimport { useEffect } from 'react';\nimport type { ResourceDefinition } from '@idle-engine/core';\n\nexport type { ResourceDefinition } from '@idle-engine/core';\n\nexport function useResource(def: ResourceDefinition) {\n  useEffect(() => {\n    /* ... */\n  }, [def.id]);\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// \ud83d\udeab Don't: bundlers will expect a runtime ResourceDefinition export.\nimport { useEffect, ResourceDefinition } from '@idle-engine/core';\n\nexport { ResourceDefinition } from '@idle-engine/core';\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The deterministic runtime never ships type metadata, so the \u201cdon\u2019t\u201d example\nwill surface ",(0,t.jsx)(n.code,{children:"ResourceDefinition is not exported"})," errors at runtime even though\nTypeScript accepts the code. Following the explicit type-only pattern keeps Vite\nand esbuild aligned with ",(0,t.jsx)(n.code,{children:"tsc"}),", avoids unused import churn, and documents intent\nfor future contributors skimming barrel files."]}),"\n",(0,t.jsx)(n.h3,{id:"regenerate-coverage-report",children:"Regenerate coverage report"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Run ",(0,t.jsx)(n.code,{children:"pnpm coverage:md"})," from the repository root after changing tests. The command executes coverage-enabled Vitest suites for every package and rewrites ",(0,t.jsx)(n.code,{children:"docs/coverage/index.md"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Commit the updated ",(0,t.jsx)(n.code,{children:"docs/coverage/index.md"})," file alongside your code so CI stays in sync with the documentation site."]}),"\n",(0,t.jsxs)(n.li,{children:["The generated page surfaces under ",(0,t.jsx)(n.strong,{children:"Diagnostics & Quality \u2192 Coverage Report"})," in the Docusaurus sidebar."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"documentation-contributions",children:"Documentation contributions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Add or update design docs alongside code changes."}),"\n",(0,t.jsxs)(n.li,{children:["Reference the relevant doc in your PR description (",(0,t.jsx)(n.code,{children:"docs/runtime-step-lifecycle.md"}),"\nfor lifecycle updates, etc.)."]}),"\n",(0,t.jsxs)(n.li,{children:["Keep sections deterministic by including reproduction steps or validation\ncommands (",(0,t.jsx)(n.code,{children:"pnpm test --filter <pkg>"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["Draft new proposals using ",(0,t.jsx)(n.code,{children:"docs/design-document-template.md"})," and migrate older\nspecs into that format when making substantial edits."]}),"\n",(0,t.jsxs)(n.li,{children:["When editing ",(0,t.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines-design.md"}),", run\n",(0,t.jsx)(n.code,{children:"pnpm --filter @idle-engine/docs lint"})," (or the underlying\n",(0,t.jsx)(n.code,{children:"pnpm exec markdownlint"})," / ",(0,t.jsx)(n.code,{children:"markdown-link-check"})," commands) so the markdownlint\nand link checks pass locally; Lefthook enforces the same guardrails pre-commit."]}),"\n",(0,t.jsxs)(n.li,{children:["Propose substantial architecture changes through the RFC process described in\n",(0,t.jsx)(n.code,{children:"docs/implementation-plan.md"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"documentation-infrastructure",children:"Documentation Infrastructure"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/Idle-Game-Engine/docs-hosting-recommendation",children:"Documentation Hosting Recommendation"})," - Evaluation and recommendation for hosting the public documentation site"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"pull-request-expectations",children:"Pull request expectations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Follow Conventional Commit prefixes (",(0,t.jsx)(n.code,{children:"feat:"}),", ",(0,t.jsx)(n.code,{children:"fix:"}),", ",(0,t.jsx)(n.code,{children:"chore:"}),"\u2026)"]}),"\n",(0,t.jsxs)(n.li,{children:["Include test commands executed (Vitest filters, ",(0,t.jsx)(n.code,{children:"pnpm test:a11y"}),", etc.)"]}),"\n",(0,t.jsxs)(n.li,{children:["Attach screenshots or recordings when touching ",(0,t.jsx)(n.code,{children:"packages/shell-web"})]}),"\n",(0,t.jsx)(n.li,{children:"Note known gaps so follow-up work is clear to reviewers"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Questions? Start a discussion on the issue tracker or tag the feature owner\nlisted in the relevant design doc."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);