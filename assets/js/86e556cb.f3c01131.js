"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[793],{7678:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(9430);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},8008:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"runtime-event-manifest-authoring","title":"Runtime Event Manifest Authoring","description":"Content packs extend the runtime event catalogue through offline manifests that are merged during pnpm generate. This guide outlines the contract for pack maintainers and the guarantees enforced by the build tooling.","source":"@site/../../docs/runtime-event-manifest-authoring.md","sourceDirName":".","slug":"/runtime-event-manifest-authoring","permalink":"/Idle-Game-Engine/runtime-event-manifest-authoring","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/runtime-event-manifest-authoring.md","tags":[],"version":"current","frontMatter":{},"sidebar":"developerSidebar","previous":{"title":"Decision Record: Runtime Event Bus Follow-ups","permalink":"/Idle-Game-Engine/runtime-event-bus-decisions"},"next":{"title":"Tick Accumulator Edge Case Coverage","permalink":"/Idle-Game-Engine/tick-accumulator-coverage-design"}}');var s=t(5270),r=t(7678);const a={},o="Runtime Event Manifest Authoring",c={},d=[{value:"Manifest layout",id:"manifest-layout",level:2},{value:"Generation workflow",id:"generation-workflow",level:2},{value:"Outputs and consumption",id:"outputs-and-consumption",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"runtime-event-manifest-authoring",children:"Runtime Event Manifest Authoring"})}),"\n",(0,s.jsxs)(n.p,{children:["Content packs extend the runtime event catalogue through offline manifests that are merged during ",(0,s.jsx)(n.code,{children:"pnpm generate"}),". This guide outlines the contract for pack maintainers and the guarantees enforced by the build tooling."]}),"\n",(0,s.jsx)(n.h2,{id:"manifest-layout",children:"Manifest layout"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each pack ships a ",(0,s.jsx)(n.code,{children:"content/event-types.json"})," manifest describing the events it owns."]}),"\n",(0,s.jsxs)(n.li,{children:["Entries are grouped by ",(0,s.jsx)(n.code,{children:"packSlug"})," and contain:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"namespace"})," \u2013 short identifier for the domain (e.g. ",(0,s.jsx)(n.code,{children:"sample"})," or ",(0,s.jsx)(n.code,{children:"automation"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"})," \u2013 event name within that namespace"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"version"})," \u2013 positive integer bumped when payload compatibility changes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"schema"})," \u2013 relative path to a JSON Schema file validating the payload"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Example (",(0,s.jsx)(n.code,{children:"packages/content-sample/content/event-types.json"}),"):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "packSlug": "sample-pack",\n  "eventTypes": [\n    {\n      "namespace": "sample",\n      "name": "reactor-primed",\n      "version": 1,\n      "schema": "./schemas/events/reactor-primed.schema.json"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"generation-workflow",children:"Generation workflow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Update the manifest and referenced schema files inside the content package."}),"\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"pnpm generate"})," from the repository root."]}),"\n",(0,s.jsxs)(n.li,{children:["Commit the regenerated outputs:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"packages/core/src/events/runtime-event-manifest.generated.ts"})}),"\n",(0,s.jsx)(n.li,{children:"any updated schema files or manifests inside the content package"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["(Optional) Filtered sample exports such as ",(0,s.jsx)(n.code,{children:"sampleEventDefinitions"})," can keep demos aligned with the generated catalogue."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The generator sorts content definitions by ",(0,s.jsx)(n.code,{children:"(packSlug, namespace:name)"})," and merges them with the core event catalogue. It recomputes the manifest hash using the same FNV-1a algorithm shipped in the runtime. The hash is embedded in:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"event frames captured by the command recorder"}),"\n",(0,s.jsx)(n.li,{children:"replay validation checkpoints"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If the runtime attempts to record or replay events with a different hash, it fails fast with guidance to rerun ",(0,s.jsx)(n.code,{children:"pnpm generate"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"outputs-and-consumption",children:"Outputs and consumption"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ContentRuntimeEventType"})," extends the core ",(0,s.jsx)(n.code,{children:"RuntimeEventType"})," union so content code can type-check event identifiers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"CONTENT_EVENT_CHANNELS"})," augments the event bus configuration; the runtime appends these channels automatically when building the registry."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GENERATED_RUNTIME_EVENT_DEFINITIONS"})," lists the merged catalogue with channel numbers, source packs, and schema references for tooling or documentation."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Run ",(0,s.jsx)(n.code,{children:"pnpm --filter @idle-engine/core test"})," after generation to confirm the deterministic manifest hash is recognised by the recorder."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);