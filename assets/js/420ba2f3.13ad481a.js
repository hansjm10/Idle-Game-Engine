"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[8203],{7678:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var s=i(9430);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}},9855:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"runtime-event-bus-decisions","title":"Runtime Event Bus Follow-up Decisions","description":"Use this document to understand the final architectural decisions made for the runtime event bus feature, particularly regarding event registration, dispatch ordering, diagnostics throttling, and transport format optimization.","source":"@site/../../docs/runtime-event-bus-decisions.md","sourceDirName":".","slug":"/runtime-event-bus-decisions","permalink":"/Idle-Game-Engine/runtime-event-bus-decisions","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/runtime-event-bus-decisions.md","tags":[],"version":"current","frontMatter":{"title":"Runtime Event Bus Follow-up Decisions"},"sidebar":"developerSidebar","previous":{"title":"Runtime Event Pub/Sub Design","permalink":"/Idle-Game-Engine/runtime-event-pubsub-design"},"next":{"title":"Runtime Event Manifest Authoring","permalink":"/Idle-Game-Engine/runtime-event-manifest-authoring"}}');var t=i(5270),r=i(7678);const l={title:"Runtime Event Bus Follow-up Decisions"},o="Runtime Event Bus Follow-up Decisions",d={},a=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2},{value:"Consequences",id:"consequences",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"runtime-event-bus-follow-up-decisions",children:"Runtime Event Bus Follow-up Decisions"})}),"\n",(0,t.jsx)(n.p,{children:"Use this document to understand the final architectural decisions made for the runtime event bus feature, particularly regarding event registration, dispatch ordering, diagnostics throttling, and transport format optimization."}),"\n",(0,t.jsx)(n.h2,{id:"document-control",children:"Document Control"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Title"}),": Runtime Event Bus Follow-up Decisions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authors"}),": TODO"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reviewers"}),": TODO"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Status"}),": Accepted"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Last Updated"}),": 2025-10-16"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Related Issues"}),": Issue #87, docs/runtime-event-pubsub-design.md, Issue #8"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Execution Mode"}),": Manual"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,t.jsx)(n.p,{children:"This document captures the final architectural decisions for four critical areas of the runtime event bus implementation: (1) auto-registration of content-pack-defined events without destabilizing replay manifests, (2) dispatch ordering guarantees and priority tier requirements, (3) diagnostic throttling policies for soft-limit warnings, and (4) validation of the struct-of-arrays transport format. These decisions establish a stable contract for downstream work and ensure the event bus is production-ready while maintaining deterministic replay, extensibility, and performance."}),"\n",(0,t.jsx)(n.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Background"}),": The runtime event bus design introduced in issue #8 provided the foundation for a deterministic event system but left four areas open for validation before production readiness could be confirmed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Four specific aspects required resolution:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"How to allow content packs to define events without destabilizing replay manifests"}),"\n",(0,t.jsx)(n.li,{children:"Whether priority tiers are needed to guarantee dispatch ordering for urgent channels"}),"\n",(0,t.jsx)(n.li,{children:"How to throttle soft-limit diagnostics to keep warnings actionable while respecting channel-specific thresholds"}),"\n",(0,t.jsx)(n.li,{children:"Whether the struct-of-arrays transport remains optimal or if a fallback is needed for sparse workloads"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Forces"}),": Deterministic replay equivalence must be preserved, content pack extensibility is required, diagnostic noise must be controlled, and transport efficiency must be balanced against complexity."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Goals"}),":","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Enable content packs to declare custom events without breaking replay determinism"}),"\n",(0,t.jsx)(n.li,{children:"Define clear dispatch ordering guarantees for the event bus"}),"\n",(0,t.jsx)(n.li,{children:"Implement actionable diagnostic throttling that prevents telemetry overload"}),"\n",(0,t.jsx)(n.li,{children:"Validate or provide alternatives to the struct-of-arrays transport format"}),"\n",(0,t.jsx)(n.li,{children:"Establish a stable contract for downstream work"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Non-Goals"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Runtime event registration (forbidden to preserve determinism)"}),"\n",(0,t.jsx)(n.li,{children:"Priority tier implementation (deferred due to complexity)"}),"\n",(0,t.jsx)(n.li,{children:"Changing the fundamental event bus architecture"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primary Stakeholders"}),": Runtime team, content pack authors, tooling maintainers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Agent Roles"}),": N/A (manual execution)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Affected Packages/Services"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/core"})," (event bus implementation)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/content-sample"})," (example event manifest)"]}),"\n",(0,t.jsx)(n.li,{children:"Content schema CLI tooling"}),"\n",(0,t.jsx)(n.li,{children:"Runtime exporter and telemetry adapter"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Compatibility Considerations"}),": Replay manifests must remain stable; event type union generation must be deterministic; telemetry format is extensible"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,t.jsx)(n.p,{children:"The runtime event bus introduced in issue #8 provides the foundational architecture for deterministic event publishing and subscription. The system supports channel-based organization and maintains FIFO ordering within ticks. However, four specific areas were left open pending validation: content pack event registration strategy, priority tier requirements, diagnostic throttling implementation, and transport format optimization for varying workload densities."}),"\n",(0,t.jsx)(n.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,t.jsx)(n.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Narrative"}),": The solution consists of four independent decisions that together complete the runtime event bus contract. Content packs declare events through schema-backed manifests processed during the build pipeline. The bus maintains a single FIFO queue per tick without priority tiers, relying on publish-time ordering. Diagnostics use channel-scoped throttling with exponential backoff to control warning frequency. The transport format remains struct-of-arrays with automatic fallback to object arrays when workload density drops below defined thresholds."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Diagram"}),": N/A"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Runtime Changes"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event Registration"}),": Content packs declare events in manifests during offline build. Build tooling emits deterministic manifest ordered by ",(0,t.jsx)(n.code,{children:"(packSlug, eventKey)"})," and generates TypeScript declarations for the ",(0,t.jsx)(n.code,{children:"RuntimeEventType"})," union. Replays key off ",(0,t.jsx)(n.code,{children:"(packSlug, eventKey, version)"})," tuple and refuse to load if manifest hash changes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dispatch Ordering"}),": Single FIFO queue per tick. No priority tiers. Dispatcher processes listeners in subscription registration order. Systems requiring earlier reactions must publish earlier or subscribe to pre-commit hooks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Diagnostic Throttling"}),": ",(0,t.jsx)(n.code,{children:"EventDiagnostics"})," helpers rate-limit soft-limit warnings per channel. Each channel configures ",(0,t.jsx)(n.code,{children:"maxEventsPerTick"}),", ",(0,t.jsx)(n.code,{children:"maxEventsPerSecond"}),", and optional ",(0,t.jsx)(n.code,{children:"cooldownTicks"}),". Exponential backoff between warnings. Hard limits throw immediately."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transport Format"}),": Struct-of-arrays primary format. Fallback to JSON object array when average frame density drops below 2 events per channel over rolling 256-tick window. Feature-flagged via ",(0,t.jsx)(n.code,{children:"EventBusOptions.frameExport.autoFallback.enabled"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Data & Schemas"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Content pack manifests include ",(0,t.jsx)(n.code,{children:"eventTypes"})," entries with ",(0,t.jsx)(n.code,{children:"namespace"}),", ",(0,t.jsx)(n.code,{children:"name"}),", ",(0,t.jsx)(n.code,{children:"version"}),", and schema reference"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"RuntimeEventFrame"})," payloads include ",(0,t.jsx)(n.code,{children:"format"})," discriminator and optional ",(0,t.jsx)(n.code,{children:"diagnostics"})," block"]}),"\n",(0,t.jsxs)(n.li,{children:["Object-array exports provide ",(0,t.jsx)(n.code,{children:"events[]"})," records instead of typed arrays"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"APIs & Contracts"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"EventBus.getFrameExportState()"})," exposes rolling window, density threshold, and active format"]}),"\n",(0,t.jsxs)(n.li,{children:["Telemetry emits ",(0,t.jsx)(n.code,{children:"EventSoftLimitBreach"})," warnings and ",(0,t.jsx)(n.code,{children:"RuntimeEventFrameFormatChanged"})," events"]}),"\n",(0,t.jsxs)(n.li,{children:["Metrics counters: ",(0,t.jsx)(n.code,{children:"events.soft_limit_breaches"}),", ",(0,t.jsx)(n.code,{children:"events.cooldown_ticks"})]}),"\n",(0,t.jsxs)(n.li,{children:["Prometheus metrics: ",(0,t.jsx)(n.code,{children:"idle_engine_events_soft_limit_breaches_total"}),", ",(0,t.jsx)(n.code,{children:"idle_engine_events_soft_limit_cooldown_ticks"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tooling & Automation"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Content schema CLI extended to merge ",(0,t.jsx)(n.code,{children:"eventTypes"})," during ",(0,t.jsx)(n.code,{children:"pnpm generate"})]}),"\n",(0,t.jsxs)(n.li,{children:["Benchmark suite under ",(0,t.jsx)(n.code,{children:"packages/core/benchmarks"})," for format comparison"]}),"\n",(0,t.jsxs)(n.li,{children:["Run via ",(0,t.jsx)(n.code,{children:"pnpm --filter @idle-engine/core run benchmark"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Deployment"}),": N/A (design decisions)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Telemetry & Observability"}),": Aggregate counters prevent log spam. Cooldown gauges feed Prometheus. Format change warnings signal when fallback activates."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Security & Compliance"}),": N/A"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,t.jsx)(n.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Issue Title"}),(0,t.jsx)(n.th,{children:"Scope Summary"}),(0,t.jsx)(n.th,{children:"Proposed Assignee/Agent"}),(0,t.jsx)(n.th,{children:"Dependencies"}),(0,t.jsx)(n.th,{children:"Acceptance Criteria"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Update content tooling for event manifests"}),(0,t.jsxs)(n.td,{children:["Extend CLI to accept ",(0,t.jsx)(n.code,{children:"eventTypes"})," and emit TypeScript union"]}),(0,t.jsx)(n.td,{children:"Manual"}),(0,t.jsx)(n.td,{children:"This design approval"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"packages/content-sample"})," reference config; generation stable"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Implement diagnostic helpers"}),(0,t.jsxs)(n.td,{children:["Wire ",(0,t.jsx)(n.code,{children:"EventDiagnostics"})," into event bus exporter"]}),(0,t.jsx)(n.td,{children:"Manual"}),(0,t.jsx)(n.td,{children:"This design approval"}),(0,t.jsx)(n.td,{children:"Tests cover throttling; telemetry adapter connected"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Add benchmark and test coverage"}),(0,t.jsx)(n.td,{children:"Verify queue ordering, throttling, serialization toggle"}),(0,t.jsx)(n.td,{children:"Manual"}),(0,t.jsx)(n.td,{children:"Event bus landed"}),(0,t.jsx)(n.td,{children:"Benchmarks in CI; tests pass"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Phase 1"}),": Content tooling update and diagnostic implementation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Phase 2"}),": Benchmark coverage and documentation updates"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hand-off Package"}),": Reference ",(0,t.jsx)(n.code,{children:"docs/runtime-event-manifest-authoring.md"})," for manifest format"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Communication Cadence"}),": Standard review workflow"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Context Packets"}),": N/A"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Prompting & Constraints"}),": N/A"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Safety Rails"}),": Runtime registration is forbidden to preserve determinism"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validation Hooks"}),": N/A"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Priority Tiers"}),": Rejected due to complexity and determinism concerns. Systems needing earlier reactions must publish earlier or use pre-commit hooks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Runtime Registration"}),": Rejected to preserve replay determinism. All events must be declared at build time."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Always-on Object Array Format"}),": Rejected because struct-of-arrays performs better for dense workloads. Fallback provides escape hatch for sparse scenarios."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Unit / Integration"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Test fixtures cover deterministic ordering contract"}),"\n",(0,t.jsx)(n.li,{children:"Focused tests for diagnostic throttling in bus package"}),"\n",(0,t.jsx)(n.li,{children:"Format branching validation for consumers"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Benchmarks compare struct-of-arrays vs object-array representations"}),"\n",(0,t.jsx)(n.li,{children:"Dense and sparse workload timing in CI logs"}),"\n",(0,t.jsx)(n.li,{children:"Rolling window density monitoring"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Tooling / A11y"}),": N/A"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Risk"}),(0,t.jsx)(n.th,{children:"Mitigation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Content packs may not adopt manifest format"}),(0,t.jsxs)(n.td,{children:["Provide clear reference implementation in ",(0,t.jsx)(n.code,{children:"packages/content-sample"})," and authoring documentation"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Diagnostic throttling may suppress important warnings"}),(0,t.jsx)(n.td,{children:"Exponential backoff balances noise vs visibility; telemetry counters enable alerting"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Struct-of-arrays may underperform for sparse workloads"}),(0,t.jsx)(n.td,{children:"Automatic fallback with feature flag and density monitoring provides escape hatch"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Lack of priority tiers may cause ordering issues"}),(0,t.jsx)(n.td,{children:"Document sequencing expectations and audit initial consumers"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Milestones"}),": See section 7.2"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Migration Strategy"}),": N/A (new feature decisions)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Communication"}),": Document manifest authoring flow and shell transport guide updates"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,t.jsx)(n.p,{children:"None. All four decision areas have been resolved."}),"\n",(0,t.jsx)(n.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Extend content schema CLI to merge ",(0,t.jsx)(n.code,{children:"eventTypes"})," during ",(0,t.jsx)(n.code,{children:"pnpm generate"})," (owner: tooling team)"]}),"\n",(0,t.jsxs)(n.li,{children:["Document manifest format in ",(0,t.jsx)(n.code,{children:"docs/runtime-event-manifest-authoring.md"})," (owner: docs)"]}),"\n",(0,t.jsx)(n.li,{children:"Wire diagnostic struct into telemetry adapter (owner: runtime team)"}),"\n",(0,t.jsx)(n.li,{children:"Add benchmark coverage for both transport formats (owner: runtime team)"}),"\n",(0,t.jsx)(n.li,{children:"Document frame export flag in shell transport guide (owner: docs)"}),"\n",(0,t.jsx)(n.li,{children:"Audit initial consumers to ensure no implied priority dependencies (owner: runtime team)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"15-references",children:"15. References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"docs/runtime-event-pubsub-design.md"})," - Original event bus design"]}),"\n",(0,t.jsx)(n.li,{children:"Issue #8 - Initial runtime event bus implementation"}),"\n",(0,t.jsx)(n.li,{children:"Issue #87 - Follow-up validation work"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"packages/core/benchmarks"})," - Transport format benchmarks"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"docs/runtime-event-manifest-authoring.md"})," - Manifest authoring guide (to be created)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"FIFO"}),": First-In-First-Out queue ordering"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Struct-of-arrays"}),": Data layout where each field is stored in a separate array, optimized for dense workloads"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Soft limit"}),": Configurable threshold that triggers warnings but does not halt execution"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hard limit"}),": Threshold that throws determinism-breaking errors immediately"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Replay manifest"}),": Deterministic record of events keyed by ",(0,t.jsx)(n.code,{children:"(packSlug, eventKey, version)"})," tuple"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Content pack"}),": Modular game content that can extend the engine's event taxonomy"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Date"}),(0,t.jsx)(n.th,{children:"Author"}),(0,t.jsx)(n.th,{children:"Change Summary"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"2025-10-16"}),(0,t.jsx)(n.td,{children:"TODO"}),(0,t.jsx)(n.td,{children:"Initial decision record"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"2025-12-21"}),(0,t.jsx)(n.td,{children:"Claude Opus 4.5"}),(0,t.jsx)(n.td,{children:"Migrated to template format"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"consequences",children:"Consequences"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Content packs gain a predictable path to extend the event taxonomy without risking replay drift, but they must participate in the generation pipeline."}),"\n",(0,t.jsx)(n.li,{children:"Consumers can rely on strict FIFO ordering, which simplifies tests, though special-case preemption must be handled within publishers themselves."}),"\n",(0,t.jsx)(n.li,{children:"Diagnostics are actionable without overwhelming telemetry sinks, and the rate limiter parameters can evolve per channel as new systems come online."}),"\n",(0,t.jsx)(n.li,{children:"The transport remains optimized for dense workloads while providing metrics and guard rails to detect when a simpler format would be preferable."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);