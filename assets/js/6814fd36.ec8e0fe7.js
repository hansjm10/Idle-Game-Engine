"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[2179],{6635:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content-dsl-usage-guidelines","title":"Content DSL Usage Guidelines","description":"Prescriptive workflow for building, validating, and shipping Idle Engine content packs.","source":"@site/../../docs/content-dsl-usage-guidelines.md","sourceDirName":".","slug":"/content-dsl-usage-guidelines","permalink":"/Idle-Game-Engine/content-dsl-usage-guidelines","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/content-dsl-usage-guidelines.md","tags":[],"version":"current","frontMatter":{"title":"Content DSL Usage Guidelines","description":"Prescriptive workflow for building, validating, and shipping Idle Engine content packs."},"sidebar":"developerSidebar","previous":{"title":"Content DSL Schema Design","permalink":"/Idle-Game-Engine/content-dsl-schema-design"},"next":{"title":"Content Compiler Design","permalink":"/Idle-Game-Engine/content-compiler-design"}}');var d=s(5270),r=s(7678);const t={title:"Content DSL Usage Guidelines",description:"Prescriptive workflow for building, validating, and shipping Idle Engine content packs."},c=void 0,l={},o=[{value:"Pipeline Overview",id:"pipeline-overview",level:2},{value:"Pack Scaffolding",id:"pack-scaffolding",level:2},{value:"Author checklist",id:"author-checklist",level:3},{value:"Sample pack (prestige + balance) reference",id:"sample-pack-prestige--balance-reference",level:3},{value:"Content Authoring Guide",id:"content-authoring-guide",level:2},{value:"Authoring with TypeScript factories",id:"authoring-with-typescript-factories",level:3},{value:"Content type reference",id:"content-type-reference",level:3},{value:"Resources",id:"resources",level:4},{value:"Entities",id:"entities",level:4},{value:"Generators",id:"generators",level:4},{value:"Upgrades",id:"upgrades",level:4},{value:"Achievements",id:"achievements",level:4},{value:"Automations",id:"automations",level:4},{value:"Prestige layers",id:"prestige-layers",level:4},{value:"Metrics",id:"metrics",level:4},{value:"Transforms",id:"transforms",level:4},{value:"Conditions and formulas",id:"conditions-and-formulas",level:3},{value:"Condition kinds",id:"condition-kinds",level:4},{value:"Formula kinds",id:"formula-kinds",level:4},{value:"Effects system (upgrades + generator effects)",id:"effects-system-upgrades--generator-effects",level:3},{value:"Authoring gotchas",id:"authoring-gotchas",level:3},{value:"Example packs",id:"example-packs",level:3},{value:"Naming Conventions",id:"naming-conventions",level:2},{value:"Naming checklist",id:"naming-checklist",level:3},{value:"Offline Progression Fast Path",id:"offline-progression-fast-path",level:2},{value:"Declaring Dependencies",id:"declaring-dependencies",level:2},{value:"Dependency checklist",id:"dependency-checklist",level:3},{value:"Dependency compatibility matrix",id:"dependency-compatibility-matrix",level:3},{value:"Versioning &amp; Release Cadence",id:"versioning--release-cadence",level:2},{value:"Versioning checklist",id:"versioning-checklist",level:3},{value:"Compatibility Triage",id:"compatibility-triage",level:2},{value:"Compatibility checklist",id:"compatibility-checklist",level:3},{value:"Migration matrix",id:"migration-matrix",level:3},{value:"Transform Runtime Semantics",id:"transform-runtime-semantics",level:2},{value:"Trigger kinds",id:"trigger-kinds",level:3},{value:"Mode semantics",id:"mode-semantics",level:3},{value:"Mission semantics (mission-mode transforms)",id:"mission-semantics-mission-mode-transforms",level:3},{value:"Cooldowns and safety limits",id:"cooldowns-and-safety-limits",level:3},{value:"Unlock and visibility",id:"unlock-and-visibility",level:3},{value:"Formula evaluation guardrails",id:"formula-evaluation-guardrails",level:3},{value:"Limitations and follow-ups",id:"limitations-and-follow-ups",level:3},{value:"Transform Patterns &amp; Cycle Detection",id:"transform-patterns--cycle-detection",level:2},{value:"What Constitutes a Cycle",id:"what-constitutes-a-cycle",level:3},{value:"Safe Transform Patterns",id:"safe-transform-patterns",level:3},{value:"\u2705 Linear transformation chains",id:"-linear-transformation-chains",level:4},{value:"\u2705 Resource sinks (consumables)",id:"-resource-sinks-consumables",level:4},{value:"\u2705 Convergent production trees",id:"-convergent-production-trees",level:4},{value:"\u2705 Lossy exchange loops (allowed)",id:"-lossy-exchange-loops-allowed",level:4},{value:"\u274c Net-positive transform cycles",id:"-net-positive-transform-cycles",level:4},{value:"Safe Unlock Condition Patterns",id:"safe-unlock-condition-patterns",level:3},{value:"\u2705 Self-threshold (unlock after first production)",id:"-self-threshold-unlock-after-first-production",level:4},{value:"\u2705 Progressive unlocks",id:"-progressive-unlocks",level:4},{value:"\u274c Circular unlock dependencies",id:"-circular-unlock-dependencies",level:4},{value:"Transform Cycle Detection Checklist",id:"transform-cycle-detection-checklist",level:3},{value:"Migrating Existing Content with Cycles",id:"migrating-existing-content-with-cycles",level:3},{value:"Safety Guardrails",id:"safety-guardrails",level:3},{value:"Reference Examples &amp; Tooling",id:"reference-examples--tooling",level:2},{value:"Balance validation defaults &amp; commands",id:"balance-validation-defaults--commands",level:2},{value:"Verification Runbook",id:"verification-runbook",level:2},{value:"See Also",id:"see-also",level:2},{value:"Formula Invariants &amp; Cost Semantics",id:"formula-invariants--cost-semantics",level:2},{value:"Exponential Cost Curve Formula",id:"exponential-cost-curve-formula",level:3},{value:"Snapshot Determinism (Progression Views)",id:"snapshot-determinism-progression-views",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.p,{children:["This guide turns the Content DSL specification into a step-by-step workflow for\nauthors and automation agents. It maps back to\n",(0,d.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines-design.md"})," and the schema behaviour in\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/pack/index.ts"}),", so every directive stays tied to a\ncontract."]}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["Need deeper rationale? Read\n",(0,d.jsx)(n.a,{href:"/Idle-Game-Engine/content-dsl-schema-design",children:(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})}),",\n",(0,d.jsx)(n.a,{href:"/Idle-Game-Engine/content-compiler-design",children:(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})}),", and inspect\nthe canonical examples in ",(0,d.jsx)(n.code,{children:"packages/content-sample"}),"."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"pipeline-overview",children:"Pipeline Overview"}),"\n",(0,d.jsx)(n.p,{children:"Authoring flows follow the same control points that the compiler and CLI\nenforce:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-mermaid",children:'flowchart LR\n  Author["Content author or agent"]\n  Guide["This usage guide"]\n  Schema["@idle-engine/content-schema"]\n  Compiler["pnpm generate\\n(content compiler)"]\n  Runtime["@idle-engine/core\\nconsumers"]\n\n  Author --\x3e Guide --\x3e Schema --\x3e Compiler --\x3e Runtime\n'})}),"\n",(0,d.jsx)(n.p,{children:"The rest of this document walks the pipeline stage-by-stage with checklists,\nexamples, and validation hooks."}),"\n",(0,d.jsx)(n.h2,{id:"pack-scaffolding",children:"Pack Scaffolding"}),"\n",(0,d.jsxs)(n.p,{children:["Start from the structure maintained in ",(0,d.jsx)(n.code,{children:"packages/content-sample"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Authoring sources live in ",(0,d.jsx)(n.code,{children:"content/pack.json"})," (or ",(0,d.jsx)(n.code,{children:".json5"})," when comments help)."]}),"\n",(0,d.jsxs)(n.li,{children:["Compiler outputs land in ",(0,d.jsx)(n.code,{children:"content/compiled/"})," and ",(0,d.jsx)(n.code,{children:"src/generated/"})," via\n",(0,d.jsx)(n.code,{children:"pnpm generate"})," and ",(0,d.jsx)(n.code,{children:"tools/content-schema-cli/src/generate.js"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:["Runtime-facing re-exports live in ",(0,d.jsx)(n.code,{children:"src/index.ts"}),", mirroring\n",(0,d.jsx)(n.code,{children:"packages/content-sample/src/index.ts"}),"."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"author-checklist",children:"Author checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create a new workspace package (for example ",(0,d.jsx)(n.code,{children:"packages/<pack-slug>"}),") with a\n",(0,d.jsx)(n.code,{children:"content/"})," directory that mirrors the layout in\n",(0,d.jsx)(n.code,{children:"packages/content-sample/README.md"}),"."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Copy the latest ",(0,d.jsx)(n.code,{children:"pnpm"})," scripts and TypeScript config from the sample pack\nso ",(0,d.jsx)(n.code,{children:"pnpm generate"}),", ",(0,d.jsx)(n.code,{children:"pnpm lint"}),", and tests stay aligned."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Treat ",(0,d.jsx)(n.code,{children:"content/compiled/"})," and ",(0,d.jsx)(n.code,{children:"src/generated/"})," as generated outputs\u2014never\nhand-edit them; always re-run ",(0,d.jsx)(n.code,{children:"pnpm generate"})," after source edits."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Commit the generated artifacts alongside ",(0,d.jsx)(n.code,{children:"content/pack.json"})," so consumers\nnever regenerate during install."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"sample-pack-prestige--balance-reference",children:"Sample pack (prestige + balance) reference"}),"\n",(0,d.jsxs)(n.p,{children:["The reference pack in ",(0,d.jsx)(n.code,{children:"packages/content-sample/content/pack.json"})," embodies the\nexpanded economy and prestige layer described in\n",(0,d.jsx)(n.a,{href:"/Idle-Game-Engine/sample-pack-balance-validation-design-issue-420",children:(0,d.jsx)(n.code,{children:"docs/sample-pack-balance-validation-design-issue-420.md"})}),".\nUse it as a template when authoring or validating new packs:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Resources"}),": Energy (starts at 10), Crystal (hard currency, unlocks at\nEnergy \u2265 25), Alloy (tier 2, unlocks at Crystal \u2265 50), Data Core (tier 2,\nunlocks at Alloy \u2265 40), and Prestige Flux (prestige-only, hidden until the\nprestige layer unlocks)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Generators"}),": Reactor (Energy), Crystal Harvester (consumes Energy), Forge\n(consumes Energy + Crystal \u2192 Alloy, linear cost: base 75, slope 12), Research\nLab (consumes Energy + Alloy \u2192 Data Core, exponential cost: base 120,\ngrowth 1.12), and Gate Reactor (consumes Data Core \u2192 Prestige Flux; only\nvisible/unlocked after prestige)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Upgrades"}),": Multi-tier reactor line (Insulation \u2192 Overclock \u2192 Phase\nCooling), harvester line with repeatable Quantum Sieve, forge cost/rate tuning\n(Heat Shield, Auto-Feed), lab rate boosts (Insight Boost + repeatable\nSimulation Stack gated on Prestige Flux), and the prestige-centric Ascension\nSurge multiplier."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Prestige layer"}),": ",(0,d.jsx)(n.code,{children:"sample-pack.ascension-alpha"})," unlocks at Data Core \u2265 500\nand Reactor level \u2265 10, resets base resources/generators/upgrades, and grants\nPrestige Flux via a clamped reward formula\n(",(0,d.jsx)(n.code,{children:"floor((energy + crystal + 2 * data-core) / 750)"})," capped to 1\u20135000). A\nminimum of 1 Prestige Flux is retained after each reset."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"content-authoring-guide",children:"Content Authoring Guide"}),"\n",(0,d.jsxs)(n.p,{children:["This section adds field-level guidance, examples, and patterns for each content\ntype. Examples use the ",(0,d.jsx)(n.code,{children:"@idle-engine/content-schema"})," factory helpers from\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/factories.ts"})," when authoring in TypeScript, but the\nsame shapes work inside ",(0,d.jsx)(n.code,{children:"content/pack.json"}),"."]}),"\n",(0,d.jsx)(n.h3,{id:"authoring-with-typescript-factories",children:"Authoring with TypeScript factories"}),"\n",(0,d.jsx)(n.p,{children:"When you want type-safe authoring in code, import the factories and build the\nobjects you later embed in a pack definition:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-typescript",children:"import {\n  createResource,\n  createGenerator,\n  createUpgrade,\n} from '@idle-engine/content-schema/factories';\n\nconst energy = createResource({\n  id: 'docs-minimal.energy',\n  name: { default: 'Energy' },\n  category: 'currency',\n  tier: 1,\n});\n"})}),"\n",(0,d.jsx)(n.h3,{id:"content-type-reference",children:"Content type reference"}),"\n",(0,d.jsx)(n.p,{children:"Each section includes required fields, optional fields (with defaults), and\nminimal/complete examples."}),"\n",(0,d.jsx)(n.h4,{id:"resources",children:"Resources"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Declare currencies and materials tracked by the runtime."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Must be globally unique (prefix with pack slug)."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Localized display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"category"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"primary"})," | ",(0,d.jsx)(n.code,{children:"prestige"})," | ",(0,d.jsx)(n.code,{children:"automation"})," | ",(0,d.jsx)(n.code,{children:"currency"})," | ",(0,d.jsx)(n.code,{children:"misc"})]}),(0,d.jsx)(n.td,{children:"Controls grouping and semantics."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"tier"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Positive integer tier."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"economyClassification"})," (",(0,d.jsx)(n.code,{children:"soft"}),")"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"hard"})," | ",(0,d.jsx)(n.code,{children:"soft"})]}),(0,d.jsxs)(n.td,{children:["Use ",(0,d.jsx)(n.code,{children:"hard"})," for premium currency."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"icon"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Asset path."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"startAmount"})," (",(0,d.jsx)(n.code,{children:"0"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Initial amount."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"capacity"})," (",(0,d.jsx)(n.code,{children:"null"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number | null"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"null"})," means no cap."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"visible"})," (",(0,d.jsx)(n.code,{children:"true"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Controls default visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"unlocked"})," (",(0,d.jsx)(n.code,{children:"false"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Unlock state at start."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dirtyTolerance"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Optional numeric precision threshold."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Sort ordering within UI."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Becomes monotonic."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Evaluated each tick."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"prestige"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ layerId, resetRetention? }"})}),(0,d.jsx)(n.td,{children:"Retention for prestige-layer resources."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Normalized, lowercased."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-minimal.energy",\n  "name": { "default": "Energy" },\n  "category": "currency",\n  "tier": 1\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.prestige-points",\n  "name": { "default": "Prestige Points" },\n  "category": "prestige",\n  "economyClassification": "soft",\n  "tier": 3,\n  "icon": "icons/prestige-points.svg",\n  "startAmount": 0,\n  "capacity": null,\n  "visible": false,\n  "unlocked": false,\n  "unlockCondition": {\n    "kind": "prestigeUnlocked",\n    "prestigeLayerId": "docs-prestige.rebirth"\n  },\n  "visibilityCondition": {\n    "kind": "prestigeUnlocked",\n    "prestigeLayerId": "docs-prestige.rebirth"\n  },\n  "prestige": {\n    "layerId": "docs-prestige.rebirth",\n    "resetRetention": { "kind": "constant", "value": 1 }\n  },\n  "order": 30,\n  "tags": ["prestige", "core"]\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"entities",children:"Entities"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Declare units/heroes/NPCs tracked by the runtime (optionally with per-instance identity, stats, and progression)."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Entity identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"description"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedSummary"})}),(0,d.jsx)(n.td,{children:"Short description."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"stats"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ id, name, baseValue, minValue?, maxValue? }[]"})}),(0,d.jsx)(n.td,{children:"At least one stat."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"maxCount"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsx)(n.td,{children:"Total entity cap (count or instances)."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"startCount"})," (",(0,d.jsx)(n.code,{children:"0"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsxs)(n.td,{children:["Starting count, or starting instances when ",(0,d.jsx)(n.code,{children:"trackInstances: true"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"trackInstances"})," (",(0,d.jsx)(n.code,{children:"false"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsxs)(n.td,{children:["When ",(0,d.jsx)(n.code,{children:"true"}),", runtime tracks individual instances (levels/stats/mission assignments)."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"progression"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ experienceResource?, levelFormula, maxLevel?, statGrowth }"})}),(0,d.jsx)(n.td,{children:"Enables XP/levels and per-level stat growth."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"If omitted, the entity starts unlocked."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsxs)(n.td,{children:["If omitted, uses ",(0,d.jsx)(n.code,{children:"visible"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"unlocked"})," (",(0,d.jsx)(n.code,{children:"false"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsxs)(n.td,{children:["When ",(0,d.jsx)(n.code,{children:"unlockCondition"})," is present, ",(0,d.jsx)(n.code,{children:"unlocked: true"})," starts it unlocked anyway."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"visible"})," (",(0,d.jsx)(n.code,{children:"true"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Default visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Normalized, lowercased."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-minimal.scout",\n  "name": { "default": "Scout" },\n  "description": { "default": "A basic explorer." },\n  "stats": [\n    {\n      "id": "docs-minimal.scout.speed",\n      "name": { "default": "Speed" },\n      "baseValue": { "kind": "constant", "value": 1 }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-missions.scout",\n  "name": { "default": "Scout" },\n  "description": { "default": "A recruitable unit used in missions." },\n  "stats": [\n    {\n      "id": "docs-missions.scout.power",\n      "name": { "default": "Power" },\n      "baseValue": { "kind": "constant", "value": 5 },\n      "minValue": { "kind": "constant", "value": 0 }\n    },\n    {\n      "id": "docs-missions.scout.luck",\n      "name": { "default": "Luck" },\n      "baseValue": { "kind": "constant", "value": 0.1 },\n      "minValue": { "kind": "constant", "value": 0 },\n      "maxValue": { "kind": "constant", "value": 1 }\n    }\n  ],\n  "maxCount": { "kind": "constant", "value": 5 },\n  "startCount": 2,\n  "trackInstances": true,\n  "progression": {\n    "experienceResource": "docs-missions.scout-xp",\n    "levelFormula": { "kind": "linear", "base": 0, "slope": 10 },\n    "maxLevel": 20,\n    "statGrowth": {\n      "docs-missions.scout.power": { "kind": "constant", "value": 0.5 }\n    }\n  },\n  "unlockCondition": { "kind": "always" },\n  "order": 40,\n  "tags": ["units", "missions"]\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"generators",children:"Generators"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Define producers that convert time into resources."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Generator identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"produces"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, rate }[]"})}),(0,d.jsx)(n.td,{children:"At least one entry."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"purchase"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SingleCurrencyPurchase | MultiCurrencyPurchase"})}),(0,d.jsx)(n.td,{children:"Cost model."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"baseUnlock"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"When generator becomes available."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"icon"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Asset path."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Categorization tags."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"consumes"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, rate }[]"})}),(0,d.jsx)(n.td,{children:"Resource drains."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"initialLevel"})," (",(0,d.jsx)(n.code,{children:"0"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Starting level."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"maxLevel"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Level cap."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"UI-only visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"automation"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ automationId }"})}),(0,d.jsx)(n.td,{children:"Link to automation unlock."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"effects"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"UpgradeEffect[]"})}),(0,d.jsx)(n.td,{children:"Effects applied per level."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-minimal.ticker",\n  "name": { "default": "Ticker" },\n  "produces": [\n    { "resourceId": "docs-minimal.energy", "rate": { "kind": "constant", "value": 1 } }\n  ],\n  "purchase": {\n    "currencyId": "docs-minimal.energy",\n    "costMultiplier": 10,\n    "costCurve": { "kind": "constant", "value": 1 }\n  },\n  "baseUnlock": { "kind": "always" }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.core",\n  "name": { "default": "Core" },\n  "icon": "icons/core.svg",\n  "tags": ["primary"],\n  "produces": [\n    { "resourceId": "docs-prestige.energy", "rate": { "kind": "linear", "base": 1, "slope": 0.5 } }\n  ],\n  "consumes": [],\n  "purchase": {\n    "currencyId": "docs-prestige.energy",\n    "costMultiplier": 25,\n    "costCurve": { "kind": "exponential", "growth": 1.15 }\n  },\n  "initialLevel": 0,\n  "maxLevel": 50,\n  "order": 10,\n  "baseUnlock": { "kind": "always" },\n  "visibilityCondition": { "kind": "always" },\n  "effects": [\n    {\n      "kind": "modifyResourceRate",\n      "resourceId": "docs-prestige.energy",\n      "operation": "add",\n      "value": { "kind": "constant", "value": 0.25 }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"upgrades",children:"Upgrades"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": One-time or repeatable modifiers tied to targets."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Upgrade identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"category"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"global"})," | ",(0,d.jsx)(n.code,{children:"resource"})," | ",(0,d.jsx)(n.code,{children:"generator"})," | ",(0,d.jsx)(n.code,{children:"automation"})," | ",(0,d.jsx)(n.code,{children:"prestige"})]}),(0,d.jsx)(n.td,{children:"Organization label."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targets"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"UpgradeTarget[]"})}),(0,d.jsx)(n.td,{children:"At least one target."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"cost"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SingleCurrencyCost | MultiCurrencyCost"})}),(0,d.jsx)(n.td,{children:"Purchase cost."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"effects"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"UpgradeEffect[]"})}),(0,d.jsx)(n.td,{children:"At least one effect."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"icon"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Asset path."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Categorization."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"repeatable"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ maxPurchases?, costCurve?, effectCurve? }"})}),(0,d.jsx)(n.td,{children:"Progression tuning."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"prerequisites"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition[]"})}),(0,d.jsxs)(n.td,{children:["Strings become ",(0,d.jsx)(n.code,{children:"upgradeOwned"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Unlock gating."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"UI-only visibility."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.core-efficiency",\n  "name": { "default": "Core Efficiency" },\n  "category": "generator",\n  "targets": [{ "kind": "generator", "id": "docs-prestige.core" }],\n  "cost": {\n    "currencyId": "docs-prestige.energy",\n    "costMultiplier": 100,\n    "costCurve": { "kind": "constant", "value": 1 }\n  },\n  "effects": [\n    {\n      "kind": "modifyGeneratorRate",\n      "generatorId": "docs-prestige.core",\n      "operation": "multiply",\n      "value": { "kind": "constant", "value": 1.25 }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.core-efficiency-ii",\n  "name": { "default": "Core Efficiency II" },\n  "icon": "icons/upgrade-core.svg",\n  "tags": ["core", "efficiency"],\n  "category": "generator",\n  "targets": [{ "kind": "generator", "id": "docs-prestige.core" }],\n  "cost": {\n    "costs": [\n      {\n        "resourceId": "docs-prestige.energy",\n        "costMultiplier": 250,\n        "costCurve": { "kind": "linear", "base": 1, "slope": 0.2 }\n      }\n    ]\n  },\n  "repeatable": {\n    "maxPurchases": 10,\n    "costCurve": { "kind": "exponential", "growth": 1.1 },\n    "effectCurve": { "kind": "linear", "base": 1, "slope": 0.05 }\n  },\n  "prerequisites": ["docs-prestige.core-efficiency"],\n  "order": 20,\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "docs-prestige.energy",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 500 }\n  },\n  "effects": [\n    {\n      "kind": "modifyGeneratorRate",\n      "generatorId": "docs-prestige.core",\n      "operation": "multiply",\n      "value": { "kind": "linear", "base": 1, "slope": 0.1 }\n    },\n    {\n      "kind": "unlockGenerator",\n      "generatorId": "docs-prestige.shard-miner"\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"achievements",children:"Achievements"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Track progress milestones and award rewards."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Achievement identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"description"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedSummary"})}),(0,d.jsx)(n.td,{children:"Short description."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"category"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"progression"})," | ",(0,d.jsx)(n.code,{children:"prestige"})," | ",(0,d.jsx)(n.code,{children:"automation"})," | ",(0,d.jsx)(n.code,{children:"collection"})]}),(0,d.jsx)(n.td,{children:"Classification."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"tier"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"bronze"})," | ",(0,d.jsx)(n.code,{children:"silver"})," | ",(0,d.jsx)(n.code,{children:"gold"})," | ",(0,d.jsx)(n.code,{children:"platinum"})]}),(0,d.jsx)(n.td,{children:"Presentation tier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"track"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"AchievementTrack"})}),(0,d.jsx)(n.td,{children:"Progress source."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"icon"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Asset path."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Categorization."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"progress"})," (",(0,d.jsx)(n.code,{children:'{ mode: "oneShot" }'}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ mode, target?, repeatable? }"})}),(0,d.jsx)(n.td,{children:"Defaults target from track."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"reward"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"AchievementReward"})}),(0,d.jsx)(n.td,{children:"Optional award."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Unlock gating."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"UI-only visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"onUnlockEvents"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId[]"})}),(0,d.jsx)(n.td,{children:"Emits runtime events."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"displayOrder"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.first-energy",\n  "name": { "default": "First Spark" },\n  "description": { "default": "Generate your first energy." },\n  "category": "progression",\n  "tier": "bronze",\n  "track": {\n    "kind": "resource",\n    "resourceId": "docs-prestige.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 1 }\n  }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.energy-hoarder",\n  "name": { "default": "Energy Hoarder" },\n  "description": { "default": "Store 1,000 energy without spending it." },\n  "category": "progression",\n  "tier": "silver",\n  "icon": "icons/achievement-energy.svg",\n  "tags": ["energy"],\n  "track": {\n    "kind": "resource",\n    "resourceId": "docs-prestige.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 1000 }\n  },\n  "progress": {\n    "mode": "repeatable",\n    "repeatable": {\n      "resetWindow": { "kind": "constant", "value": 60 },\n      "maxRepeats": 3,\n      "rewardScaling": { "kind": "linear", "base": 1, "slope": 0.5 }\n    }\n  },\n  "reward": {\n    "kind": "grantResource",\n    "resourceId": "docs-prestige.energy",\n    "amount": { "kind": "constant", "value": 50 }\n  },\n  "onUnlockEvents": ["docs-prestige.achievement.energy-hoarder"]\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"automations",children:"Automations"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Encode auto-play behaviors (buy, collect, system actions)."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Automation identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"description"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Description text."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targetType"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"generator"})," | ",(0,d.jsx)(n.code,{children:"upgrade"})," | ",(0,d.jsx)(n.code,{children:"purchaseGenerator"})," | ",(0,d.jsx)(n.code,{children:"collectResource"})," | ",(0,d.jsx)(n.code,{children:"system"})]}),(0,d.jsx)(n.td,{children:"Operation type."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"trigger"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"AutomationTrigger"})}),(0,d.jsx)(n.td,{children:"Interval/resource/event trigger."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Unlock gating."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Conditional required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Applies when"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targetId"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:'targetType !== "system"'})}),(0,d.jsx)(n.td,{children:"Required for non-system targets."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"systemTargetId"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:'targetType === "system"'})}),(0,d.jsx)(n.td,{children:"Required for system targets."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targetEnabled"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Only for generator targets."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targetCount"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsxs)(n.td,{children:["Only for ",(0,d.jsx)(n.code,{children:"purchaseGenerator"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"targetAmount"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsxs)(n.td,{children:["Only for ",(0,d.jsx)(n.code,{children:"collectResource"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"cooldown"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsx)(n.td,{children:"Post-success cooldown."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resourceCost"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, rate }"})}),(0,d.jsx)(n.td,{children:"Cost per activation."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"UI-only visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"enabledByDefault"})," (",(0,d.jsx)(n.code,{children:"false"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Initial toggle state."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"scriptId"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ScriptId"})}),(0,d.jsx)(n.td,{children:"Script integration."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.auto-core",\n  "name": { "default": "Auto Core" },\n  "description": { "default": "Automatically purchase cores." },\n  "targetType": "purchaseGenerator",\n  "targetId": "docs-prestige.core",\n  "targetCount": { "kind": "constant", "value": 1 },\n  "trigger": { "kind": "interval", "interval": { "kind": "constant", "value": 10 } },\n  "unlockCondition": { "kind": "always" }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.auto-collect",\n  "name": { "default": "Auto Collect" },\n  "description": { "default": "Collect shards when the queue is empty." },\n  "targetType": "collectResource",\n  "targetId": "docs-prestige.shards",\n  "targetAmount": { "kind": "constant", "value": 5 },\n  "trigger": { "kind": "commandQueueEmpty" },\n  "cooldown": { "kind": "constant", "value": 15 },\n  "resourceCost": {\n    "resourceId": "docs-prestige.energy",\n    "rate": { "kind": "constant", "value": 2 }\n  },\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "docs-prestige.energy",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 50 }\n  },\n  "visibilityCondition": { "kind": "always" },\n  "enabledByDefault": false,\n  "order": 40\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"prestige-layers",children:"Prestige layers"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Define reset mechanics and prestige rewards."]}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Note"}),": Every prestige layer requires a counter resource named ",(0,d.jsx)(n.code,{children:"{id}-prestige-count"})," (for example ",(0,d.jsx)(n.code,{children:"docs-prestige.rebirth-prestige-count"}),") in the pack's ",(0,d.jsx)(n.code,{children:"resources"})," array. The runtime increments this resource each time the layer is applied, and conditions like ",(0,d.jsx)(n.code,{children:"prestigeCompleted"})," / ",(0,d.jsx)(n.code,{children:"prestigeCountThreshold"})," read it\u2014do not include it in ",(0,d.jsx)(n.code,{children:"resetTargets"}),"."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Minimal prestige counter resource example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.rebirth-prestige-count",\n  "name": { "default": "Rebirth Count" },\n  "category": "misc",\n  "tier": 3,\n  "startAmount": 0,\n  "visible": false,\n  "unlocked": true\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Layer identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"summary"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Short summary."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resetTargets"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId[]"})}),(0,d.jsx)(n.td,{children:"Resources to reset (at least one)."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"When prestige becomes available."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"reward"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, baseReward, multiplierCurve? }"})}),(0,d.jsx)(n.td,{children:"Reward formula."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"icon"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Asset path."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resetGenerators"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId[]"})}),(0,d.jsx)(n.td,{children:"Generators to reset."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"resetUpgrades"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId[]"})}),(0,d.jsx)(n.td,{children:"Upgrades to reset."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"retention"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ kind, ... }[]"})}),(0,d.jsx)(n.td,{children:"Items retained after reset."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"automation"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ automationId }"})}),(0,d.jsx)(n.td,{children:"Link to automation."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.rebirth",\n  "name": { "default": "Rebirth" },\n  "summary": { "default": "Reset for prestige points." },\n  "resetTargets": ["docs-prestige.energy", "docs-prestige.shards"],\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "docs-prestige.shards",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 100 }\n  },\n  "reward": {\n    "resourceId": "docs-prestige.prestige-points",\n    "baseReward": { "kind": "constant", "value": 1 }\n  }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.rebirth-plus",\n  "name": { "default": "Rebirth +" },\n  "summary": { "default": "Stronger resets with retention." },\n  "icon": "icons/rebirth.svg",\n  "resetTargets": ["docs-prestige.energy", "docs-prestige.shards"],\n  "resetGenerators": ["docs-prestige.core", "docs-prestige.shard-miner"],\n  "resetUpgrades": ["docs-prestige.core-efficiency"],\n  "unlockCondition": {\n    "kind": "generatorLevel",\n    "generatorId": "docs-prestige.core",\n    "comparator": "gte",\n    "level": { "kind": "constant", "value": 10 }\n  },\n  "reward": {\n    "resourceId": "docs-prestige.prestige-points",\n    "baseReward": { "kind": "constant", "value": 2 },\n    "multiplierCurve": { "kind": "linear", "base": 1, "slope": 0.5 }\n  },\n  "retention": [\n    {\n      "kind": "resource",\n      "resourceId": "docs-prestige.energy",\n      "amount": { "kind": "constant", "value": 50 }\n    }\n  ],\n  "order": 60\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"metrics",children:"Metrics"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Instrument runtime or content-driven counters/gauges."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Metric identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"kind"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"counter"})," | ",(0,d.jsx)(n.code,{children:"gauge"})," | ",(0,d.jsx)(n.code,{children:"histogram"})," | ",(0,d.jsx)(n.code,{children:"upDownCounter"})]}),(0,d.jsx)(n.td,{children:"Metric shape."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"source"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"runtime"})," | ",(0,d.jsx)(n.code,{children:"content"})," | ",(0,d.jsx)(n.code,{children:"script"})]}),(0,d.jsx)(n.td,{children:"Origin of updates."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"description"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedSummary"})}),(0,d.jsx)(n.td,{children:"Text for dashboards."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"unit"})," (",(0,d.jsx)(n.code,{children:'"1"'}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Unit label."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"aggregation"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"sum"})," | ",(0,d.jsx)(n.code,{children:"delta"})," | ",(0,d.jsx)(n.code,{children:"cumulative"})," | ",(0,d.jsx)(n.code,{children:"distribution"})]}),(0,d.jsx)(n.td,{children:"Required for histograms."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"attributes"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"<= 3"})," recommended."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.total-energy",\n  "name": { "default": "Total Energy" },\n  "kind": "counter",\n  "source": { "kind": "runtime" }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.energy-rate",\n  "name": { "default": "Energy Rate" },\n  "description": { "default": "Energy per second over time." },\n  "kind": "histogram",\n  "unit": "energy/s",\n  "aggregation": "distribution",\n  "attributes": ["source", "tier"],\n  "source": { "kind": "content" },\n  "order": 70\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"transforms",children:"Transforms"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Purpose"}),": Define conversion recipes and crafting steps."]}),"\n",(0,d.jsx)(n.p,{children:"Required fields:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ContentId"})}),(0,d.jsx)(n.td,{children:"Transform identifier."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedText"})}),(0,d.jsx)(n.td,{children:"Display name."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"description"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LocalizedSummary"})}),(0,d.jsx)(n.td,{children:"Short description."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"mode"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"instant"})," | ",(0,d.jsx)(n.code,{children:"continuous"})," | ",(0,d.jsx)(n.code,{children:"batch"})," | ",(0,d.jsx)(n.code,{children:"mission"})]}),(0,d.jsx)(n.td,{children:"Execution mode."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"inputs"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, amount }[]"})}),(0,d.jsx)(n.td,{children:"At least one input."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"outputs"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ resourceId, amount }[]"})}),(0,d.jsxs)(n.td,{children:["Non-mission transforms must have at least one output; mission transforms use ",(0,d.jsx)(n.code,{children:"outcomes.*.outputs"})," and may set this to ",(0,d.jsx)(n.code,{children:"[]"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"trigger"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"TransformTrigger"})}),(0,d.jsx)(n.td,{children:"Manual, automation, condition, or event."})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Optional fields (defaults in parentheses):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"duration"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsxs)(n.td,{children:["Duration in milliseconds. Required for ",(0,d.jsx)(n.code,{children:"batch"})," mode and single-stage mission transforms."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"cooldown"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NumericFormula"})}),(0,d.jsx)(n.td,{children:"Cooldown in milliseconds between runs."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"unlockCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"Unlock gating."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"visibilityCondition"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Condition"})}),(0,d.jsx)(n.td,{children:"UI-only visibility."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"automation"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ automationId }"})}),(0,d.jsx)(n.td,{children:"Required for automation trigger."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"tags"})," (",(0,d.jsx)(n.code,{children:"[]"}),")"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Categorization."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"safety"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ maxRunsPerTick?, maxOutstandingBatches? }"})}),(0,d.jsx)(n.td,{children:"Runtime guardrails."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"order"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"UI ordering."})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:["Mission-only fields (when ",(0,d.jsx)(n.code,{children:'mode: "mission"'}),"):"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Notes"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"entityRequirements"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ entityId, count, minStats?, preferHighStats?, returnOnComplete? }[]"})}),(0,d.jsx)(n.td,{children:"Required; selects entity instances for deployment."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"successRate"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ baseRate, statModifiers?, usePRD? }"})}),(0,d.jsx)(n.td,{children:"Optional; if omitted, missions always succeed."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"outcomes"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"{ success, failure?, critical? }"})}),(0,d.jsx)(n.td,{children:"Required; mission rewards (and optional entity XP/damage)."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"stages"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"MissionStage[]"})}),(0,d.jsx)(n.td,{children:"Optional; define multi-stage missions with checkpoints/decisions."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"initialStage"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["Optional; defaults to the first stage when ",(0,d.jsx)(n.code,{children:"stages"})," is present."]})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"Minimal example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.refine-shards",\n  "name": { "default": "Refine Shards" },\n  "description": { "default": "Convert energy into shards." },\n  "mode": "instant",\n  "inputs": [{ "resourceId": "docs-prestige.energy", "amount": { "kind": "constant", "value": 10 } }],\n  "outputs": [{ "resourceId": "docs-prestige.shards", "amount": { "kind": "constant", "value": 1 } }],\n  "trigger": { "kind": "manual" }\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Complete example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-prestige.batch-refine",\n  "name": { "default": "Batch Refinery" },\n  "description": { "default": "Process larger shard batches over time." },\n  "mode": "batch",\n  "inputs": [{ "resourceId": "docs-prestige.energy", "amount": { "kind": "constant", "value": 50 } }],\n  "outputs": [{ "resourceId": "docs-prestige.shards", "amount": { "kind": "constant", "value": 8 } }],\n  "duration": { "kind": "constant", "value": 15000 },\n  "cooldown": { "kind": "constant", "value": 10000 },\n  "trigger": {\n    "kind": "condition",\n    "condition": {\n      "kind": "resourceThreshold",\n      "resourceId": "docs-prestige.energy",\n      "comparator": "gte",\n      "amount": { "kind": "constant", "value": 50 }\n    }\n  },\n  "unlockCondition": { "kind": "always" },\n  "safety": { "maxRunsPerTick": 5, "maxOutstandingBatches": 20 },\n  "order": 80\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Mission example (multi-stage with a decision):"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "id": "docs-missions.forest-expedition",\n  "name": { "default": "Forest Expedition" },\n  "description": { "default": "Send scouts to explore the forest." },\n  "mode": "mission",\n  "inputs": [{ "resourceId": "docs-missions.supplies", "amount": { "kind": "constant", "value": 2 } }],\n  "outputs": [],\n  "trigger": { "kind": "manual" },\n  "entityRequirements": [\n    {\n      "entityId": "docs-missions.scout",\n      "count": { "kind": "constant", "value": 2 },\n      "preferHighStats": ["docs-missions.scout.luck"]\n    }\n  ],\n  "successRate": {\n    "baseRate": { "kind": "constant", "value": 0.6 },\n    "statModifiers": [\n      {\n        "stat": "docs-missions.scout.luck",\n        "weight": { "kind": "constant", "value": 0.1 },\n        "entityScope": "average"\n      }\n    ],\n    "usePRD": true\n  },\n  "outcomes": {\n    "success": {\n      "outputs": [{ "resourceId": "docs-missions.loot", "amount": { "kind": "constant", "value": 5 } }],\n      "entityExperience": { "kind": "constant", "value": 3 },\n      "message": { "default": "The expedition returns with supplies." }\n    },\n    "failure": {\n      "outputs": [],\n      "entityDamage": { "kind": "constant", "value": 1 },\n      "message": { "default": "The expedition returns empty-handed." }\n    },\n    "critical": {\n      "chance": { "kind": "constant", "value": 0.1 },\n      "outputs": [{ "resourceId": "docs-missions.loot", "amount": { "kind": "constant", "value": 15 } }],\n      "entityExperience": { "kind": "constant", "value": 6 },\n      "message": { "default": "Jackpot!" }\n    }\n  },\n  "stages": [\n    {\n      "id": "travel",\n      "name": { "default": "Travel" },\n      "duration": { "kind": "constant", "value": 30000 },\n      "checkpoint": {\n        "outputs": [],\n        "message": { "default": "Scouts reach the forest edge." }\n      },\n      "nextStage": "search"\n    },\n    {\n      "id": "search",\n      "name": { "default": "Search" },\n      "duration": { "kind": "constant", "value": 60000 },\n      "decision": {\n        "prompt": { "default": "Take the safe path or a risky shortcut?" },\n        "timeout": { "kind": "constant", "value": 15000 },\n        "defaultOption": "safe",\n        "options": [\n          {\n            "id": "safe",\n            "label": { "default": "Safe path" },\n            "nextStage": "return_safe",\n            "modifiers": {\n              "successRateBonus": { "kind": "constant", "value": 0.05 }\n            }\n          },\n          {\n            "id": "risky",\n            "label": { "default": "Risky shortcut" },\n            "nextStage": "return_risky",\n            "modifiers": {\n              "successRateBonus": { "kind": "constant", "value": -0.05 },\n              "outputMultiplier": { "kind": "constant", "value": 1.5 }\n            }\n          }\n        ]\n      }\n    },\n    {\n      "id": "return_safe",\n      "name": { "default": "Return" },\n      "duration": { "kind": "constant", "value": 30000 },\n      "nextStage": null\n    },\n    {\n      "id": "return_risky",\n      "name": { "default": "Return (risky)" },\n      "duration": { "kind": "constant", "value": 30000 },\n      "nextStage": null\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"conditions-and-formulas",children:"Conditions and formulas"}),"\n",(0,d.jsxs)(n.p,{children:["Conditions and formulas are shared across content types. Keep them small and\ndeterministic to avoid hitting depth limits (",(0,d.jsx)(n.code,{children:"MAX_CONDITION_DEPTH"}),",\n",(0,d.jsx)(n.code,{children:"MAX_FORMULA_DEPTH"}),")."]}),"\n",(0,d.jsx)(n.h4,{id:"condition-kinds",children:"Condition kinds"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"always"})," / ",(0,d.jsx)(n.code,{children:"never"})," - unconditional gates."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"resourceThreshold"})," - compare resource amount via ",(0,d.jsx)(n.code,{children:"comparator"})," + ",(0,d.jsx)(n.code,{children:"amount"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"generatorLevel"})," - compare generator level via ",(0,d.jsx)(n.code,{children:"comparator"})," + ",(0,d.jsx)(n.code,{children:"level"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"upgradeOwned"})," - require a number of purchases (defaults to 1)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"prestigeCountThreshold"})," - compare prestige count with comparator + count."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"prestigeCompleted"})," - true after at least one prestige reset."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"prestigeUnlocked"})," - true while the prestige action is currently available."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"flag"})," / ",(0,d.jsx)(n.code,{children:"script"})," - driven by flags or scripts."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"allOf"})," / ",(0,d.jsx)(n.code,{children:"anyOf"})," / ",(0,d.jsx)(n.code,{children:"not"})," - logical composition."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Example: multi-condition unlock"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "kind": "allOf",\n  "conditions": [\n    {\n      "kind": "resourceThreshold",\n      "resourceId": "docs-prestige.energy",\n      "comparator": "gte",\n      "amount": { "kind": "constant", "value": 250 }\n    },\n    {\n      "kind": "generatorLevel",\n      "generatorId": "docs-prestige.core",\n      "comparator": "gte",\n      "level": { "kind": "constant", "value": 5 }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Prestige gotcha"}),": ",(0,d.jsx)(n.code,{children:"prestigeUnlocked"}),' means the layer is currently available,\nnot "post-prestige". Use ',(0,d.jsx)(n.code,{children:"prestigeCompleted"})," or ",(0,d.jsx)(n.code,{children:"prestigeCountThreshold"})," for\npost-prestige gating."]}),"\n",(0,d.jsx)(n.h4,{id:"formula-kinds",children:"Formula kinds"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"constant"})," - fixed numbers."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"linear"})," - ",(0,d.jsx)(n.code,{children:"base + slope * level"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"exponential"})," - ",(0,d.jsx)(n.code,{children:"base * growth^level + offset"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"polynomial"})," - coefficient-based curves."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"piecewise"})," - switch formulas by level."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"expression"})," - custom expression trees (use sparingly)."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Example: expression formula with references"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "kind": "expression",\n  "expression": {\n    "kind": "binary",\n    "op": "mul",\n    "left": { "kind": "ref", "target": { "type": "variable", "name": "level" } },\n    "right": { "kind": "literal", "value": 1.25 }\n  }\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"effects-system-upgrades--generator-effects",children:"Effects system (upgrades + generator effects)"}),"\n",(0,d.jsx)(n.p,{children:"Effect operations:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"add"})," - additive delta."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"multiply"})," - multiplicative scale."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"set"})," - override value."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Effect kinds:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"modifyResourceRate"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"modifyResourceCapacity"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"modifyGeneratorRate"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"modifyGeneratorCost"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"modifyGeneratorConsumption"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"grantAutomation"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"grantFlag"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"unlockResource"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"unlockGenerator"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"alterDirtyTolerance"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"emitEvent"})}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Example: mix of resource and generator effects"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "kind": "modifyResourceRate",\n    "resourceId": "docs-prestige.energy",\n    "operation": "add",\n    "value": { "kind": "constant", "value": 2 }\n  },\n  {\n    "kind": "modifyGeneratorCost",\n    "generatorId": "docs-prestige.core",\n    "operation": "multiply",\n    "value": { "kind": "constant", "value": 0.9 }\n  }\n]\n'})}),"\n",(0,d.jsx)(n.h3,{id:"authoring-gotchas",children:"Authoring gotchas"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"unlockCondition"})," vs ",(0,d.jsx)(n.code,{children:"visibilityCondition"})," (resources): if a resource starts\n",(0,d.jsx)(n.code,{children:"visible: false"})," and you never set a ",(0,d.jsx)(n.code,{children:"visibilityCondition"}),", it stays hidden\neven after unlocking. Mirror the unlock condition when you expect it to\nreveal on unlock."]}),"\n",(0,d.jsxs)(n.li,{children:["Automations: non-",(0,d.jsx)(n.code,{children:"always"})," ",(0,d.jsx)(n.code,{children:"unlockCondition"}),"s are not evaluated by\n",(0,d.jsx)(n.code,{children:"AutomationSystem"})," today (see #502). Use upgrade effects and external wiring\nto enable these automations when needed."]}),"\n",(0,d.jsxs)(n.li,{children:["Prestige gating: use ",(0,d.jsx)(n.code,{children:"prestigeCompleted"})," / ",(0,d.jsx)(n.code,{children:"prestigeCountThreshold"})," for\npost-prestige gates; ",(0,d.jsx)(n.code,{children:"prestigeUnlocked"}),' is "available now" (see #505).']}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"example-packs",children:"Example packs"}),"\n",(0,d.jsxs)(n.p,{children:["Reference packs live in ",(0,d.jsx)(n.code,{children:"docs/examples/"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"docs/examples/minimal-pack/content/pack.json"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"docs/examples/prestige-pack/content/pack.json"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Run ",(0,d.jsx)(n.code,{children:"pnpm generate --check"})," to validate the examples alongside other packs."]}),"\n",(0,d.jsxs)(n.p,{children:["For quick lookups, use the condensed cheat sheet in\n",(0,d.jsx)(n.code,{children:"docs/content-quick-reference.md"}),"."]}),"\n",(0,d.jsx)(n.h2,{id:"naming-conventions",children:"Naming Conventions"}),"\n",(0,d.jsxs)(n.p,{children:["The schema enforces naming through ",(0,d.jsx)(n.code,{children:"packSlugSchema"}),", ",(0,d.jsx)(n.code,{children:"contentIdSchema"}),", and\nrelated validators (see ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/pack/schema.ts"}),"). Keep these rules\nin mind before you run validation:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metadata.id"}),": lowercase slug (",(0,d.jsx)(n.code,{children:"a-z0-9-"}),"), \u226432 chars, and stable after publish\n(",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," \xa75.5)."]}),"\n",(0,d.jsxs)(n.li,{children:["Content IDs: reuse the slug casing from ",(0,d.jsx)(n.code,{children:"contentIdSchema"})," and prefix with the\npack slug to avoid collisions (",(0,d.jsx)(n.code,{children:"packages/content-schema/src/base/ids.ts"}),")."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metadata.title"})," / ",(0,d.jsx)(n.code,{children:"summary"}),": provide ",(0,d.jsx)(n.code,{children:"default"})," copy and locale variants; keep\n",(0,d.jsx)(n.code,{children:"summary"})," \u2264512 chars (",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," \xa75.5)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metadata.tags"}),": slug list (\u226424 chars) with no spaces or uppercase characters\n(",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," \xa75.5)."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"naming-checklist",children:"Naming checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pick a pack slug that matches the directory name and stays unique across\n",(0,d.jsx)(n.code,{children:"packages/*"})," (collisions surface via ",(0,d.jsx)(n.code,{children:"ContentSchemaOptions.knownPacks"})," in\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/pack/types.ts"}),")."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Reserve a namespace prefix for content IDs before authoring modules and\napply it consistently."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Populate localized titles and summaries while setting ",(0,d.jsx)(n.code,{children:"defaultLocale"})," and\n",(0,d.jsx)(n.code,{children:"supportedLocales"})," to avoid churn later."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Document non-obvious tags or visibility flags in the package README so\nreviewers capture intent."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"offline-progression-fast-path",children:"Offline Progression Fast Path"}),"\n",(0,d.jsxs)(n.p,{children:["Use ",(0,d.jsx)(n.code,{children:"metadata.offlineProgression"})," to opt into constant-rate offline restores:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Supply ",(0,d.jsx)(n.code,{children:'mode: "constant-rates"'})," with ",(0,d.jsx)(n.code,{children:"preconditions"})," (",(0,d.jsx)(n.code,{children:"constantRates"}),", ",(0,d.jsx)(n.code,{children:"noUnlocks"}),", ",(0,d.jsx)(n.code,{children:"noAchievements"}),", ",(0,d.jsx)(n.code,{children:"noAutomation"}),", ",(0,d.jsx)(n.code,{children:"modeledResourceBounds"}),")."]}),"\n",(0,d.jsx)(n.li,{children:"Omit the block if any precondition is false so restores fall back to step-based catch-up."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"declaring-dependencies",children:"Declaring Dependencies"}),"\n",(0,d.jsxs)(n.p,{children:["Model relationships through ",(0,d.jsx)(n.code,{children:"metadata.dependencies"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"requires"}),": hard dependencies that must be installed and activated first."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"optional"}),": soft integrations flagged as warnings when missing (requires\n",(0,d.jsx)(n.code,{children:"ContentSchemaOptions.activePackIds"})," during validation)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"conflicts"}),": mutually exclusive packs that should never load together."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"provides"}),": capability slugs that downstream tooling can query."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Normalization deduplicates entries, sorts them, and blocks self-references (see\n",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," \xa75.5 and\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/modules/dependencies.ts"}),")."]}),"\n",(0,d.jsx)(n.h3,{id:"dependency-checklist",children:"Dependency checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","List every runtime prerequisite under ",(0,d.jsx)(n.code,{children:"metadata.dependencies.requires"}),"\nwith a SemVer range that matches the dependency\u2019s ",(0,d.jsx)(n.code,{children:"metadata.version"}),"."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Mark optional integrations only when the pack functions without them and\nadd contextual ",(0,d.jsx)(n.code,{children:"message"})," fields for conflicts so tooling can explain why."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Update team installation manifests (if any) whenever you add a new hard\ndependency so validation inputs stay aligned."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Re-run ",(0,d.jsx)(n.code,{children:"pnpm generate"})," and confirm the CLI logs omit\n",(0,d.jsx)(n.code,{children:"content_pack.dependency_cycle"})," warnings."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"dependency-compatibility-matrix",children:"Dependency compatibility matrix"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Policy"}),(0,d.jsx)(n.th,{children:"Applies When"}),(0,d.jsx)(n.th,{children:"Enforcement"}),(0,d.jsx)(n.th,{children:"References"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"requires"})}),(0,d.jsx)(n.td,{children:"Pack cannot function without another pack"}),(0,d.jsx)(n.td,{children:"Validation fails on missing packs; compiler blocks compilation"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.6)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"optional"})}),(0,d.jsx)(n.td,{children:"Integration enhances behaviour but is not mandatory"}),(0,d.jsxs)(n.td,{children:["Emits warnings when absent if ",(0,d.jsx)(n.code,{children:"ContentSchemaOptions.activePackIds"})," supplies the install graph"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5), ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/modules/dependencies.ts"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"conflicts"})}),(0,d.jsx)(n.td,{children:"Packs must never load together"}),(0,d.jsx)(n.td,{children:"Validation errors guard against self-dependency; compiler logs failure with the conflicting slug"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.6)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"provides"})}),(0,d.jsx)(n.td,{children:"Pack exposes capabilities for discovery tooling"}),(0,d.jsx)(n.td,{children:"Normalisation deduplicates entries; workspace summary records capability digests"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.4)"]})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"versioning--release-cadence",children:"Versioning & Release Cadence"}),"\n",(0,d.jsx)(n.p,{children:"Content packs carry both a pack version and a runtime compatibility range:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metadata.version"})," must follow ",(0,d.jsx)(n.a,{href:"https://semver.org/",children:"Semantic Versioning"})," and\nincrements whenever pack behaviour or data changes."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metadata.engine"})," expresses supported engine versions; validation uses\n",(0,d.jsx)(n.code,{children:"semver.satisfies()"})," and the feature gates in\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/runtime-compat.ts"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:["Compiler summaries (",(0,d.jsx)(n.code,{children:"src/generated/*summary*"})," in the sample pack) surface the\nslug, version, and warning count at import time\n(",(0,d.jsx)(n.code,{children:"packages/content-sample/src/index.ts:23-44"}),")."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"versioning-checklist",children:"Versioning checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Bump ",(0,d.jsx)(n.code,{children:"metadata.version"})," for every committed change that alters gameplay,\ndata tables, or compatibility metadata."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Align ",(0,d.jsx)(n.code,{children:"metadata.engine"})," with the runtime tested locally (for example\n",(0,d.jsx)(n.code,{children:">=0.4.0 <0.6.0"}),"); widen ranges only after validating against newer runtimes."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Capture notable changes in your package README or release notes so other\nauthors can plan migrations."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Inspect the generated summary module to confirm the digest and artifact\nhash changed when expected; unexpected stability often means missing source\ndiffs."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"compatibility-triage",children:"Compatibility Triage"}),"\n",(0,d.jsxs)(n.p,{children:["Feature gates keep packs aligned with runtime capabilities. The current baseline\nlives in ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/runtime-compat.ts"}),":"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Module"}),(0,d.jsx)(n.th,{children:"Introduced in"}),(0,d.jsx)(n.th,{children:"Documentation"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"automations"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0.2.0"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/idle-engine-design.md"})," (\xa76.2)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"transforms"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0.3.0"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/idle-engine-design.md"})," (\xa76.2)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"runtimeEvents"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0.3.0"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"docs/runtime-event-pubsub-design.md"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"prestigeLayers"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0.4.0"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/idle-engine-design.md"})," (\xa76.2)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"entities"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"0.5.0"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/idle-engine-design.md"})," (\xa76.2)"]})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:["When ",(0,d.jsx)(n.code,{children:"metadata.engine"})," omits or predates the required version, validation pushes\nstructured ",(0,d.jsx)(n.code,{children:"FeatureViolation"})," errors or warnings (see\n",(0,d.jsx)(n.code,{children:"resolveFeatureViolations"})," in ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/runtime-compat.ts"}),")."]}),"\n",(0,d.jsx)(n.h3,{id:"compatibility-checklist",children:"Compatibility checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Set ",(0,d.jsx)(n.code,{children:"metadata.engine"})," before authoring gated modules so compatibility\nerrors appear during ",(0,d.jsx)(n.code,{children:"pnpm generate"}),"."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Treat feature-gate warnings (",(0,d.jsx)(n.code,{children:"severity: warning"}),") as TODOs\u2014either upgrade\nthe runtime target or trim gated modules before shipping."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Include CLI logs from ",(0,d.jsx)(n.code,{children:"pnpm generate"})," in review artifacts whenever\ncompatibility adjustments are part of the change."]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","If runtime contracts evolve, update this table and the pack metadata in\nthe same pull request to avoid drift."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"migration-matrix",children:"Migration matrix"}),"\n",(0,d.jsx)(n.p,{children:"Use this matrix to plan schema evolution and pack migrations in lockstep with\nthe compiler and runtime guardrails described in the design docs."}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Scenario"}),(0,d.jsx)(n.th,{children:"Expected action"}),(0,d.jsx)(n.th,{children:"References"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Schema fields added or behaviour changes"}),(0,d.jsxs)(n.td,{children:["Run ",(0,d.jsx)(n.code,{children:"pnpm generate"})," and revalidate packs; document the change in package README and update ",(0,d.jsx)(n.code,{children:"metadata.version"})," to track the migration"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa71, \xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.5)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:["Dependency graph updates (new ",(0,d.jsx)(n.code,{children:"requires"})," / ",(0,d.jsx)(n.code,{children:"optional"})," edges)"]}),(0,d.jsxs)(n.td,{children:["Refresh installation manifests, rerun validation with updated ",(0,d.jsx)(n.code,{children:"knownPacks"}),", and capture any new warnings in CLI logs"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.6)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Runtime feature gates evolve"}),(0,d.jsxs)(n.td,{children:["Synchronise this guide\u2019s tables with ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/runtime-compat.ts"}),", adjust ",(0,d.jsx)(n.code,{children:"metadata.engine"}),", and rerun schema tests to confirm compatibility"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"packages/content-schema/src/runtime-compat.ts"}),", ",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Compiler format version or digest rules change"}),(0,d.jsx)(n.td,{children:"Rebuild generated artifacts, inspect workspace summary digests, and note migration requirements in release notes"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," (\xa75.4-\xa75.5), ",(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (\xa75.5)"]})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"transform-runtime-semantics",children:"Transform Runtime Semantics"}),"\n",(0,d.jsx)(n.p,{children:"Transforms execute deterministically in the core runtime. The following notes\nsummarize runtime behavior and the current contract."}),"\n",(0,d.jsx)(n.h3,{id:"trigger-kinds",children:"Trigger kinds"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"manual"}),": executed only via ",(0,d.jsx)(n.code,{children:"RUN_TRANSFORM"})," commands (player/system only)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"condition"}),": evaluated each tick against ",(0,d.jsx)(n.code,{children:"ConditionContext"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"event"}),": fires when the runtime event bus publishes the matching ",(0,d.jsx)(n.code,{children:"eventId"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"automation"}),": fires when the referenced automation publishes ",(0,d.jsx)(n.code,{children:"automation:fired"}),"\n(requires a matching ",(0,d.jsx)(n.code,{children:"automation"})," block on the transform)."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Event and automation triggers are coalesced per transform per tick: multiple\nevents in the same tick create a single pending activation that is retained\nuntil the transform succeeds (blocked by cooldown, inputs, or safety limits)."}),"\n",(0,d.jsx)(n.h3,{id:"mode-semantics",children:"Mode semantics"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"instant"}),": spend inputs atomically and apply outputs immediately in the same tick."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"batch"}),": spend inputs immediately, then deliver outputs after ",(0,d.jsx)(n.code,{children:"duration"})," (milliseconds,\nstep-based). Outstanding batches are capped by ",(0,d.jsx)(n.code,{children:"safety.maxOutstandingBatches"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"mission"}),": spend inputs immediately, deploy entity instances, then resolve an outcome at completion\n(single-stage ",(0,d.jsx)(n.code,{children:"duration"})," or ",(0,d.jsx)(n.code,{children:"stages[].duration"})," in milliseconds). Multi-stage missions may pause\non decisions until a ",(0,d.jsx)(n.code,{children:"MAKE_MISSION_DECISION"})," command is received."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"continuous"}),": formulas evaluate to per-second rates with accumulator semantics;\nruntime execution is not yet supported (see Limitations)."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"mission-semantics-mission-mode-transforms",children:"Mission semantics (mission-mode transforms)"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Mission-mode transforms require the Entity System and entities with ",(0,d.jsx)(n.code,{children:"trackInstances: true"})," so the runtime can deploy specific instances."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"entityRequirements[]"})," selects available instances. Optional ",(0,d.jsx)(n.code,{children:"minStats"})," and ",(0,d.jsx)(n.code,{children:"preferHighStats"})," guide selection; deployed instances are unavailable until they return."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"successRate.baseRate"})," defaults to ",(0,d.jsx)(n.code,{children:"1"})," when omitted (always succeed). ",(0,d.jsx)(n.code,{children:"statModifiers"})," adjust the base rate from deployed entity stats. ",(0,d.jsx)(n.code,{children:"usePRD: true"})," uses a deterministic PRD registry keyed by transform id to reduce streakiness."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"outcomes"})," define the resource outputs (and optional ",(0,d.jsx)(n.code,{children:"entityExperience"})," / ",(0,d.jsx)(n.code,{children:"entityDamage"}),") applied when the mission completes."]}),"\n",(0,d.jsxs)(n.li,{children:["Multi-stage missions:","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"stages[].checkpoint"})," outputs are applied when a stage completes."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"stages[].decision"})," pauses the mission and emits ",(0,d.jsx)(n.code,{children:"mission:decision-required"})," until a ",(0,d.jsx)(n.code,{children:"MAKE_MISSION_DECISION"})," command is received (or the decision ",(0,d.jsx)(n.code,{children:"timeout"})," elapses and the ",(0,d.jsx)(n.code,{children:"defaultOption"})," is used)."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["Mission mode emits runtime events including ",(0,d.jsx)(n.code,{children:"mission:started"}),", ",(0,d.jsx)(n.code,{children:"mission:stage-completed"}),", ",(0,d.jsx)(n.code,{children:"mission:decision-required"}),", ",(0,d.jsx)(n.code,{children:"mission:decision-made"}),", and ",(0,d.jsx)(n.code,{children:"mission:completed"}),"."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"cooldowns-and-safety-limits",children:"Cooldowns and safety limits"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Cooldowns apply only after a successful run; failed attempts do not advance cooldown."}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"safety.maxRunsPerTick"}),": default 10, hard cap 100."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"safety.maxOutstandingBatches"}),": default 50, hard cap 1000."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"unlock-and-visibility",children:"Unlock and visibility"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"unlockCondition"})," is monotonic (once unlocked, stays unlocked) and gates execution."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"visibilityCondition"})," is evaluated each tick and affects UI/snapshot visibility only."]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"formula-evaluation-guardrails",children:"Formula evaluation guardrails"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"inputs[].amount"}),", ",(0,d.jsx)(n.code,{children:"outputs[].amount"}),", ",(0,d.jsx)(n.code,{children:"duration"}),", and ",(0,d.jsx)(n.code,{children:"cooldown"})," accept numeric formulas."]}),"\n",(0,d.jsxs)(n.li,{children:["Mission-only fields also accept formulas (",(0,d.jsx)(n.code,{children:"entityRequirements[].count"}),", ",(0,d.jsx)(n.code,{children:"successRate.baseRate"}),", stage durations/timeouts, and outcome outputs)."]}),"\n",(0,d.jsxs)(n.li,{children:["Non-finite evaluations invalidate the run; negative values are clamped to ",(0,d.jsx)(n.code,{children:"0"}),"."]}),"\n",(0,d.jsx)(n.li,{children:"Inputs are evaluated and validated before any spend to preserve atomicity."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"limitations-and-follow-ups",children:"Limitations and follow-ups"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"continuous"})," mode is defined in schema but not yet supported by the runtime."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"RUN_TRANSFORM"})," is restricted to ",(0,d.jsx)(n.code,{children:"PLAYER"})," and ",(0,d.jsx)(n.code,{children:"SYSTEM"})," priorities."]}),"\n",(0,d.jsx)(n.li,{children:"Mission transforms require the Entity System to be enabled in runtime wiring."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"transform-patterns--cycle-detection",children:"Transform Patterns & Cycle Detection"}),"\n",(0,d.jsxs)(n.p,{children:["The content schema validates transform chains and unlock conditions for cycles\nat ",(0,d.jsx)(n.strong,{children:"build time"})," (during ",(0,d.jsx)(n.code,{children:"pnpm generate"}),") to prevent content packs that would\ncause runaway production loops or deadlocked progression at runtime.\nUnderstanding these validation rules helps authors design safe and functional\ntransform networks."]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Important"}),": Cycle detection is a ",(0,d.jsx)(n.strong,{children:"build-time safety check"})," that runs\nduring content pack validation. Transform cycles are allowed only when the\noverall conversion is net-loss or neutral ",(0,d.jsx)(n.strong,{children:"and"})," every transform in the cycle\nhas exactly one input and one output with constant positive amounts. Net-positive\ncycles, or cycles that cannot be evaluated under those rules, are rejected\nbefore they can be loaded into the game engine."]}),"\n",(0,d.jsx)(n.h3,{id:"what-constitutes-a-cycle",children:"What Constitutes a Cycle"}),"\n",(0,d.jsxs)(n.p,{children:["A ",(0,d.jsx)(n.strong,{children:"transform cycle"})," exists when transforms form a closed loop through their\nresource dependencies:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Direct cycle (A \u2192 B \u2192 A)"}),": Transform A produces a resource that Transform B\nconsumes, and Transform B produces a resource that Transform A consumes."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Indirect cycle (A \u2192 B \u2192 C \u2192 A)"}),": A chain of transforms that eventually\nfeeds back to the starting transform through intermediate resources."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Multi-resource cycle"}),": Transforms with multiple inputs/outputs that create\ncircular dependencies (for example Transform A consumes X + Y and produces Z,\nwhile Transforms B and C consume Z to produce X and Y respectively)."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["An ",(0,d.jsx)(n.strong,{children:"unlock condition cycle"})," exists when entities have circular unlock\ndependencies:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Resource A unlocks when Resource B \u2265 threshold"}),"\n",(0,d.jsx)(n.li,{children:"Resource B unlocks when Resource A \u2265 threshold"}),"\n",(0,d.jsxs)(n.li,{children:["Similar patterns exist for generators, upgrades, achievements, and other\nentities with ",(0,d.jsx)(n.code,{children:"unlockCondition"})," fields"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Both types of cycles are ",(0,d.jsx)(n.strong,{children:"detected automatically"})," during validation and will\ncause ",(0,d.jsx)(n.code,{children:"pnpm generate"})," to fail with detailed error messages showing the cycle\npath."]}),"\n",(0,d.jsx)(n.h3,{id:"safe-transform-patterns",children:"Safe Transform Patterns"}),"\n",(0,d.jsx)(n.p,{children:"Design transforms using these patterns to avoid cycles:"}),"\n",(0,d.jsx)(n.h4,{id:"-linear-transformation-chains",children:"\u2705 Linear transformation chains"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "transforms": [\n    {\n      "id": "raw-to-refined",\n      "inputs": [{ "resourceId": "raw-ore", "amount": { "kind": "constant", "value": 1 } }],\n      "outputs": [{ "resourceId": "refined-metal", "amount": { "kind": "constant", "value": 1 } }]\n    },\n    {\n      "id": "refined-to-alloy",\n      "inputs": [{ "resourceId": "refined-metal", "amount": { "kind": "constant", "value": 2 } }],\n      "outputs": [{ "resourceId": "alloy", "amount": { "kind": "constant", "value": 1 } }]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"This creates a one-way progression: raw-ore \u2192 refined-metal \u2192 alloy."}),"\n",(0,d.jsx)(n.h4,{id:"-resource-sinks-consumables",children:"\u2705 Resource sinks (consumables)"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "transforms": [\n    {\n      "id": "craft-boost",\n      "inputs": [\n        { "resourceId": "mana", "amount": { "kind": "constant", "value": 100 } },\n        { "resourceId": "essence", "amount": { "kind": "constant", "value": 10 } }\n      ],\n      "outputs": [{ "resourceId": "boost-item", "amount": { "kind": "constant", "value": 1 } }]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Resources are consumed but not regenerated through transforms, creating a\none-way flow."}),"\n",(0,d.jsx)(n.h4,{id:"-convergent-production-trees",children:"\u2705 Convergent production trees"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "transforms": [\n    {\n      "id": "wood-to-planks",\n      "inputs": [{ "resourceId": "wood", "amount": { "kind": "constant", "value": 1 } }],\n      "outputs": [{ "resourceId": "planks", "amount": { "kind": "constant", "value": 4 } }]\n    },\n    {\n      "id": "stone-to-bricks",\n      "inputs": [{ "resourceId": "stone", "amount": { "kind": "constant", "value": 1 } }],\n      "outputs": [{ "resourceId": "bricks", "amount": { "kind": "constant", "value": 2 } }]\n    },\n    {\n      "id": "build-house",\n      "inputs": [\n        { "resourceId": "planks", "amount": { "kind": "constant", "value": 20 } },\n        { "resourceId": "bricks", "amount": { "kind": "constant", "value": 10 } }\n      ],\n      "outputs": [{ "resourceId": "house", "amount": { "kind": "constant", "value": 1 } }]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Multiple resource streams converge but never loop back to their sources."}),"\n",(0,d.jsx)(n.h4,{id:"-lossy-exchange-loops-allowed",children:"\u2705 Lossy exchange loops (allowed)"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "transforms": [\n    {\n      "id": "essence-to-gold",\n      "inputs": [{ "resourceId": "essence", "amount": { "kind": "constant", "value": 100 } }],\n      "outputs": [{ "resourceId": "gold", "amount": { "kind": "constant", "value": 80 } }]\n    },\n    {\n      "id": "gold-to-essence",\n      "inputs": [{ "resourceId": "gold", "amount": { "kind": "constant", "value": 100 } }],\n      "outputs": [{ "resourceId": "essence", "amount": { "kind": "constant", "value": 90 } }]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"This bidirectional exchange is allowed because the overall conversion is net-loss."}),"\n",(0,d.jsx)(n.h4,{id:"-net-positive-transform-cycles",children:"\u274c Net-positive transform cycles"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "transforms": [\n    {\n      "id": "water-to-steam",\n      "inputs": [{ "resourceId": "water", "amount": { "kind": "constant", "value": 100 } }],\n      "outputs": [{ "resourceId": "steam", "amount": { "kind": "constant", "value": 120 } }]\n    },\n    {\n      "id": "steam-to-water",\n      "inputs": [{ "resourceId": "steam", "amount": { "kind": "constant", "value": 100 } }],\n      "outputs": [{ "resourceId": "water", "amount": { "kind": "constant", "value": 110 } }]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Validation error"}),": ",(0,d.jsx)(n.code,{children:"Transform cycle detected: water-to-steam \u2192 steam-to-water \u2192 water-to-steam"})]}),"\n",(0,d.jsx)(n.h3,{id:"safe-unlock-condition-patterns",children:"Safe Unlock Condition Patterns"}),"\n",(0,d.jsx)(n.p,{children:"Design unlock conditions that form directed acyclic graphs (DAGs):"}),"\n",(0,d.jsx)(n.h4,{id:"-self-threshold-unlock-after-first-production",children:"\u2705 Self-threshold (unlock after first production)"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "resources": [\n    {\n      "id": "ore",\n      "visible": false,\n      "unlocked": false,\n      "unlockCondition": {\n        "kind": "resourceThreshold",\n        "resourceId": "ore",\n        "comparator": "gte",\n        "amount": { "kind": "constant", "value": 1 }\n      }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsxs)(n.p,{children:["When ",(0,d.jsx)(n.code,{children:"visibilityCondition"})," is omitted, visibility follows unlock by default. Provide a\nvisibility condition only when you want a different reveal timing (for example,\nshow-before-unlock teasers)."]}),"\n",(0,d.jsx)(n.p,{children:"This pattern is supported for resources and does not introduce an unlock-cycle edge. Ensure the resource can still be produced (for example by a generator or transform) while hidden/locked."}),"\n",(0,d.jsx)(n.h4,{id:"-progressive-unlocks",children:"\u2705 Progressive unlocks"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "resources": [\n    { "id": "tier-1-resource" },\n    {\n      "id": "tier-2-resource",\n      "unlockCondition": {\n        "kind": "resourceThreshold",\n        "resourceId": "tier-1-resource",\n        "comparator": "gte",\n        "amount": { "kind": "constant", "value": 100 }\n      }\n    },\n    {\n      "id": "tier-3-resource",\n      "unlockCondition": {\n        "kind": "resourceThreshold",\n        "resourceId": "tier-2-resource",\n        "comparator": "gte",\n        "amount": { "kind": "constant", "value": 50 }\n      }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"Clear one-way progression through tiers."}),"\n",(0,d.jsx)(n.h4,{id:"-circular-unlock-dependencies",children:"\u274c Circular unlock dependencies"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "resources": [\n    {\n      "id": "resource-a",\n      "unlockCondition": {\n        "kind": "resourceThreshold",\n        "resourceId": "resource-b",\n        "comparator": "gte",\n        "amount": { "kind": "constant", "value": 10 }\n      }\n    },\n    {\n      "id": "resource-b",\n      "unlockCondition": {\n        "kind": "resourceThreshold",\n        "resourceId": "resource-a",\n        "comparator": "gte",\n        "amount": { "kind": "constant", "value": 10 }\n      }\n    }\n  ]\n}\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Validation error"}),": ",(0,d.jsx)(n.code,{children:"Unlock condition cycle detected: resource-a \u2192 resource-b \u2192 resource-a"})]}),"\n",(0,d.jsx)(n.h3,{id:"transform-cycle-detection-checklist",children:"Transform Cycle Detection Checklist"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Map out resource flow graphs on paper before implementing complex\ntransform networks"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ",'Ensure all transform chains have clear "source" resources (from generators\nor initial grants) and "sink" resources (consumed but not regenerated)']}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Ensure bidirectional transforms are net-loss or neutral and use constant\nsingle-input/single-output amounts so cycle profitability can be evaluated"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Run ",(0,d.jsx)(n.code,{children:"pnpm generate"})," after adding transforms and address any cycle\ndetection errors immediately"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test unlock progressions manually to confirm resources become available in\nthe expected order"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"migrating-existing-content-with-cycles",children:"Migrating Existing Content with Cycles"}),"\n",(0,d.jsxs)(n.p,{children:["If ",(0,d.jsx)(n.code,{children:"pnpm generate"})," fails with cycle detection errors after upgrading:"]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Identify the cycle"}),": Read the error message carefully. It shows the\ncomplete cycle path (e.g., ",(0,d.jsx)(n.code,{children:"transform-a \u2192 transform-b \u2192 transform-a"}),")."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Understand the dependencies"}),": Map out which resources each transform\nconsumes and produces. Draw a diagram if helpful."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Break the cycle"})," using one of these strategies:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Add source resources"}),": Introduce generators or initial grants to provide\nresources from outside the cycle"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Convert to linear chain"}),": Redesign bidirectional transforms as one-way\nprogression (A \u2192 B \u2192 C instead of A \u21c4 B)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Make cycles net-loss"}),": Reduce outputs or increase inputs so the overall\nconversion ratio is \u2264 1.0 for each loop"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Add intermediate resources"}),": Insert new resources in the chain to create\na clear flow direction"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Remove problematic transforms"}),": If a transform creates an unwanted loop,\nconsider removing it or replacing it with a different game mechanic"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"For unlock condition cycles"}),": Similar approach applies. If Resource A\nrequires Resource B to unlock, and Resource B requires Resource A, redesign\nthe unlock progression to be hierarchical (introduce a Resource C that both\ndepend on, or remove one unlock condition)."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Re-run validation"}),": After making changes, run ",(0,d.jsx)(n.code,{children:"pnpm generate"})," again to\nverify all cycles are resolved."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Implementation details"}),": Cycle detection is implemented in\n",(0,d.jsx)(n.code,{children:"packages/content-schema/src/pack/validate-cycles.ts"})," via ",(0,d.jsx)(n.code,{children:"validateTransformCycles()"})," and\n",(0,d.jsx)(n.code,{children:"validateUnlockConditionCycles()"})," functions, using depth-first search with path\ntracking to provide detailed error messages. Cycle profitability is only\nevaluated for single-input/single-output transforms with constant amounts; more\ncomplex cycles are rejected as potentially profitable."]}),"\n",(0,d.jsx)(n.h3,{id:"safety-guardrails",children:"Safety Guardrails"}),"\n",(0,d.jsx)(n.p,{children:"In addition to cycle detection, transforms include runtime safety limits defined\nin the transform schema:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"maxRunsPerTick"}),": Caps executions per simulation step (default and max values\nenforced)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"maxOutstandingBatches"}),": Limits queued batch transforms (prevents unbounded\nqueue growth)"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["These guards complement cycle detection by preventing runaway transforms even in\nedge cases. See ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/modules/transforms.ts"})," for\nenforcement details."]}),"\n",(0,d.jsx)(n.h2,{id:"reference-examples--tooling",children:"Reference Examples & Tooling"}),"\n",(0,d.jsx)(n.p,{children:"Use the sample pack as a living reference:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"packages/content-sample/content/pack.json"})," illustrates metadata layout,\ndependency declarations, and module IDs."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"packages/content-sample/src/generated/@idle-engine/sample-pack.generated.ts"})," shows the\ncompiler outputs that should accompany every content change."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"packages/content-sample/src/index.ts"})," demonstrates import-time guards that\nthrow when compiler warnings slip through."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["The CLI in ",(0,d.jsx)(n.code,{children:"tools/content-schema-cli/src/generate.js"})," orchestrates validation,\nmanifest regeneration, and compilation. It emits structured\n",(0,d.jsx)(n.code,{children:"content_pack.*"})," log lines\u2014treat any new warning or error as a release blocker."]}),"\n",(0,d.jsx)(n.h2,{id:"balance-validation-defaults--commands",children:"Balance validation defaults & commands"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"pnpm generate"})," (or ",(0,d.jsx)(n.code,{children:"pnpm generate --check"}),") runs schema + balance validation\nand logs ",(0,d.jsx)(n.code,{children:"content_pack.balance_warning"})," / ",(0,d.jsx)(n.code,{children:"content_pack.balance_failed"})," when\ninvariants break; balance errors fail the run."]}),"\n",(0,d.jsxs)(n.li,{children:["Defaults for ",(0,d.jsx)(n.code,{children:"ContentSchemaOptions.balance"}),": enabled, ",(0,d.jsx)(n.code,{children:"sampleSize"})," = 100\npurchase indices (levels 0\u2013100), ",(0,d.jsx)(n.code,{children:"maxGrowth"})," = 20\xd7 between adjacent\npurchases, ",(0,d.jsx)(n.code,{children:"warnOnly"})," = false. Use ",(0,d.jsx)(n.code,{children:"warnOnly"})," only for local exploration;\ntreat any warning as a regression before shipping."]}),"\n",(0,d.jsx)(n.li,{children:"Checks cover non-negative rates, non-decreasing costs for generators/upgrades\n(including repeatables) and prestige rewards, growth-cap enforcement, and\nunlock ordering so consumed resources unlock no later than their dependents."}),"\n",(0,d.jsxs)(n.li,{children:["Validation is deterministic; property suites that guard balance and formulas\nare seeded (e.g., fast-check seeds in the 422000 range) to keep\n",(0,d.jsx)(n.code,{children:"vitest-llm-reporter"})," output stable. Keep seeds unchanged unless debugging."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"verification-runbook",children:"Verification Runbook"}),"\n",(0,d.jsx)(n.p,{children:"Run these commands before requesting review:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"pnpm generate\npnpm exec markdownlint docs/content-dsl-usage-guidelines.md\npnpm lint --filter @idle-engine/content-schema\n"})}),"\n",(0,d.jsxs)(n.p,{children:["If you modify shell UI flows or runtime contracts in parallel, extend the\nchecklist with the relevant test suites (for example ",(0,d.jsx)(n.code,{children:"pnpm test --filter core"}),")."]}),"\n",(0,d.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines-design.md"})," \u2014 rationale, scope, and\nacceptance criteria for this guide."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," \u2014 field-level reference for the DSL."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"docs/content-compiler-design.md"})," \u2014 details on generated artifacts and\nsummary modules."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"packages/content-sample/README.md"})," \u2014 regeneration workflow and runtime\nmanifest integration."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"formula-invariants--cost-semantics",children:"Formula Invariants & Cost Semantics"}),"\n",(0,d.jsxs)(n.p,{children:["Content formulas must evaluate to finite, non-negative numbers across deterministic contexts. The schema and CLI suites enforce this via property-based tests (see ",(0,d.jsx)(n.code,{children:"packages/content-schema/src/base/formulas.property.test.ts"})," and ",(0,d.jsx)(n.code,{children:"tools/content-schema-cli/src/__tests__/validation.property.test.ts"}),"). Authors should follow these rules when declaring rates and costs:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Generator rates and consumption values: use ",(0,d.jsx)(n.code,{children:"NumericFormula"})," that remain \u2265 0. Prefer clamping via ",(0,d.jsx)(n.code,{children:"max(0, \u2026)"})," or the ",(0,d.jsx)(n.code,{children:"abs"}),"/",(0,d.jsx)(n.code,{children:"sqrt"})," helpers when composing expressions."]}),"\n",(0,d.jsxs)(n.li,{children:["Purchase cost calculation: cost = ",(0,d.jsx)(n.code,{children:"costMultiplier \xd7 evaluate(costCurve, level)"})," where ",(0,d.jsx)(n.code,{children:"level"})," is the current purchase index (owned count). For upgrades, if ",(0,d.jsx)(n.code,{children:"repeatable.costCurve"})," is present, multiply that in as well. See ",(0,d.jsx)(n.code,{children:"docs/progression-coordinator-design.md"})," \xa76.2.7."]}),"\n",(0,d.jsxs)(n.li,{children:["Avoid NaN/Infinity: inputs are validated (",(0,d.jsx)(n.code,{children:"finiteNumberSchema"}),"), and formulas with impossible evaluations are rejected."]}),"\n",(0,d.jsxs)(n.li,{children:["Piecewise: ensure strictly increasing ",(0,d.jsx)(n.code,{children:"untilLevel"})," thresholds and a final catch-all segment."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Note: ",(0,d.jsx)(n.code,{children:"costMultiplier"})," is a multiplier applied to the cost curve result. If you want ",(0,d.jsx)(n.code,{children:"costCurve.base"})," to be the starting cost, set ",(0,d.jsx)(n.code,{children:"costMultiplier"})," to ",(0,d.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,d.jsxs)(n.p,{children:["Breaking change (next major release): ",(0,d.jsx)(n.code,{children:"baseCost"})," has been removed. Update generator ",(0,d.jsx)(n.code,{children:"purchase"})," and upgrade ",(0,d.jsx)(n.code,{children:"cost"})," blocks to use ",(0,d.jsx)(n.code,{children:"costMultiplier"}),", then rerun ",(0,d.jsx)(n.code,{children:"pnpm generate"})," to refresh compiled artifacts before upgrading."]}),"\n",(0,d.jsx)(n.h3,{id:"exponential-cost-curve-formula",children:"Exponential Cost Curve Formula"}),"\n",(0,d.jsxs)(n.p,{children:["The exponential formula evaluates as: ",(0,d.jsx)(n.code,{children:"base \xd7 growth^level + offset"})]}),"\n",(0,d.jsxs)(n.p,{children:["When used as a ",(0,d.jsx)(n.code,{children:"costCurve"}),", this combines with ",(0,d.jsx)(n.code,{children:"costMultiplier"})," to produce:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"totalCost = costMultiplier \xd7 (base \xd7 growth^level + offset)\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Important"}),": The ",(0,d.jsx)(n.code,{children:"base"})," parameter defaults to ",(0,d.jsx)(n.code,{children:"1"}),". For the standard idle game cost curve where ",(0,d.jsx)(n.code,{children:"costMultiplier"})," alone represents the level-0 cost, simply omit ",(0,d.jsx)(n.code,{children:"base"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "costMultiplier": 120,\n  "costCurve": { "kind": "exponential", "growth": 1.15 }\n}\n// At level 0: 120 \xd7 1 \xd7 1.15^0 = 120\n// At level 1: 120 \xd7 1 \xd7 1.15^1 = 138\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Alternate pattern"}),": If you want ",(0,d.jsx)(n.code,{children:"costCurve.base"})," to define the starting cost, use ",(0,d.jsx)(n.code,{children:"costMultiplier: 1"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "costMultiplier": 1,\n  "costCurve": { "kind": "exponential", "base": 120, "growth": 1.15 }\n}\n// At level 0: 1 \xd7 120 \xd7 1.15^0 = 120\n// At level 1: 1 \xd7 120 \xd7 1.15^1 = 138\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Common mistake"}),": Setting ",(0,d.jsx)(n.code,{children:"base"})," equal to ",(0,d.jsx)(n.code,{children:"costMultiplier"})," multiplies twice:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\n  "costMultiplier": 10,\n  "costCurve": { "kind": "exponential", "base": 10, "growth": 1.15 }\n}\n// At level 0: 10 \xd7 10 \xd7 1.15^0 = 100 (not 10!)\n'})}),"\n",(0,d.jsxs)(n.p,{children:["Use a non-default ",(0,d.jsx)(n.code,{children:"base"})," only when you need an additional scaling factor independent of ",(0,d.jsx)(n.code,{children:"costMultiplier"}),"."]}),"\n",(0,d.jsx)(n.p,{children:"Automation authoring guidance:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"resourceCost.rate"})," represents units per second; keep bounds realistic for your economy to avoid runaway drains."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"cooldown"})," must be finite (milliseconds). Use a number or a ",(0,d.jsx)(n.code,{children:"NumericFormula"}),"; prefer \u2265 0. Extremely small values can lead to noisy behavior during testing."]}),"\n",(0,d.jsxs)(n.li,{children:["Keep ",(0,d.jsx)(n.code,{children:"generate --check"})," warning-free for shipping packs. The sample pack is treated as the reference baseline."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"snapshot-determinism-progression-views",children:"Snapshot Determinism (Progression Views)"}),"\n",(0,d.jsxs)(n.p,{children:["The progression view (",(0,d.jsx)(n.code,{children:"buildProgressionSnapshot"}),") must be deterministic so that UI/state diffs remain stable when content changes. Tests in ",(0,d.jsx)(n.code,{children:"@idle-engine/content-sample"})," generate a golden snapshot for the sample pack\u2019s generators and upgrades and compare it during CI."]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Fields covered: generator ",(0,d.jsx)(n.code,{children:"costs"}),", ",(0,d.jsx)(n.code,{children:"produces"}),"/",(0,d.jsx)(n.code,{children:"consumes"})," rates, visibility/unlock flags, and upgrade ",(0,d.jsx)(n.code,{children:"status"})," + ",(0,d.jsx)(n.code,{children:"costs"}),"."]}),"\n",(0,d.jsx)(n.li,{children:"Authors changing content should expect golden updates when business logic changes intentionally; otherwise treat diffs as regressions."}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"References:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"docs/content-dsl-schema-design.md"})," (schema contracts)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"packages/core/src/progression.ts"})," (snapshot construction)"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},7678:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(9430);const d={},r=i.createContext(d);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);