"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[2874],{5659:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"create-game-factory-design-issue-750","title":"CreateGame Factory Design (Issue 750)","description":"Document Control","source":"@site/../../docs/create-game-factory-design-issue-750.md","sourceDirName":".","slug":"/create-game-factory-design-issue-750","permalink":"/Idle-Game-Engine/create-game-factory-design-issue-750","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/create-game-factory-design-issue-750.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"CreateGame Factory Design (Issue 750)","sidebar_position":6}}');var r=s(5270),t=s(7678);const c={title:"CreateGame Factory Design (Issue 750)",sidebar_position:6},d="CreateGame Factory Design (Issue 750)",a={},o=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"creategame-factory-design-issue-750",children:"CreateGame Factory Design (Issue 750)"})}),"\n",(0,r.jsx)(n.h2,{id:"document-control",children:"Document Control"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Title"}),": Introduce ",(0,r.jsx)(n.code,{children:"createGame()"})," high-level factory (Issue 750)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authors"}),": Codex (AI)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reviewers"}),": TODO (Owner: Runtime Core Maintainers)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status"}),": Draft"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Last Updated"}),": 2026-01-15"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Related Issues"}),": ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/750",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/750"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execution Mode"}),": AI-led"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,r.jsxs)(n.p,{children:["In regards to issue 750 on GitHub (\u201cfeat(core): add high-level createGame factory for simplified onboarding\u201d), this design introduces a stable ",(0,r.jsx)(n.code,{children:"createGame(contentPack, options?)"})," fa\xe7ade that wraps existing runtime wiring (",(0,r.jsx)(n.code,{children:"createGameRuntime"}),") to deliver a minimal, type-safe ",(0,r.jsx)(n.code,{children:"Game"})," interface (lifecycle, snapshots, player actions, persistence, events) while retaining advanced access via ",(0,r.jsx)(n.code,{children:"game.internals"})," and preserving the deterministic command-queue execution model."]}),"\n",(0,r.jsx)(n.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Background"}),": Issue 750 targets developer onboarding friction when integrating the deterministic runtime exposed via the stable public entrypoint (",(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts:19"}),") and its current primary wiring function (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Issue 750 reports that new developers must understand and plumb numerous internals (runtime host, coordinator, command queue/dispatcher, and per-domain systems) returned by ",(0,r.jsx)(n.code,{children:"GameRuntimeWiring"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"}),"), and must correctly stamp/queue commands to mutate state deterministically (priority/step/timestamp as described in ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:589"})," and ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Forces"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Determinism must be preserved: within a priority tier, commands execute in timestamp order (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:594"}),"), and existing systems already derive timestamps from simulation time for replay safety (",(0,r.jsx)(n.code,{children:"packages/core/src/automation-system.ts:967"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The stable public surface is intentionally small and contract-tested (",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"}),"); Issue 750 must remain additive and avoid exporting broad internals."]}),"\n",(0,r.jsxs)(n.li,{children:["Browser-safe, host-agnostic API: no Node-only dependencies in ",(0,r.jsx)(n.code,{children:"@idle-engine/core"})," public entrypoint; any scheduler/timer behavior must remain optional and side-effect-contained."]}),"\n",(0,r.jsxs)(n.li,{children:["Backwards compatibility: existing ",(0,r.jsx)(n.code,{children:"createGameRuntime"}),"/",(0,r.jsx)(n.code,{children:"wireGameRuntime"})," integrations remain supported (",(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts:19"}),"), with clear guidance that Issue 750\u2019s ",(0,r.jsx)(n.code,{children:"createGame"})," is the preferred onboarding path."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Goals"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750 provides a one-call bootstrap (",(0,r.jsx)(n.code,{children:"createGame(contentPack)"}),") that yields a working runtime with default systems/handlers auto-wired (via existing wiring in ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:81"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750 defines a stable ",(0,r.jsx)(n.code,{children:"Game"})," interface in ",(0,r.jsx)(n.code,{children:"packages/core/src/game.ts"})," that includes:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Lifecycle: ",(0,r.jsx)(n.code,{children:"start"}),", ",(0,r.jsx)(n.code,{children:"stop"}),", ",(0,r.jsx)(n.code,{children:"tick"})]}),"\n",(0,r.jsxs)(n.li,{children:["State: ",(0,r.jsx)(n.code,{children:"getSnapshot"})," returning a UI-ready snapshot derived from ",(0,r.jsx)(n.code,{children:"buildProgressionSnapshot"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Persistence: ",(0,r.jsx)(n.code,{children:"serialize"}),"/",(0,r.jsx)(n.code,{children:"hydrate"})," over the existing save schema (",(0,r.jsx)(n.code,{children:"packages/core/src/game-state-save.ts:24"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Player actions: type-safe convenience methods mapping to ",(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Events: ",(0,r.jsx)(n.code,{children:"on(...)"})," wrapper over runtime event bus subscriptions (",(0,r.jsx)(n.code,{children:"packages/core/src/events/event-bus.ts:54"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Progressive disclosure: ",(0,r.jsx)(n.code,{children:"internals: GameRuntimeWiring"})," for advanced use cases"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750 standardizes command stamping for fa\xe7ade player actions:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Priority defaults to ",(0,r.jsx)(n.code,{children:"CommandPriority.PLAYER"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:77"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Step defaults to ",(0,r.jsx)(n.code,{children:"runtime.getNextExecutableStep()"})," (per queue design guidance in ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Timestamp defaults to simulation-time derived values (pattern in ",(0,r.jsx)(n.code,{children:"packages/core/src/automation-system.ts:1040"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750 updates documentation to include a ",(0,r.jsx)(n.code,{children:"createGame()"})," onboarding example (",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md:1"}),") and references the layered architecture justification (",(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md:190"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750 adds integration tests validating factory behavior and action-method command enqueueing (patterned after ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.test.ts:101"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Non-Goals"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750 does not remove or redesign ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," / ",(0,r.jsx)(n.code,{children:"wireGameRuntime"})," or relocate them between entrypoints (follow-up optional)."]}),"\n",(0,r.jsx)(n.li,{children:"Issue 750 does not introduce new command types, change command-queue ordering semantics, or execute commands outside tick boundaries."}),"\n",(0,r.jsx)(n.li,{children:"Issue 750 does not ship a full host shell/worker bridge; it only provides a runtime fa\xe7ade suitable for downstream shells to embed."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Primary Stakeholders"}),": Issue 750 is owned by Runtime Core maintainers, with downstream game integrators and Docs maintainers as stakeholders for adoption and guidance."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent Roles"}),":"]}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Agent"}),(0,r.jsx)(n.th,{children:"Responsibilities"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Runtime API Agent"}),(0,r.jsxs)(n.td,{children:["Issue 750: implement ",(0,r.jsx)(n.code,{children:"packages/core/src/game.ts"})," (",(0,r.jsx)(n.code,{children:"Game"}),", ",(0,r.jsx)(n.code,{children:"CreateGameOptions"}),", ",(0,r.jsx)(n.code,{children:"createGame"}),") and export via ",(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Command Semantics Agent"}),(0,r.jsxs)(n.td,{children:["Issue 750: enforce deterministic command stamping rules for fa\xe7ade action methods; ensure alignment with ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Testing Agent"}),(0,r.jsxs)(n.td,{children:["Issue 750: add Vitest integration coverage for ",(0,r.jsx)(n.code,{children:"createGame"})," lifecycle, action enqueueing, and persistence."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Docs Agent"}),(0,r.jsxs)(n.td,{children:["Issue 750: add ",(0,r.jsx)(n.code,{children:"createGame"})," onboarding examples and update any docs that position ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," as the primary integration surface."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Integration Agent"}),(0,r.jsxs)(n.td,{children:["Issue 750: verify workspace exports and stable-surface tests (",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"}),") remain valid; ensure ",(0,r.jsx)(n.code,{children:"@idle-engine/core/public"})," stays aligned."]})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Affected Packages/Services"}),": Issue 750 impacts ",(0,r.jsx)(n.code,{children:"packages/core"})," (new fa\xe7ade API), plus ",(0,r.jsx)(n.code,{children:"docs/"})," for onboarding guidance (",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md:1"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compatibility Considerations"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750 is additive: existing consumers of ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," remain unaffected."]}),"\n",(0,r.jsxs)(n.li,{children:["The stable public entrypoint will add exactly one new runtime export (",(0,r.jsx)(n.code,{children:"createGame"}),"), and must update the stable-surface contract test (",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"game.internals"})," explicitly opts users into wiring details; stability expectations remain consistent with ",(0,r.jsx)(n.code,{children:"@idle-engine/core"})," vs ",(0,r.jsx)(n.code,{children:"@idle-engine/core/internals"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750\u2019s current integration story centers on ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"}),"), which wires systems, registers command handlers, and returns a broad ",(0,r.jsx)(n.code,{children:"GameRuntimeWiring"})," object exposing runtime, coordinator, command plumbing, enabled systems, and persistence helpers (",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["There is no single \u201cgame fa\xe7ade\u201d that:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Encapsulates lifecycle scheduling (hosts must call ",(0,r.jsx)(n.code,{children:"runtime.tick(...)"})," directly),"]}),"\n",(0,r.jsxs)(n.li,{children:["Provides a default UI snapshot function (despite ",(0,r.jsx)(n.code,{children:"buildProgressionSnapshot"})," existing in ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),"),"]}),"\n",(0,r.jsxs)(n.li,{children:["Offers ergonomic, type-safe player action methods that consistently stamp commands per the command-queue contract (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"The result (as described in Issue 750) is that onboarding users either (a) misuse internals, or (b) reinvent ad-hoc wrappers that vary in determinism guarantees and error handling."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,r.jsx)(n.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Narrative"}),": Issue 750 introduces ",(0,r.jsx)(n.code,{children:"createGame(contentPack, options?)"})," as the primary onboarding API. Internally, it calls ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"}),") to produce ",(0,r.jsx)(n.code,{children:"GameRuntimeWiring"}),", then wraps it in a stable ",(0,r.jsx)(n.code,{children:"Game"})," fa\xe7ade that:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Controls ticking (manual ",(0,r.jsx)(n.code,{children:"tick"}),", optional ",(0,r.jsx)(n.code,{children:"start"}),"/",(0,r.jsx)(n.code,{children:"stop"})," scheduler),"]}),"\n",(0,r.jsxs)(n.li,{children:["Publishes UI-ready snapshots (",(0,r.jsx)(n.code,{children:"buildProgressionSnapshot"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),"),"]}),"\n",(0,r.jsxs)(n.li,{children:["Enqueues player commands via dedicated action methods that stamp ",(0,r.jsx)(n.code,{children:"priority"}),", ",(0,r.jsx)(n.code,{children:"step"}),", and deterministic ",(0,r.jsx)(n.code,{children:"timestamp"}),","]}),"\n",(0,r.jsxs)(n.li,{children:["Delegates save/load to existing schema + wiring helpers (",(0,r.jsx)(n.code,{children:"packages/core/src/game-state-save.ts:24"}),"),"]}),"\n",(0,r.jsxs)(n.li,{children:["Exposes ",(0,r.jsx)(n.code,{children:"internals"})," explicitly for advanced use cases."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Diagram"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"NormalizedContentPack\n  -> createGame(content, options?)\n       -> createGameRuntime({ content, ... })  [wires systems + handlers]\n       -> Game fa\xe7ade\n            - start/stop/tick\n            - getSnapshot() -> buildProgressionSnapshot(...)\n            - action methods -> enqueue PLAYER commands\n            - serialize/hydrate -> wiring helpers\n            - on(...) -> runtime EventBus\n            - internals -> GameRuntimeWiring\n"})}),"\n",(0,r.jsx)(n.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Runtime Changes"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.code,{children:"packages/core/src/game.ts"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"export interface Game { ... }"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"export type GameSnapshot = ProgressionSnapshot"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:279"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"export type SerializedGameState = GameStateSaveFormat"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/game-state-save.ts:46"}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"export type CreateGameOptions = Readonly<{ ... }>"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"export function createGame(content: NormalizedContentPack, options?: CreateGameOptions): Game"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Export ",(0,r.jsx)(n.code,{children:"createGame"})," from the stable entrypoint (",(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts:19"}),") and update the stable-surface contract test (",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CreateGameOptions"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Defaults: call-site should be able to omit all options for the \u201cone-liner\u201d onboarding path."}),"\n",(0,r.jsxs)(n.li,{children:["Advanced factory configuration from Issue 750 maps onto existing wiring toggles and engine config:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"systems.*"})," \u2192 ",(0,r.jsx)(n.code,{children:"CreateGameRuntimeOptions.enable*"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:902"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"eventBus.capacity"})," \u2192 ",(0,r.jsx)(n.code,{children:"EngineConfigOverrides.limits.eventBusDefaultChannelCapacity"})," (wired into ",(0,r.jsx)(n.code,{children:"createGameRuntime"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:943"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"diagnostics.*"})," \u2192 ",(0,r.jsx)(n.code,{children:"IdleEngineRuntime.enableDiagnostics(...)"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:347"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Proposed shape (exact naming finalized during implementation; TODO owner: Runtime Core maintainers):"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export type CreateGameOptions = Readonly<{\n  readonly config?: EngineConfigOverrides;\n  readonly stepSizeMs?: number;\n  readonly maxStepsPerFrame?: number;\n  readonly initialStep?: number;\n  readonly initialProgressionState?: ProgressionAuthoritativeState;\n\n  readonly systems?: Readonly<{\n    readonly production?: boolean;\n    readonly automation?: boolean;\n    readonly transforms?: boolean;\n    readonly entities?: boolean;\n  }>;\n\n  readonly diagnostics?: Readonly<{\n    readonly enabled?: boolean;\n    readonly timeline?: RuntimeDiagnosticsTimelineOptions | false;\n  }>;\n\n  readonly eventBus?: Readonly<{\n    readonly capacity?: number;\n  }>;\n\n  readonly scheduler?: Readonly<{\n    readonly intervalMs?: number; // default: stepSizeMs\n  }>;\n}>;\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Game Interface"})," (Issue 750; stable surface MUST match this shape):"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export type Unsubscribe = () => void;\n\nexport interface Game {\n  // Lifecycle (Issue 750)\n  start(): void;\n  stop(): void;\n  tick(deltaMs: number): void;\n\n  // State (Issue 750)\n  getSnapshot(): GameSnapshot;\n\n  // Persistence (Issue 750)\n  serialize(): SerializedGameState;\n  hydrate(save: SerializedGameState): void;\n\n  // Player actions (Issue 750)\n  purchaseGenerator(generatorId: string, count: number): CommandResult;\n  purchaseUpgrade(upgradeId: string): CommandResult;\n  toggleAutomation(automationId: string, enabled: boolean): CommandResult;\n  startTransform(transformId: string): CommandResult;\n\n  // Events (Issue 750)\n  on<TType extends RuntimeEventType>(\n    eventType: TType,\n    handler: EventHandler<TType>,\n    options?: EventSubscriptionOptions,\n  ): Unsubscribe;\n\n  // Advanced (Issue 750)\n  readonly internals: GameRuntimeWiring;\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Notes (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"getSnapshot"})," should use ",(0,r.jsx)(n.code,{children:"buildProgressionSnapshot"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),") over ",(0,r.jsx)(n.code,{children:"internals.coordinator.state"}),"; this keeps the snapshot JSON-friendly and UI-ready."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"serialize"}),"/",(0,r.jsx)(n.code,{children:"hydrate"})," should delegate to wiring helpers (",(0,r.jsx)(n.code,{children:"GameRuntimeWiring.serialize"}),"/",(0,r.jsx)(n.code,{children:"hydrate"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:179"}),") and keep the stable fa\xe7ade signature minimal; advanced options remain available via ",(0,r.jsx)(n.code,{children:"game.internals"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"start"}),"/",(0,r.jsx)(n.code,{children:"stop"})," are convenience-only; downstream hosts may ignore them and drive ",(0,r.jsx)(n.code,{children:"tick"})," directly."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Method \u2192 Command Mapping"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Each action enqueues a ",(0,r.jsx)(n.code,{children:"CommandPriority.PLAYER"})," command targeting ",(0,r.jsx)(n.code,{children:"runtime.getNextExecutableStep()"})," and uses a deterministic timestamp derived from the simulation clock (as documented for automation in ",(0,r.jsx)(n.code,{children:"packages/core/src/automation-system.ts:967"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Game method (Issue 750)"}),(0,r.jsx)(n.th,{children:"Command type"}),(0,r.jsx)(n.th,{children:"Payload type"}),(0,r.jsx)(n.th,{children:"Enqueue stamping"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"purchaseGenerator(generatorId, count)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES.PURCHASE_GENERATOR"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),")"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PurchaseGeneratorPayload"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:133"}),")"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"priority=PLAYER"}),"; ",(0,r.jsx)(n.code,{children:"step=runtime.getNextExecutableStep()"}),"; ",(0,r.jsx)(n.code,{children:"timestamp=currentStep*stepSizeMs"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"purchaseUpgrade(upgradeId)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES.PURCHASE_UPGRADE"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),")"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PurchaseUpgradePayload"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:141"}),")"]}),(0,r.jsx)(n.td,{children:"deterministic stamp as above"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"toggleAutomation(automationId, enabled)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES.TOGGLE_AUTOMATION"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),")"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ToggleAutomationPayload"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:157"}),")"]}),(0,r.jsx)(n.td,{children:"deterministic stamp as above"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"startTransform(transformId)"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES.RUN_TRANSFORM"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),")"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"RunTransformPayload"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:206"}),")"]}),(0,r.jsx)(n.td,{children:"deterministic stamp as above"})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enqueue result semantics"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Action methods return ",(0,r.jsx)(n.code,{children:"CommandResult"})," indicating whether the command was accepted into the queue (not whether it ultimately succeeded during execution)."]}),"\n",(0,r.jsxs)(n.li,{children:["Implementation MUST detect enqueue rejection by comparing ",(0,r.jsx)(n.code,{children:"commandQueue.size"})," before/after (",(0,r.jsx)(n.code,{children:"packages/core/src/command-queue.ts:205"}),"), returning ",(0,r.jsx)(n.code,{children:"{ success: false, error: { code: 'COMMAND_REJECTED', ... } }"})," when size does not increase."]}),"\n",(0,r.jsxs)(n.li,{children:["Execution-time failures remain observable via ",(0,r.jsx)(n.code,{children:"IdleEngineRuntime.drainCommandFailures()"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:264"}),") and runtime events."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Auto-registration of handlers"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"createGame"})," must rely on ",(0,r.jsx)(n.code,{children:"createGameRuntime"}),"/",(0,r.jsx)(n.code,{children:"wireGameRuntime"})," wiring to register handlers based on content presence and enablement (",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:90"})," and ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:130"}),"), removing the need for downstream manual registration."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Documentation updates"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add a concise ",(0,r.jsx)(n.code,{children:"createGame()"})," onboarding snippet to ",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md"})," (",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md:1"}),") and cross-link to the runtime wiring section in the architecture doc (",(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md:190"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deployment"}),": Issue 750 is a DX enhancement in ",(0,r.jsx)(n.code,{children:"packages/core"})," with additive exports; no CI/CD pipeline changes are required beyond ensuring tests/linters pass."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Telemetry & Observability"}),": Issue 750 should not add new telemetry streams; it should reuse existing runtime telemetry and event bus behavior (",(0,r.jsx)(n.code,{children:"packages/core/src/events/event-bus.ts:46"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security & Compliance"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hydrate"})," should assume inputs are untrusted and rely on the existing save-format validation/migration paths implemented in the save pipeline (follow-up: consider exposing ",(0,r.jsx)(n.code,{children:"decodeGameStateSave"})," to the stable surface if needed; TODO owner: Runtime Core maintainers; currently available via internals exports at ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:1522"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"The fa\xe7ade must not introduce host I/O, network calls, or persistence side effects; all persistence remains caller-controlled."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,r.jsx)(n.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,r.jsx)(n.p,{children:"Populate the table as the canonical source for downstream GitHub issues."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Issue Title"}),(0,r.jsx)(n.th,{children:"Scope Summary"}),(0,r.jsx)(n.th,{children:"Proposed Assignee/Agent"}),(0,r.jsx)(n.th,{children:"Dependencies"}),(0,r.jsx)(n.th,{children:"Acceptance Criteria"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"feat(core): add createGame facade (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Add ",(0,r.jsx)(n.code,{children:"packages/core/src/game.ts"})," implementing ",(0,r.jsx)(n.code,{children:"Game"})," + ",(0,r.jsx)(n.code,{children:"createGame"}),"; deterministic action-method enqueueing; ",(0,r.jsx)(n.code,{children:"internals"})," escape hatch."]}),(0,r.jsx)(n.td,{children:"Runtime API Agent"}),(0,r.jsx)(n.td,{children:"Design approved"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"createGame(content)"})," works with defaults; actions enqueue PLAYER commands with deterministic stamping; ",(0,r.jsx)(n.code,{children:"internals"})," exposes ",(0,r.jsx)(n.code,{children:"GameRuntimeWiring"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"test(core): add createGame integration coverage (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Add Vitest suites that validate lifecycle (",(0,r.jsx)(n.code,{children:"tick"}),"), snapshots, action enqueueing, and serialize/hydrate roundtrips."]}),(0,r.jsx)(n.td,{children:"Testing Agent"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"feat(core): add createGame facade (Issue 750)"})}),(0,r.jsx)(n.td,{children:"Tests cover: snapshot shape, command queue acceptance, handler registration, save/load determinism."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"docs: document createGame onboarding path (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Update ",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md"})," and any runtime integration docs to recommend ",(0,r.jsx)(n.code,{children:"createGame"}),"."]}),(0,r.jsx)(n.td,{children:"Docs Agent"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"feat(core): add createGame facade (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Docs include minimal snippet; links to ",(0,r.jsx)(n.code,{children:"@idle-engine/core"})," APIs; no broken references."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"chore(core): update stable public surface contract (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Update ",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts"})," stable export-key list and ensure ",(0,r.jsx)(n.code,{children:"@idle-engine/core/public"})," remains aligned."]}),(0,r.jsx)(n.td,{children:"Integration Agent"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"feat(core): add createGame facade (Issue 750)"})}),(0,r.jsxs)(n.td,{children:["Public export list includes ",(0,r.jsx)(n.code,{children:"createGame"}),"; tests pass; exported key count remains bounded."]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 1"}),": Issue 750 fa\xe7ade implemented + stable-surface contract updated (gate: CI green on ",(0,r.jsx)(n.code,{children:"pnpm lint"})," + ",(0,r.jsx)(n.code,{children:"pnpm test --filter @idle-engine/core"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 2"}),": Issue 750 integration tests + docs updates merged (gate: docs build succeeds; examples render correctly)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 3"})," (optional): Evaluate deprecation messaging for low-level wiring entrypoints in docs and/or entrypoints (gate: maintainer decision; no breaking changes without explicit migration plan)."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hand-off Package"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue scope: ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/750",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/750"})]}),"\n",(0,r.jsxs)(n.li,{children:["Key wiring + contracts: ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"}),", ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"})]}),"\n",(0,r.jsxs)(n.li,{children:["Snapshot helper: ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"})]}),"\n",(0,r.jsxs)(n.li,{children:["Stable surface contract: ",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication Cadence"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"One PR per row in \xa77.1 when feasible; reviewers sign off on the public API surface before follow-up docs/tests land."}),"\n",(0,r.jsx)(n.li,{children:"Escalation path: Runtime Core Maintainers resolve open questions in \xa713 before Phase 3 work starts."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Packets"})," (Issue 750 agents MUST preload):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/design-document-template.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts:19"})," and ",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prompting & Constraints"})," (canonical snippets for Issue 750 execution):"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"You are the Runtime API Agent for Idle Engine. Implement Issue 750 by adding a stable createGame(contentPack, options?) factory in packages/core/src/game.ts.\nConstraints:\n- Preserve determinism: stamp commands with CommandPriority.PLAYER, step=runtime.getNextExecutableStep(), timestamp derived from simulation time.\n- Do not execute commands outside tick boundaries.\n- Keep the stable public surface small: only add createGame and its types to packages/core/src/index.browser.ts.\n- Use type-only imports/exports where applicable and follow existing lint rules.\nValidation:\n- pnpm lint\n- pnpm test --filter @idle-engine/core\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Safety Rails"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Do not edit checked-in ",(0,r.jsx)(n.code,{children:"dist/"})," artifacts by hand (repo guideline)."]}),"\n",(0,r.jsxs)(n.li,{children:["Do not introduce wall-clock nondeterminism into simulation logic; any ",(0,r.jsx)(n.code,{children:"Date.now()"})," use must be limited to snapshot publication metadata and never influence state mutation ordering."]}),"\n",(0,r.jsx)(n.li,{children:"Do not add console output in tests (Vitest LLM reporter expects machine-readable summaries)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation Hooks"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"pnpm lint"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"pnpm test --filter @idle-engine/core"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"pnpm test"})}),"\n",(0,r.jsxs)(n.li,{children:["After adding tests that affect coverage: ",(0,r.jsx)(n.code,{children:"pnpm coverage:md"})," and commit ",(0,r.jsx)(n.code,{children:"docs/coverage/index.md"})," (repo guideline)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Docs-only onboarding"}),": Update ",(0,r.jsx)(n.code,{children:"docs/"})," to explain ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," wiring without adding a fa\xe7ade. Rejected for Issue 750 because it leaves high cognitive load and inconsistent downstream wrappers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Helper-only approach"}),": Add ",(0,r.jsx)(n.code,{children:"createPlayerCommand(...)"})," helpers but no ",(0,r.jsx)(n.code,{children:"Game"})," fa\xe7ade. Rejected for Issue 750 because it still requires consumers to manage lifecycle, snapshot composition, and persistence glue."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["New package (",(0,r.jsx)(n.code,{children:"@idle-engine/game"}),")"]}),": Create a separate package for the fa\xe7ade. Deferred for Issue 750 to avoid workspace/module overhead and to keep onboarding within the primary ",(0,r.jsx)(n.code,{children:"@idle-engine/core"})," entrypoint."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Generated type-safe API from content"}),": Codegen ",(0,r.jsx)(n.code,{children:"purchase<GeneratorId>()"}),"-style methods. Rejected for Issue 750 due to complexity and because content packs are dynamic at runtime."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unit / Integration"})," (Issue 750):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add a new ",(0,r.jsx)(n.code,{children:"packages/core/src/game.test.ts"})," validating:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"createGame(content)"})," returns a ",(0,r.jsx)(n.code,{children:"Game"})," with ",(0,r.jsx)(n.code,{children:"internals"})," populated and handlers registered."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"purchaseGenerator(...)"})," enqueues a PLAYER command targeting ",(0,r.jsx)(n.code,{children:"runtime.getNextExecutableStep()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tick(...)"})," processes commands deterministically and mutates state through handlers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"getSnapshot()"})," returns a ",(0,r.jsx)(n.code,{children:"ProgressionSnapshot"}),"-compatible shape (via ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"serialize()"})," \u2192 ",(0,r.jsx)(n.code,{children:"hydrate()"})," roundtrip restores state and command queue."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure fa\xe7ade overhead is O(1) per call; avoid per-tick allocations beyond existing snapshot building."}),"\n",(0,r.jsx)(n.li,{children:"No new benchmarks required for Issue 750 unless regressions are observed (TODO owner: Runtime Core maintainers)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling / A11y"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Not applicable for Issue 750 (no UI surface), except ensuring docs render correctly in Docusaurus."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Risk (Issue 750)"}),(0,r.jsx)(n.th,{children:"Impact"}),(0,r.jsx)(n.th,{children:"Mitigation"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"createGame"})," grows into a \u201cgod object\u201d"]}),(0,r.jsx)(n.td,{children:"Stable surface bloats; harder to evolve"}),(0,r.jsxs)(n.td,{children:["Keep fa\xe7ade narrow; route advanced needs to ",(0,r.jsx)(n.code,{children:"internals"}),"; defer additional action methods to \xa714."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Nondeterministic command ordering from timestamps"}),(0,r.jsx)(n.td,{children:"Replay/debugging drift"}),(0,r.jsxs)(n.td,{children:["Derive timestamps from simulation time (pattern in ",(0,r.jsx)(n.code,{children:"packages/core/src/automation-system.ts:1040"}),") and use ",(0,r.jsx)(n.code,{children:"runtime.getNextExecutableStep()"})," for step stamping (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"}),")."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Confusion between ",(0,r.jsx)(n.code,{children:"createGame"})," and ",(0,r.jsx)(n.code,{children:"createGameRuntime"})]}),(0,r.jsx)(n.td,{children:"Misuse of internals; inconsistent docs"}),(0,r.jsxs)(n.td,{children:["Update docs to recommend ",(0,r.jsx)(n.code,{children:"createGame"})," as primary onboarding; explicitly label ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," as advanced wiring."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Scheduler semantics surprise (",(0,r.jsx)(n.code,{children:"start"}),"/",(0,r.jsx)(n.code,{children:"stop"}),")"]}),(0,r.jsx)(n.td,{children:"Games tick too fast/slow, inconsistent across hosts"}),(0,r.jsxs)(n.td,{children:["Make scheduler opt-in; default to fixed-step interval derived from ",(0,r.jsx)(n.code,{children:"stepSizeMs"}),"; document that manual ",(0,r.jsx)(n.code,{children:"tick"})," is authoritative."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Save/hydrate misuse with untrusted data"}),(0,r.jsx)(n.td,{children:"Corrupt state or runtime errors"}),(0,r.jsxs)(n.td,{children:["Document that ",(0,r.jsx)(n.code,{children:"hydrate"})," expects validated data; consider stable-surface decode helper as follow-up (see \xa76.3)."]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Milestones"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Land Issue 750 fa\xe7ade + stable-surface contract updates in one release increment (TODO owner: Runtime Core maintainers)."}),"\n",(0,r.jsx)(n.li,{children:"Update docs in the same release train so onboarding guidance matches shipped API."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Migration Strategy"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["No migration required for existing integrations; ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," remains available."]}),"\n",(0,r.jsxs)(n.li,{children:["New integrations should start from ",(0,r.jsx)(n.code,{children:"createGame"})," and only access ",(0,r.jsx)(n.code,{children:"internals"})," when necessary."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add release notes and a short \u201cGetting started\u201d snippet to docs referencing ",(0,r.jsx)(n.code,{children:"createGame"})," (TODO owner: Docs maintainers)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750: Should ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," and ",(0,r.jsx)(n.code,{children:"wireGameRuntime"})," remain in the stable public entrypoint long-term, or be documented as advanced-only (potentially moved to ",(0,r.jsx)(n.code,{children:"@idle-engine/core/internals"}),")? TODO (Owner: Runtime Core maintainers)."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750: What is the canonical scheduler behavior for ",(0,r.jsx)(n.code,{children:"start()"})," (fixed-step ",(0,r.jsx)(n.code,{children:"setInterval"})," vs ",(0,r.jsx)(n.code,{children:"requestAnimationFrame"})," + accumulator)? TODO (Owner: Runtime Core maintainers)."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750: Should action methods accept/emit ",(0,r.jsx)(n.code,{children:"requestId"})," for correlating execution outcomes (",(0,r.jsx)(n.code,{children:"IdleEngineRuntime.drainCommandOutcomes"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:272"}),")? TODO (Owner: Runtime Core maintainers)."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750: Should the stable surface expose an explicit decode/encode helper for saves (currently available via internals exports at ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:1522"}),")? TODO (Owner: Runtime Core maintainers)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750 follow-up: add additional fa\xe7ade actions for common commands (",(0,r.jsx)(n.code,{children:"toggleGenerator"}),", ",(0,r.jsx)(n.code,{children:"collectResource"}),", ",(0,r.jsx)(n.code,{children:"prestigeReset"}),", mission decisions, entity management) mapping to ",(0,r.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"}),"). TODO (Owner: Runtime API Agent; Timing: post-Phase 2)."]}),"\n",(0,r.jsxs)(n.li,{children:["Issue 750 follow-up: provide a minimal \u201cworker bridge\u201d example that uses ",(0,r.jsx)(n.code,{children:"createGame"})," + message passing (Owner: Integration Agent; Timing: after Issue 545/547 alignment)."]}),"\n",(0,r.jsx)(n.li,{children:"Issue 750 follow-up: evaluate deprecation messaging and docs cleanup for low-level wiring entrypoints (Owner: Docs Agent; Timing: Phase 3)."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"15-references",children:"15. References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Issue 750: ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/750",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/750"})]}),"\n",(0,r.jsxs)(n.li,{children:["Stable public entrypoint exports: ",(0,r.jsx)(n.code,{children:"packages/core/src/index.browser.ts:19"})]}),"\n",(0,r.jsxs)(n.li,{children:["Stable-surface contract test: ",(0,r.jsx)(n.code,{children:"packages/core/src/index.test.ts:164"})]}),"\n",(0,r.jsxs)(n.li,{children:["Runtime wiring factory: ",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts:917"})]}),"\n",(0,r.jsxs)(n.li,{children:["Wiring contract type: ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"})]}),"\n",(0,r.jsxs)(n.li,{children:["Handler auto-registration: ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:130"})]}),"\n",(0,r.jsxs)(n.li,{children:["UI snapshot builder: ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"})]}),"\n",(0,r.jsxs)(n.li,{children:["Snapshot type: ",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:279"})]}),"\n",(0,r.jsxs)(n.li,{children:["Command types + priorities: ",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:77"})]}),"\n",(0,r.jsxs)(n.li,{children:["Command types + payloads: ",(0,r.jsx)(n.code,{children:"packages/core/src/command.ts:107"})]}),"\n",(0,r.jsxs)(n.li,{children:["Deterministic timestamp pattern: ",(0,r.jsx)(n.code,{children:"packages/core/src/automation-system.ts:967"})]}),"\n",(0,r.jsxs)(n.li,{children:["Command queue stamping guidance: ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:615"})]}),"\n",(0,r.jsxs)(n.li,{children:["Layered architecture context: ",(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md:190"})]}),"\n",(0,r.jsxs)(n.li,{children:["Onboarding doc to update: ",(0,r.jsx)(n.code,{children:"docs/content-quick-reference.md:1"})]}),"\n",(0,r.jsxs)(n.li,{children:["Existing wiring tests: ",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.test.ts:101"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Issue 750"}),": GitHub issue requesting a high-level ",(0,r.jsx)(n.code,{children:"createGame()"})," factory for simplified onboarding."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Game"}),": The Issue 750 fa\xe7ade interface providing lifecycle, snapshots, actions, persistence, and event subscriptions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"GameRuntimeWiring"}),": A structured set of runtime internals returned by ",(0,r.jsx)(n.code,{children:"createGameRuntime"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/game-runtime-wiring.ts:44"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ProgressionSnapshot"}),": UI-ready snapshot derived from authoritative state via ",(0,r.jsx)(n.code,{children:"buildProgressionSnapshot"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/progression.ts:421"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deterministic stamping"}),": Setting ",(0,r.jsx)(n.code,{children:"priority"}),", ",(0,r.jsx)(n.code,{children:"step"}),", and ",(0,r.jsx)(n.code,{children:"timestamp"})," in a way that preserves deterministic ordering in the command queue (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:589"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Date"}),(0,r.jsx)(n.th,{children:"Author"}),(0,r.jsx)(n.th,{children:"Change Summary"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2026-01-15"}),(0,r.jsx)(n.td,{children:"Codex (AI)"}),(0,r.jsx)(n.td,{children:"Initial draft for Issue 750."})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},7678:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(9430);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);