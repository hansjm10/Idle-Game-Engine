"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[567],{7678:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(9430);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}},9819:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"sample-pack-balance-validation-design-issue-420","title":"Expand Sample Pack and Balance Validation (issue-420)","description":"Document Control","source":"@site/../../docs/sample-pack-balance-validation-design-issue-420.md","sourceDirName":".","slug":"/sample-pack-balance-validation-design-issue-420","permalink":"/Idle-Game-Engine/sample-pack-balance-validation-design-issue-420","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/sample-pack-balance-validation-design-issue-420.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Expand Sample Pack and Balance Validation (issue-420)","sidebar_position":4}}');var r=s(5270),t=s(7678);const c={title:"Expand Sample Pack and Balance Validation (issue-420)",sidebar_position:4},l=void 0,a={},d=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"document-control",children:"Document Control"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Title: Expand sample pack coverage and balance validation (issue-420, scope from issue-419)"}),"\n",(0,r.jsx)(n.li,{children:"Authors: Idle Engine Design-Authoring Agent"}),"\n",(0,r.jsx)(n.li,{children:"Reviewers: Content Pipeline Maintainers; Runtime Core Maintainers; Shell UX Maintainers"}),"\n",(0,r.jsx)(n.li,{children:"Status: Draft"}),"\n",(0,r.jsx)(n.li,{children:"Last Updated: 2025-11-22"}),"\n",(0,r.jsxs)(n.li,{children:["Related Issues: ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/419",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/419"}),", ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/420",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/420"})]}),"\n",(0,r.jsx)(n.li,{children:"Execution Mode: AI-led"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,r.jsxs)(n.p,{children:["around github issue 419 expands the sample pack with new resources, generators, multi-tier upgrades, and a prestige layer while adding fast-check-based balance validation to the content schema and compiler pipeline. Balance failures will block ",(0,r.jsx)(n.code,{children:"pnpm generate (--check)"})," and CI, and updated core/shell fixtures will consume the richer content without regressions."]}),"\n",(0,r.jsx)(n.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Background"}),": Sample content is minimal (energy/crystal, few upgrades) in ",(0,r.jsx)(n.code,{children:"packages/content-sample/content/pack.json"}),"; docs outline usage (",(0,r.jsx)(n.code,{children:"packages/content-sample/README.md"}),") but no prestige coverage. Schema checks are structural (",(0,r.jsx)(n.code,{children:"packages/content-schema/src/modules/generators.ts"}),") with property tests only for formulas (",(0,r.jsx)(n.code,{children:"packages/content-schema/src/base/formulas.property.test.ts"}),"). Compiler artifacts are deterministic (",(0,r.jsx)(n.code,{children:"packages/content-compiler/src/__tests__/compiler.test.ts"}),") yet balance is unchecked, and ",(0,r.jsx)(n.code,{children:"pnpm generate"})," via ",(0,r.jsx)(n.code,{children:"tools/content-schema-cli/src/compile.js"})," omits balance validation (",(0,r.jsx)(n.code,{children:"docs/content-validation-cli-design.md"}),"). Shell progression relies on pack IDs/costs (",(0,r.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Issue 419 calls out insufficient content coverage and missing balance/property validation, risking negative rates or unstable costs and leaving prestige untested."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Forces"}),": Maintain deterministic artifacts/hashes and structured logs (",(0,r.jsx)(n.code,{children:"vitest-llm-reporter"})," final JSON); honor DSL rules (",(0,r.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines.md"}),") and implementation plan expectations for richer packs (",(0,r.jsx)(n.code,{children:"docs/implementation-plan.md"}),"); avoid manual ",(0,r.jsx)(n.code,{children:"dist/"})," edits."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Goals"}),":","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Expand the sample pack with additional resources/generators, multi-tier upgrades, and a prestige layer per issue 419."}),"\n",(0,r.jsxs)(n.li,{children:["Add fast-check-backed balance validation to ",(0,r.jsx)(n.code,{children:"@idle-engine/content-schema"}),", surfaced through compiler/CLI and CI."]}),"\n",(0,r.jsx)(n.li,{children:"Extend compiler tests for balance gating and deterministic hashes."}),"\n",(0,r.jsx)(n.li,{children:"Align core and downstream consumer tests with new content IDs/tiers and prestige flows."}),"\n",(0,r.jsx)(n.li,{children:"Update docs (content DSL usage, sample README) to describe new content and validation rules."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Non-Goals"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Changing runtime economic algorithms or command contracts beyond content wiring."}),"\n",(0,r.jsx)(n.li,{children:"Shipping full prestige UX in archived presentation shells (only fixtures/tests)."}),"\n",(0,r.jsx)(n.li,{children:"Adding guild perks/social features (defer)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Primary Stakeholders"}),": Content pipeline maintainers; Runtime core maintainers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent Roles"}),": Content Authoring Agent (pack expansion); Balance Validation Agent (fast-check invariants); Compiler Integration Agent (CLI wiring); Consumer Integration Agent (progression updates); Docs Agent (guides/readme)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Affected Packages/Services"}),": ",(0,r.jsx)(n.code,{children:"packages/content-schema"}),", ",(0,r.jsx)(n.code,{children:"packages/content-compiler"}),", ",(0,r.jsx)(n.code,{children:"packages/content-sample"}),", ",(0,r.jsx)(n.code,{children:"packages/core"}),", ",(0,r.jsx)(n.code,{children:"tools/content-schema-cli"}),", ",(0,r.jsx)(n.code,{children:"docs/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compatibility Considerations"}),": Preserve deterministic ordering/hashes; keep ",(0,r.jsx)(n.code,{children:"content/compiled/index.json"})," shape; avoid schema breaks; maintain shell cost/visibility expectations (",(0,r.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Sample pack limited to two resources/two generators, minimal upgrades, no prestige (",(0,r.jsx)(n.code,{children:"packages/content-sample/content/pack.json"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Schema validation enforces structure/uniqueness; no balance/monotonicity (",(0,r.jsx)(n.code,{children:"packages/content-schema/src/modules/generators.ts"}),", ",(0,r.jsx)(n.code,{children:"packages/content-schema/src/modules/prestige.ts"}),"); property suites only for formulas (",(0,r.jsx)(n.code,{children:"packages/content-schema/src/base/formulas.property.test.ts"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Compiler and CLI ignore balance results (",(0,r.jsx)(n.code,{children:"packages/content-compiler/src/compiler/index.ts"}),", ",(0,r.jsx)(n.code,{children:"packages/content-compiler/src/__tests__/compiler.test.ts"}),", ",(0,r.jsx)(n.code,{children:"tools/content-schema-cli/src/compile.js"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Progression coordinator uses pack data for costs/unlocks (",(0,r.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"}),"); new IDs would currently break fixtures."]}),"\n",(0,r.jsxs)(n.li,{children:["Implementation plan demands richer packs and prestige coverage (",(0,r.jsx)(n.code,{children:"docs/implementation-plan.md"}),"); progression guidance exists (",(0,r.jsx)(n.code,{children:"docs/progression-coordinator-design.md"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,r.jsx)(n.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Narrative"}),": Author richer pack content (mid/late resources, generators, multi-tier upgrades, prestige), add fast-check balance invariants in ",(0,r.jsx)(n.code,{children:"@idle-engine/content-schema"}),", wire balance gating into compiler/CLI, and refresh core/consumer fixtures so deterministic artifacts remain stable."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Diagram"}),":","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"pack.json/json5 \u2192 schema + balance validator (fast-check) \u2192 compiler (deterministic artifacts) \u2192 sample pack exports\n      \u2191                    |                               \u2193\n docs/guides           CLI/CI logs                 core + shell tests\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Runtime Changes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["No new runtime systems; update ",(0,r.jsx)(n.code,{children:"packages/core"})," fixtures and shell progression expectations for new IDs and prestige currency."]}),"\n",(0,r.jsx)(n.li,{children:"Ensure progression coordinator handles added tiers/resources without command contract changes."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data & Schemas"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resources"}),": Keep ",(0,r.jsx)(n.code,{children:"energy"}),", ",(0,r.jsx)(n.code,{children:"crystal"}),"; add ",(0,r.jsx)(n.code,{children:"sample-pack.alloy"})," (tier 2 soft crafting, unlock after crystal threshold), ",(0,r.jsx)(n.code,{children:"sample-pack.data-core"})," (tier 2 research, produced from alloy), ",(0,r.jsx)(n.code,{children:"sample-pack.prestige-flux"})," (prestige currency, hidden until unlock)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Generators"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sample-pack.forge"}),": consumes energy+crystal \u2192 alloy; linear cost (base 75 energy, slope 12)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sample-pack.lab"}),": consumes energy+alloy \u2192 data-core; exponential cost (base 120 energy, growth 1.12)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sample-pack.gate-reactor"}),": consumes data-core \u2192 prestige-flux post-prestige unlock; exponential cost (base 500 data-core, growth 1.08)."]}),"\n",(0,r.jsxs)(n.li,{children:["Keep ",(0,r.jsx)(n.code,{children:"reactor"}),"/",(0,r.jsx)(n.code,{children:"harvester"}),"; specify sensible ",(0,r.jsx)(n.code,{children:"maxLevel"}),"/",(0,r.jsx)(n.code,{children:"maxBulk"})," to exercise validation."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Upgrades (multi-tier)"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Reactor: existing tiers plus ",(0,r.jsx)(n.code,{children:"reactor-phase-cooling"})," (tier 3, \xd71.75, unlock at owned \u22655)."]}),"\n",(0,r.jsxs)(n.li,{children:["Harvester: add ",(0,r.jsx)(n.code,{children:"harvester-deep-core"})," (tier 2, \xd71.5, unlock at crystal \u2265150) and ",(0,r.jsx)(n.code,{children:"harvester-quantum-sieve"})," (tier 3 repeatable up to 5, +15% each)."]}),"\n",(0,r.jsxs)(n.li,{children:["Forge: ",(0,r.jsx)(n.code,{children:"forge-heat-shield"})," (reduces alloy cost growth), ",(0,r.jsx)(n.code,{children:"forge-auto-feed"})," (automation-ready)."]}),"\n",(0,r.jsxs)(n.li,{children:["Lab: ",(0,r.jsx)(n.code,{children:"lab-insight-boost"})," (\xd71.4), ",(0,r.jsx)(n.code,{children:"lab-simulation-stack"})," (repeatable, prestige-flux gated)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prestige Layer"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.code,{children:"sample-pack.ascension-alpha"})," rewarding ",(0,r.jsx)(n.code,{children:"prestige-flux"}),"; unlock when ",(0,r.jsx)(n.code,{children:"data-core"})," \u2265 500 and ",(0,r.jsx)(n.code,{children:"reactor"})," level \u2265 10."]}),"\n",(0,r.jsxs)(n.li,{children:["Reward formula: ",(0,r.jsx)(n.code,{children:"floor((totalEnergySpent + totalCrystalSpent + 2 * totalDataProduced) / 750)"})," capped at 5,000; minimum 1 per reset."]}),"\n",(0,r.jsxs)(n.li,{children:["Effects: global production multiplier ",(0,r.jsx)(n.code,{children:"1 + prestige-flux * 0.01"}),"; resets resources/generators/upgrades; no carry-over except prestige currency."]}),"\n",(0,r.jsx)(n.li,{children:"Document automation gating and unlock text for UI."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Balance Checks (schema)"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["New ",(0,r.jsx)(n.code,{children:"balanceChecks"})," module with fast-check invariants: finite/non-negative rates; non-decreasing generator/upgrade costs across purchase indices 0\u2013100 with ",(0,r.jsx)(n.code,{children:"maxGrowth"})," cap (default 20x); prestige rewards non-negative/monotone and capped; unlock ordering ensures consumed resources unlock no later than dependent generators."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ContentSchemaOptions"})," gains ",(0,r.jsx)(n.code,{children:"balance"})," config (sample size, growth cap, warn-vs-error)."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"APIs & Contracts"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"createContentPackValidator"})," emits ",(0,r.jsx)(n.code,{children:"balanceWarnings"}),"/",(0,r.jsx)(n.code,{children:"balanceErrors"}),"; add structured log events ",(0,r.jsx)(n.code,{children:"content_pack.balance_failed"}),"/",(0,r.jsx)(n.code,{children:"content_pack.balance_warning"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Keep pack export shape; prestige appears in generated modules/indices (",(0,r.jsx)(n.code,{children:"packages/content-sample/src/generated/*.generated.ts"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling & Automation"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Update ",(0,r.jsx)(n.code,{children:"tools/content-schema-cli/src/compile.js"})," to run balance before compilation; fail fast on errors; include balance status in ",(0,r.jsx)(n.code,{children:"content/compiled/index.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Extend compiler tests to assert balance gating and deterministic hashes."}),"\n",(0,r.jsxs)(n.li,{children:["Seed fast-check deterministically with capped ",(0,r.jsx)(n.code,{children:"numRuns"}),"; document seeds to protect ",(0,r.jsx)(n.code,{children:"vitest-llm-reporter"})," output."]}),"\n",(0,r.jsxs)(n.li,{children:["Add sample pack tests for prestige/reset behaviors; regenerate artifacts via ",(0,r.jsx)(n.code,{children:"pnpm generate"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deployment"}),": No runtime deploy change; CI must run ",(0,r.jsx)(n.code,{children:"pnpm generate --check"})," plus targeted tests on content changes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Telemetry & Observability"}),": Logs remain single-line JSON; record balance check duration for perf tracking."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security & Compliance"}),": Static JSON/TS only; bound fast-check to avoid resource exhaustion."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,r.jsx)(n.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,r.jsx)(n.p,{children:"Populate the table as the canonical source for downstream GitHub issues."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Issue Title"}),(0,r.jsx)(n.th,{children:"Scope Summary"}),(0,r.jsx)(n.th,{children:"Proposed Assignee/Agent"}),(0,r.jsx)(n.th,{children:"Dependencies"}),(0,r.jsx)(n.th,{children:"Acceptance Criteria"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"feat(content-schema): add balance property checks (issue 419)"}),(0,r.jsx)(n.td,{children:"Implement fast-check invariants, options, and warnings/errors"}),(0,r.jsx)(n.td,{children:"Balance Validation Agent"}),(0,r.jsx)(n.td,{children:"None"}),(0,r.jsxs)(n.td,{children:["Balance failures surface structured errors; ",(0,r.jsx)(n.code,{children:"pnpm test --filter content-schema"})," green; seeds documented"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"feat(content-compiler): enforce balance in CLI/summary (issue 419)"}),(0,r.jsx)(n.td,{children:"Wire balance results into compiler and logs; halt on errors"}),(0,r.jsx)(n.td,{children:"Compiler Integration Agent"}),(0,r.jsx)(n.td,{children:"Balance checks"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"pnpm generate --check"})," fails on balance errors; summary includes balance status; compiler tests updated"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"feat(content-sample): expand pack with upgrades and prestige (issue 419)"}),(0,r.jsx)(n.td,{children:"Author new resources/generators/upgrades/prestige; regenerate artifacts"}),(0,r.jsx)(n.td,{children:"Content Authoring Agent"}),(0,r.jsx)(n.td,{children:"Balance checks merged"}),(0,r.jsx)(n.td,{children:"Pack compiles warning-free; prestige rewards per design; digests refreshed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"chore(core): align progression fixtures to new content"}),(0,r.jsx)(n.td,{children:"Update core tests for new IDs/tiers/prestige"}),(0,r.jsx)(n.td,{children:"Consumer Integration Agent"}),(0,r.jsx)(n.td,{children:"Expanded pack"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"pnpm test --filter core"})," passes; no runtime errors"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"docs: update content DSL usage/sample pack README"}),(0,r.jsx)(n.td,{children:"Document new content, prestige flows, validation"}),(0,r.jsx)(n.td,{children:"Docs Agent"}),(0,r.jsx)(n.td,{children:"Expanded pack"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines.md"})," and ",(0,r.jsx)(n.code,{children:"packages/content-sample/README.md"})," updated with links"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 1 (Week 0-1)"}),": Balance validation + CLI/compiler wiring with tests."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 2 (Week 1-2)"}),": Pack expansion (resources/generators/upgrades/prestige) and artifact regeneration."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 3 (Week 2-3)"}),": Consumer fixture updates, docs refresh, CI stabilization."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hand-off Package"}),": Provide pack drafts, expected digests, and fast-check seeds when transferring work."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication Cadence"}),": Daily async updates in issue 419; reviewer checkpoints at each phase; escalate schema questions to content pipeline maintainers."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Packets"}),": ",(0,r.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines.md"}),", ",(0,r.jsx)(n.code,{children:"docs/content-compiler-design.md"}),", ",(0,r.jsx)(n.code,{children:"docs/content-validation-cli-design.md"}),", ",(0,r.jsx)(n.code,{children:"docs/progression-coordinator-design.md"}),", ",(0,r.jsx)(n.code,{children:"packages/content-sample/content/pack.json"}),", ",(0,r.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prompting & Constraints"}),": Use ES modules, two-space indentation, type-only imports/exports; keep generated output deterministic; never edit ",(0,r.jsx)(n.code,{children:"dist/"})," manually."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Safety Rails"}),": Avoid destructive git commands; keep console output JSON-only; cap fast-check runs; avoid non-ASCII text."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation Hooks"}),": ",(0,r.jsx)(n.code,{children:"pnpm generate --check"}),", ",(0,r.jsx)(n.code,{children:"pnpm test --filter content-schema"}),", ",(0,r.jsx)(n.code,{children:"pnpm test --filter content-compiler"}),", ",(0,r.jsx)(n.code,{children:"pnpm test --filter content-sample"}),", ",(0,r.jsx)(n.code,{children:"pnpm test --filter core"}),", ",(0,r.jsx)(n.code,{children:"pnpm coverage:md"})," when coverage changes."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Manual heuristic balance checks: rejected for low coverage and maintenance cost."}),"\n",(0,r.jsx)(n.li,{children:"Runtime simulation-based balance validation: deferred; heavier and less deterministic for CI."}),"\n",(0,r.jsx)(n.li,{children:"Separate prestige-only pack: rejected; single sample pack should exercise resets and base progression together."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unit / Integration"}),": Balance property suites in ",(0,r.jsx)(n.code,{children:"packages/content-schema"}),"; compiler pipeline tests for gating; sample pack prestige/reset fixtures; core progression tests for new IDs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),": Track balance check runtime; target under 5s per suite with bounded fast-check."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling / A11y"}),": Preserve ",(0,r.jsx)(n.code,{children:"vitest-llm-reporter"})," JSON; run ",(0,r.jsx)(n.code,{children:"pnpm coverage:md"})," after test changes."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fast-check flakiness \u2192 Fix seeds and bound ",(0,r.jsx)(n.code,{children:"numRuns"}),"; document defaults."]}),"\n",(0,r.jsx)(n.li,{children:"Cost/rate regressions break shell progression \u2192 Run progression coordinator checks and property suites per change."}),"\n",(0,r.jsxs)(n.li,{children:["Artifact drift \u2192 Enforce ",(0,r.jsx)(n.code,{children:"pnpm generate --check"})," in CI; commit regenerated outputs."]}),"\n",(0,r.jsx)(n.li,{children:"Prestige reward errors \u2192 Add unit tests for reward caps and monotonicity; include in balance checks."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Milestones"}),": Follow \xa77.2 with reviewer approval after balance wiring and after content expansion."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Migration Strategy"}),": Bump sample pack version (e.g., 0.3.x) when prestige lands; regenerate ",(0,r.jsx)(n.code,{children:"content/compiled/"})," and ",(0,r.jsx)(n.code,{children:"src/generated/"}),"; update fixtures."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication"}),": Post commands and digest updates in issue 419; highlight prestige addition in content DSL guide and release notes."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Final numeric tuning for new generators/upgrades/prestige curve (Owner: Content Authoring Agent)."}),"\n",(0,r.jsx)(n.li,{children:"Should prestige-flux bonuses stack multiplicatively or additively with upgrades? (Owner: Runtime Core Maintainers)."}),"\n",(0,r.jsx)(n.li,{children:"Should balance warnings be fatal in CI but soft locally? (Owner: Balance Validation Agent)."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add guild perk stub per implementation plan (Owner: Content Authoring Agent)."}),"\n",(0,r.jsx)(n.li,{children:"Extend balance checks to localization completeness and automation cooldown sanity (Owner: Balance Validation Agent)."}),"\n",(0,r.jsxs)(n.li,{children:["Publish JSON schema for ",(0,r.jsx)(n.code,{children:"content/compiled/index.json"})," for external tooling (Owner: Compiler Integration Agent)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"15-references",children:"15. References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-sample/content/pack.json"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-sample/README.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-schema/src/modules/generators.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-schema/src/modules/prestige.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-schema/src/base/formulas.property.test.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/content-compiler/src/__tests__/compiler.test.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"tools/content-schema-cli/src/compile.js"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/content-dsl-usage-guidelines.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/content-compiler-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/content-validation-cli-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/progression-coordinator-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/implementation-plan.md"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Balance validation"}),": Fast-check-backed invariants ensuring costs, rates, and rewards are finite, non-negative, and monotone where applicable."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prestige layer"}),": Reset mechanic granting ",(0,r.jsx)(n.code,{children:"sample-pack.prestige-flux"})," and global multipliers while resetting base progression."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deterministic artifact"}),": Compiler output with stable ordering/hashes when inputs do not change."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Content pack"}),": Authored JSON/JSON5 definitions compiled into normalized runtime content."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Date"}),(0,r.jsx)(n.th,{children:"Author"}),(0,r.jsx)(n.th,{children:"Change Summary"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2025-11-22"}),(0,r.jsx)(n.td,{children:"Idle Engine Design-Authoring Agent"}),(0,r.jsx)(n.td,{children:"Initial draft for issues 419/420"})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);