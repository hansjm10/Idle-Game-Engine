"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[6167],{2476:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"desktop-shell-webgpu-renderer-replay-design-issue-778","title":"Desktop Shell + WebGPU Renderer + Replay (Issue 778)","description":"Document Control","source":"@site/../../docs/desktop-shell-webgpu-renderer-replay-design-issue-778.md","sourceDirName":".","slug":"/desktop-shell-webgpu-renderer-replay-design-issue-778","permalink":"/Idle-Game-Engine/desktop-shell-webgpu-renderer-replay-design-issue-778","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/desktop-shell-webgpu-renderer-replay-design-issue-778.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Desktop Shell + WebGPU Renderer + Replay (Issue 778)","sidebar_position":6},"sidebar":"developerSidebar","previous":{"title":"Controls Contract Design (Issue 705)","permalink":"/Idle-Game-Engine/controls-contract-design-issue-705"},"next":{"title":"Shell Desktop MCP Guide","permalink":"/Idle-Game-Engine/shell-desktop-mcp"}}');var r=s(5270),l=s(7678);const d={title:"Desktop Shell + WebGPU Renderer + Replay (Issue 778)",sidebar_position:6},t="Desktop Shell (Electron) + WebGPU Renderer (GPU UI) + Deterministic Replay (Issue 778)",a={},c=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"6.2.1 Package Layout",id:"621-package-layout",level:4},{value:"6.2.2 Core \u2194 Shell \u2194 Renderer Boundaries",id:"622-core--shell--renderer-boundaries",level:4},{value:"6.2.3 Frame Description: Two-Layer Model",id:"623-frame-description-two-layer-model",level:4},{value:"6.2.4 Coordinate Systems &amp; Timing",id:"624-coordinate-systems--timing",level:4},{value:"6.2.5 Renderer Contract (High-Level Shape)",id:"625-renderer-contract-high-level-shape",level:4},{value:"6.2.6 WebGPU Renderer (Capabilities Roadmap)",id:"626-webgpu-renderer-capabilities-roadmap",level:4},{value:"6.2.7 Deterministic Record/Replay (Sim + Visual)",id:"627-deterministic-recordreplay-sim--visual",level:4},{value:"6.2.8 Asset Determinism &amp; Atlas Packing",id:"628-asset-determinism--atlas-packing",level:4},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"desktop-shell-electron--webgpu-renderer-gpu-ui--deterministic-replay-issue-778",children:"Desktop Shell (Electron) + WebGPU Renderer (GPU UI) + Deterministic Replay (Issue 778)"})}),"\n",(0,r.jsx)(n.h2,{id:"document-control",children:"Document Control"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Title"}),": Introduce a first-party Electron desktop shell, WebGPU renderer, and deterministic visual replay"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authors"}),": Codex (AI)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reviewers"}),": @hansjm10 (Runtime Core), TODO (Rendering), TODO (Tools/Release)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status"}),": Draft"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Last Updated"}),": 2026-01-16"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Related Issues"}),": ",(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/778",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/778"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execution Mode"}),": AI-led"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,r.jsxs)(n.p,{children:["This proposal adds a first-party desktop host (\u201cshell\u201d) and a first-party 2D renderer to the Idle Engine monorepo while preserving the existing deterministic, platform-agnostic simulation core (",(0,r.jsx)(n.code,{children:"packages/core"}),"). The shell is Electron-based and is responsible for time, input, persistence, and asset IO. Rendering is performed via a custom WebGPU backend (plus an optional debug backend) that consumes data-only frame descriptions. A deterministic record/replay system ties everything together by enabling authoritative sim replays (commands + initial state + RNG) and optional \u201cvisual replays\u201d (ViewModel and/or RenderCommandBuffer per frame) to support debugging, regression testing, and inspection tooling."]}),"\n",(0,r.jsx)(n.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Background"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The repository currently prioritizes a deterministic, headless runtime (",(0,r.jsx)(n.code,{children:"packages/core"}),") that can be hosted by downstream applications; there is no first-party GPU presentation layer (",(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The core already includes deterministic primitives relevant to replay and host integration:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fixed-step runtime loop (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Deterministic command queue semantics (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["A command recorder/replayer utility (",(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Efficient publish transports for typed-array state export (",(0,r.jsx)(n.code,{children:"packages/core/src/resource-publish-transport.ts"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["A controls contract intended for shell integrations (",(0,r.jsx)(n.code,{children:"packages/controls/src/index.ts"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"There is no canonical desktop host that demonstrates end-to-end \u201cengine + shell + renderer\u201d integration, so each downstream app must rebuild time scheduling, persistence, input mapping, and debugging tools independently."}),"\n",(0,r.jsx)(n.li,{children:"There is no renderer contract or renderer implementation that can support sprite-heavy 2D scenes and GPU-rendered UI/HUD without DOM/CSS."}),"\n",(0,r.jsx)(n.li,{children:"Visual debugging is currently limited: while the sim is deterministic and replayable, there is no standardized mechanism to record the derived presentation layer (ViewModel / draw list) and replay it for diagnosing visual regressions."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Forces"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Desktop target (Windows/macOS/Linux) with stable GPU behavior and predictable packaging."}),"\n",(0,r.jsx)(n.li,{children:"Maintain determinism: authoritative sim output must be reproducible; visual layers must be deterministically derived from sim state (or fully captured)."}),"\n",(0,r.jsx)(n.li,{children:"Correctness/control/maintainability over rapid shipping: prefer explicit contracts, stable types, and testable pure transforms."}),"\n",(0,r.jsx)(n.li,{children:"Avoid DOM/CSS dependency for UI; all in-game UI/HUD is GPU-rendered."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Goals"}),":","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Add a first-party desktop shell package that can load a content pack, run the sim deterministically, and present a GPU-rendered game + HUD."}),"\n",(0,r.jsx)(n.li,{children:"Define a stable \u201ccore \u2194 shell \u2194 renderer\u201d contract based on data-only frame descriptions (ViewModel and/or RenderCommandBuffer)."}),"\n",(0,r.jsxs)(n.li,{children:["Implement a WebGPU 2D renderer capable of:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"sprite rendering (batched quads + atlases),"}),"\n",(0,r.jsx)(n.li,{children:"basic 2D scene features (camera, layers, culling),"}),"\n",(0,r.jsx)(n.li,{children:"GPU UI primitives (rects, images, clipping),"}),"\n",(0,r.jsx)(n.li,{children:"text rendering (bitmap or MSDF pipeline)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Add deterministic record/replay that can reproduce:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"authoritative sim evolution (initial state + command stream + RNG),"}),"\n",(0,r.jsx)(n.li,{children:"optional per-frame ViewModel and/or RenderCommandBuffer (for visual debugging)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Provide a debug renderer option (Canvas2D or minimal WebGPU) to validate contracts and diagnostics early."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Non-Goals"})," (initially):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"3D rendering."}),"\n",(0,r.jsx)(n.li,{children:"DOM/CSS-based UI."}),"\n",(0,r.jsx)(n.li,{children:"Multiplayer/network synchronization (the design should not block it; it is not delivered here)."}),"\n",(0,r.jsxs)(n.li,{children:["Pixel-perfect identical output across different GPUs/driver stacks (goal is deterministic ",(0,r.jsx)(n.em,{children:"inputs and command buffers"}),", not necessarily identical rasterization)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Acceptance Criteria (initial implementation phase)"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Desktop shell runs the sim with fixed-step updates and renders frames via a renderer interface."}),"\n",(0,r.jsx)(n.li,{children:"Renderer draws sprites + a minimal GPU UI (text + panels) without DOM/CSS."}),"\n",(0,r.jsx)(n.li,{children:"Replay reproduces sim state and produces identical RenderCommandBuffer hashes for a given replay on the same build/content."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Primary Stakeholders"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Runtime Core maintainers (determinism, contracts, replay invariants)."}),"\n",(0,r.jsx)(n.li,{children:"Shell/UX maintainers (desktop app behavior, input, persistence)."}),"\n",(0,r.jsx)(n.li,{children:"Rendering maintainers (WebGPU backend, debug backend, performance)."}),"\n",(0,r.jsx)(n.li,{children:"Tooling maintainers (replay files, inspectors, CI harnesses)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent Roles"}),":"]}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Agent"}),(0,r.jsx)(n.th,{children:"Responsibilities"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Desktop Shell Agent"}),(0,r.jsx)(n.td,{children:"Electron scaffolding, app lifecycle, persistence, content + asset IO, wiring sim \u2194 renderer."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Renderer Contract Agent"}),(0,r.jsx)(n.td,{children:"Define ViewModel / RenderCommandBuffer types and deterministic compilation rules."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WebGPU Renderer Agent"}),(0,r.jsx)(n.td,{children:"WebGPU device setup, pipelines, batching, atlases, text, perf instrumentation."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Debug Renderer Agent"}),(0,r.jsx)(n.td,{children:"Canvas2D/minimal backend for early contract validation and test harnesses."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Replay & Tooling Agent"}),(0,r.jsx)(n.td,{children:"Replay container format, record/replay runner, hashing/diffing, UI/CLI hooks."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CI/Build Agent"}),(0,r.jsx)(n.td,{children:"Workspace wiring, packaging scripts, platform CI notes, lint/test configuration."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Docs Agent"}),(0,r.jsx)(n.td,{children:"Keep this doc and follow-up subsystem docs aligned with implementation."})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Affected Packages/Services"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Existing: ",(0,r.jsx)(n.code,{children:"packages/core"}),", ",(0,r.jsx)(n.code,{children:"packages/controls"}),", ",(0,r.jsx)(n.code,{children:"packages/content-schema"}),", ",(0,r.jsx)(n.code,{children:"packages/docs"}),", ",(0,r.jsx)(n.code,{children:"docs/"}),", ",(0,r.jsx)(n.code,{children:"tools/runtime-sim"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["New (proposed): ",(0,r.jsx)(n.code,{children:"packages/shell-desktop"}),", ",(0,r.jsx)(n.code,{children:"packages/renderer-webgpu"}),", ",(0,r.jsx)(n.code,{children:"packages/renderer-debug"}),", plus a small \u201cboundary\u201d module for shared rendering types (see \xa76.2)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compatibility Considerations"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Keep ",(0,r.jsx)(n.code,{children:"packages/core"})," deterministic and platform-agnostic; avoid coupling core to Electron/WebGPU runtime specifics."]}),"\n",(0,r.jsx)(n.li,{children:"Version all replay formats; fail fast on mismatched engine version, content hash, or asset manifest hash."}),"\n",(0,r.jsx)(n.li,{children:"Ensure the renderer contract supports evolution (schema versioning, optional fields) without breaking existing replay files."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Headless runtime exists"}),": ",(0,r.jsx)(n.code,{children:"IdleEngineRuntime"})," implements a deterministic fixed-step loop with an accumulator (",(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts"}),") and deterministic command step stamping (",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Replay primitives exist"}),": ",(0,r.jsx)(n.code,{children:"CommandRecorder"})," can record commands + start state + runtime event frames and replay them (",(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"}),"), but there is no standardized file/container format and no visual replay."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shell integration examples exist (non-graphical)"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tools/runtime-sim"})," provides headless simulation/benchmark tooling and demonstrates host-driven runtime stepping."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rendering contract does not exist"}),": there is no ViewModel / RenderCommandBuffer schema, no renderer implementation, and no asset pipeline for 2D scenes/UI in this repo."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,r.jsx)(n.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Narrative"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The deterministic sim stays in ",(0,r.jsx)(n.code,{children:"packages/core"})," and produces authoritative state."]}),"\n",(0,r.jsx)(n.li,{children:"A shell hosts the sim, collects input, loads content packs, performs IO, and derives presentation data."}),"\n",(0,r.jsx)(n.li,{children:"A renderer consumes a data-only frame description and performs GPU rendering (no sim access, no IO)."}),"\n",(0,r.jsx)(n.li,{children:"Replay is treated as a first-class workflow: record authoritative inputs and deterministic derived outputs, then replay them for debugging."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Diagram"})," (desktop, recommended \u201cisolated sim\u201d default):"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"Electron Main Process\n  - app lifecycle\n  - filesystem IO (saves, content packs)\n  - native dialogs, window mgmt\n        |\n        | IPC (typed messages; no arbitrary eval)\n        v\nElectron Renderer Process (Chromium)\n  - input capture\n  - renderer-webgpu (GPU)\n  - HUD/UI system (GPU-rendered)\n  - replay UI (dev mode)\n        |\n        | postMessage (structured clone / typed arrays)\n        v\nSim Worker (Web Worker or WorkerThread)\n  - @idle-engine/core deterministic runtime\n  - command queue + systems\n  - (pure) selectViewModel(...)\n  - emits frames + events\n"})}),"\n",(0,r.jsx)(n.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,r.jsx)(n.h4,{id:"621-package-layout",children:"6.2.1 Package Layout"}),"\n",(0,r.jsx)(n.p,{children:"Proposed packages (additive to the workspace):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/shell-desktop"})," (",(0,r.jsx)(n.code,{children:"@idle-engine/shell-desktop"}),"): Electron desktop shell."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/renderer-webgpu"})," (",(0,r.jsx)(n.code,{children:"@idle-engine/renderer-webgpu"}),"): WebGPU backend implementation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/renderer-debug"})," (",(0,r.jsx)(n.code,{children:"@idle-engine/renderer-debug"}),", optional): Canvas2D/minimal backend."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/renderer-contract"})," (",(0,r.jsx)(n.code,{children:"@idle-engine/renderer-contract"}),"): shared, runtime-agnostic types for ViewModel and RenderCommandBuffer.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Rationale: keep the renderer contract stable and avoid depending on either ",(0,r.jsx)(n.code,{children:"@idle-engine/core"})," or WebGPU at runtime."]}),"\n",(0,r.jsx)(n.li,{children:"This package should be types-first and pure-data only (no IO, no DOM, no WebGPU)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"622-core--shell--renderer-boundaries",children:"6.2.2 Core \u2194 Shell \u2194 Renderer Boundaries"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Core responsibilities (unchanged constraints)"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Deterministic state transitions: ",(0,r.jsx)(n.code,{children:"state' = reduce(state, step, commands)"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Deterministic time: simulation time derived from ",(0,r.jsx)(n.code,{children:"(step * stepSizeMs)"}),", not wall clock."]}),"\n",(0,r.jsxs)(n.li,{children:["Emit runtime events as data (",(0,r.jsx)(n.code,{children:"EventBus"}),") for side effects, diagnostics, and tooling."]}),"\n",(0,r.jsxs)(n.li,{children:["Provide stable, pure selectors for \u201cpresentation derivation\u201d ",(0,r.jsx)(n.em,{children:"when feasible"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For engine-generic HUD (resources, generators, upgrades), selectors can live in core."}),"\n",(0,r.jsx)(n.li,{children:"For game-specific scene composition, selectors can live in a game module within the shell until content schemas mature."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Shell responsibilities"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Time source and fixed-step scheduling (",(0,r.jsx)(n.code,{children:"IdleEngineRuntime.tick(deltaMs)"}),"), including background throttling behavior and max-step budgets (note: ",(0,r.jsx)(n.code,{children:"tick(deltaMs)"})," may advance 0..N sim steps; the authoritative counter is ",(0,r.jsx)(n.code,{children:"step"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Input capture \u2192 ",(0,r.jsx)(n.code,{children:"@idle-engine/controls"})," mapping \u2192 runtime commands (player priority)."]}),"\n",(0,r.jsx)(n.li,{children:"Persistence (settings/saves), filesystem IO, content pack discovery/loading, and dev-mode hot reload."}),"\n",(0,r.jsx)(n.li,{children:"Asset management: load/validate assets and provide stable asset IDs + hashes to the renderer."}),"\n",(0,r.jsxs)(n.li,{children:["Record/replay orchestration:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"record: capture authoritative sim inputs + optional derived outputs,"}),"\n",(0,r.jsx)(n.li,{children:"replay: drive sim and/or renderer from recorded streams."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Renderer responsibilities"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Consume ViewModel or RenderCommandBuffer and render it."}),"\n",(0,r.jsx)(n.li,{children:"Own GPU resources (textures, atlases, pipelines, buffers, glyph caches)."}),"\n",(0,r.jsx)(n.li,{children:"Provide debug overlays (bounds, overdraw, missing assets) without altering sim state."}),"\n",(0,r.jsx)(n.li,{children:"Avoid IO and avoid any direct access to sim state (only data-only frame inputs)."}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"623-frame-description-two-layer-model",children:"6.2.3 Frame Description: Two-Layer Model"}),"\n",(0,r.jsx)(n.p,{children:"Adopt a two-layer approach, matching Issue 778:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ViewModel"}),": semantic \u201cwhat should be shown\u201d (UI widgets, sprites, meters, labels)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RenderCommandBuffer (RCB)"}),": explicit \u201chow to draw\u201d (pass, pipeline/material, quads, scissor, text runs)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Key requirements:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The compilation step ",(0,r.jsx)(n.code,{children:"ViewModel \u2192 RenderCommandBuffer"})," is deterministic:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"stable ordering rules (no reliance on insertion order),"}),"\n",(0,r.jsx)(n.li,{children:"explicit sort keys,"}),"\n",(0,r.jsxs)(n.li,{children:["no iteration-order hazards (",(0,r.jsx)(n.code,{children:"Map"}),"/",(0,r.jsx)(n.code,{children:"Set"})," and object key enumeration are forbidden in hashed payloads; represent dictionaries as ",(0,r.jsx)(n.code,{children:"[{ key, value }]"})," arrays sorted by ",(0,r.jsx)(n.code,{children:"key"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sortKey"})," is a ",(0,r.jsx)(n.code,{children:"uint64"})," with an explicitly defined encoding (avoid JS numbers > ",(0,r.jsx)(n.code,{children:"2^53 - 1"}),"):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["recommended in-memory representation: ",(0,r.jsx)(n.code,{children:"{ sortKeyHi: number; sortKeyLo: number }"})," where both are ",(0,r.jsx)(n.code,{children:"uint32"}),","]}),"\n",(0,r.jsxs)(n.li,{children:["ordering rule: ascending ",(0,r.jsx)(n.code,{children:"(sortKeyHi, sortKeyLo)"}),", then a stable tie-breaker (e.g., ",(0,r.jsx)(n.code,{children:"drawId"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Floats are canonicalized at the compile boundary so visual replay hashes are stable:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["reject ",(0,r.jsx)(n.code,{children:"NaN"}),", ",(0,r.jsx)(n.code,{children:"Infinity"}),", and ",(0,r.jsx)(n.code,{children:"-Infinity"}),","]}),"\n",(0,r.jsxs)(n.li,{children:["normalize ",(0,r.jsx)(n.code,{children:"-0"})," to ",(0,r.jsx)(n.code,{children:"0"}),","]}),"\n",(0,r.jsxs)(n.li,{children:["quantize world-space floats into fixed-point integers for the RCB (default: ",(0,r.jsx)(n.code,{children:"1/256"})," world units), and keep UI-space coordinates as integers."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Hashing is explicitly defined for replay validation and golden tests:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hashViewModel"}),"/",(0,r.jsx)(n.code,{children:"hashRCB"})," = ",(0,r.jsx)(n.code,{children:"SHA-256(canonicalEncode(payload))"}),","]}),"\n",(0,r.jsx)(n.li,{children:"canonical encoding must have stable key ordering and stable numeric formatting (if JSON is used, follow RFC 8785 JCS plus the numeric constraints above)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Both ViewModel and RCB are versioned for evolution and replay compatibility."}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"624-coordinate-systems--timing",children:"6.2.4 Coordinate Systems & Timing"}),"\n",(0,r.jsx)(n.p,{children:"Define explicit coordinate spaces up front to prevent later churn:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Simulation time"}),": ",(0,r.jsx)(n.code,{children:"simTimeMs = step * stepSizeMs"})," (authoritative)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"World space"}),": float world units in the ViewModel (camera-controlled). The RCB uses fixed-point integer coordinates (default quantization: ",(0,r.jsx)(n.code,{children:"1/256"})," world units) so hashing and replay validation are stable."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"UI space"}),": logical pixels with integer coordinates; apply devicePixelRatio scaling at renderer boundary."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Render frame cadence"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sim runs at fixed step (e.g., 60 Hz or 10 Hz depending on game)."}),"\n",(0,r.jsx)(n.li,{children:"Renderer renders at vsync; optionally interpolates between steps for smoother camera motion, but interpolation inputs must derive from deterministic sim time (or be recorded)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"625-renderer-contract-high-level-shape",children:"6.2.5 Renderer Contract (High-Level Shape)"}),"\n",(0,r.jsx)(n.p,{children:"The contract package defines (at minimum):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AssetId"})," and ",(0,r.jsx)(n.code,{children:"AssetManifest"})," (fonts, images, sprite sheets, shaders) with content hashes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FrameHeader"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{ step, simTimeMs, renderFrame?, contentHash, schemaVersion }"})," where ",(0,r.jsx)(n.code,{children:"step"})," is the authoritative sim step and ",(0,r.jsx)(n.code,{children:"renderFrame"})," is a monotonic counter for presented frames (optional when recording per-step ViewModels only)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ViewModel"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"frame"}),": ",(0,r.jsx)(n.code,{children:"FrameHeader"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scene"}),": camera + sprite instances + optional tilemap/particle descriptors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ui"}),": a small set of GPU-friendly primitives (rect, image, text, meter/progress bar), plus layout metadata"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RenderCommandBuffer"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"frame"}),": ",(0,r.jsx)(n.code,{children:"FrameHeader"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"passes[]"}),": e.g., ",(0,r.jsx)(n.code,{children:"world"}),", ",(0,r.jsx)(n.code,{children:"ui"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"draws[]"})," (or pass-scoped draws): each draw has a stable ",(0,r.jsx)(n.code,{children:"sortKey"})," and references materials/geometry"]}),"\n",(0,r.jsxs)(n.li,{children:["optional ",(0,r.jsx)(n.code,{children:"debug"})," channels (bounds, missing assets, perf markers)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Design guardrail: the renderer contract must remain \u201cdata only\u201d, serializable, and amenable to hashing/diffing for replay validation."}),"\n",(0,r.jsx)(n.h4,{id:"626-webgpu-renderer-capabilities-roadmap",children:"6.2.6 WebGPU Renderer (Capabilities Roadmap)"}),"\n",(0,r.jsx)(n.p,{children:"The WebGPU backend is split into milestones (initially minimal, growing over time):"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scaffold"}),": device init + swapchain + clear screen; integrate with shell window resize."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sprites"}),": texture loading, atlas, instanced quad batching, camera transforms, alpha blending."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"GPU UI primitives"}),": rects, images, 9-slice (optional), scissor/clipping, transforms."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Text"}),": bitmap or MSDF glyph atlas + deterministic layout strategy (see Open Questions)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scene features"}),": tilemaps, particles, animation tracks, culling."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling"}),": perf HUD, frame capture, replay stepping UI, debug overlays."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"627-deterministic-recordreplay-sim--visual",children:"6.2.7 Deterministic Record/Replay (Sim + Visual)"}),"\n",(0,r.jsx)(n.p,{children:"Provide two complementary replay products:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A) Sim Replay (authoritative)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Purpose: reproduce state evolution for debugging/verification; foundation for offline tooling."}),"\n",(0,r.jsx)(n.li,{children:"Inputs: content identity + initial state snapshot + command stream + RNG seed/state."}),"\n",(0,r.jsxs)(n.li,{children:["Recommended baseline implementation: build on ",(0,r.jsx)(n.code,{children:"CommandRecorder"})," (",(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"}),") and state snapshot tooling (",(0,r.jsx)(n.code,{children:"docs/state-synchronization-protocol-design.md"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B) Visual Replay (debugging)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Purpose: reproduce and inspect visuals without rerunning sim; validate ViewModel/RCB determinism."}),"\n",(0,r.jsxs)(n.li,{children:["Recorded data (configurable):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"per-step ViewModel (after each sim step),"}),"\n",(0,r.jsx)(n.li,{children:"and/or per-render-frame RenderCommandBuffer (post-compile)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Validation: during a \u201ccombined replay\u201d, run sim replay and compare computed ViewModel/RCB hashes against recorded frames. Mismatches fail fast and include a diffable summary."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Replay container format (high-level)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use a versioned container with explicit headers, designed for large frame streams:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"header"}),": engine version, platform, schema versions, stepSizeMs, capture metadata."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"content"}),": content pack ID/version + content hash; fail on mismatch."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"assets"}),": asset manifest hash + per-asset digests; fail on mismatch unless explicitly allowed."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sim"}),": command log (and optionally runtime event frames)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"frames"}),": chunked ViewModel/RCB frames; include per-frame hashes for quick validation."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"628-asset-determinism--atlas-packing",children:"6.2.8 Asset Determinism & Atlas Packing"}),"\n",(0,r.jsx)(n.p,{children:"To keep visual replays stable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Asset IDs are stable and come from manifests (not file paths)."}),"\n",(0,r.jsxs)(n.li,{children:["Atlas packing must be deterministic:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"stable input ordering (sort by asset ID),"}),"\n",(0,r.jsx)(n.li,{children:"deterministic packing algorithm and tie-breaking,"}),"\n",(0,r.jsx)(n.li,{children:"record the atlas layout hash in replay headers and optionally record the layout itself."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Fail-fast behavior:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"mismatched content hash \u2192 abort replay (authoritative sim mismatch),"}),"\n",(0,r.jsx)(n.li,{children:"mismatched asset manifest hash \u2192 abort visual replay (render mapping mismatch), unless replay is \u201clogic-only\u201d."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deployment"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The desktop shell ships as a separate package/app; CI should build artifacts per platform."}),"\n",(0,r.jsx)(n.li,{children:"Prefer a reproducible build pipeline; avoid \u201cdownload at runtime\u201d for critical assets (fonts/sprite sheets)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Telemetry & Observability"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Leverage existing runtime diagnostics timeline (",(0,r.jsx)(n.code,{children:"packages/core/src/diagnostics/*"}),") and expose a dev overlay in the shell."]}),"\n",(0,r.jsx)(n.li,{children:"Add renderer metrics: frame time, GPU submission time, batch counts, atlas pressure, glyph cache churn."}),"\n",(0,r.jsx)(n.li,{children:"Ensure replay validation errors provide structured JSON summaries suitable for CI parsing (mirroring existing deterministic test/reporting practices)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security & Compliance"})," (Electron):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Follow Electron security guidance (context isolation, disable Node integration in renderer, narrow preload API surface)."}),"\n",(0,r.jsx)(n.li,{children:"Treat replay and content pack files as untrusted input: validate schema versions, lengths, and hashes before ingestion."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,r.jsx)(n.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Issue"}),(0,r.jsx)(n.th,{children:"Scope Summary"}),(0,r.jsx)(n.th,{children:"Proposed Assignee/Agent"}),(0,r.jsx)(n.th,{children:"Dependencies"}),(0,r.jsx)(n.th,{children:"Acceptance Criteria"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/778",children:"#778"})," ",(0,r.jsx)(n.code,{children:"docs: desktop shell + WebGPU renderer + replay"})]}),(0,r.jsx)(n.td,{children:"This document + follow-up links"}),(0,r.jsx)(n.td,{children:"Docs Agent"}),(0,r.jsx)(n.td,{children:"None"}),(0,r.jsx)(n.td,{children:"Doc merged and referenced from Issue 778"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/781",children:"#781"})," ",(0,r.jsx)(n.code,{children:"chore(shell-desktop): Electron scaffolding"})]}),(0,r.jsx)(n.td,{children:"Main/preload/renderer scaffolding, window lifecycle"}),(0,r.jsx)(n.td,{children:"Desktop Shell Agent"}),(0,r.jsx)(n.td,{children:"Doc approved"}),(0,r.jsx)(n.td,{children:"App opens window, clean shutdown, basic IPC wiring"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/782",children:"#782"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-contract): define ViewModel + RCB types"})]}),(0,r.jsx)(n.td,{children:"Add data-only contract package with versioning"}),(0,r.jsx)(n.td,{children:"Renderer Contract Agent"}),(0,r.jsx)(n.td,{children:"Doc approved"}),(0,r.jsx)(n.td,{children:"Types published in workspace; basic validation + hashing helpers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/783",children:"#783"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-debug): minimal backend"})]}),(0,r.jsx)(n.td,{children:"Canvas2D/minimal WebGPU backend consuming RCB"}),(0,r.jsx)(n.td,{children:"Debug Renderer Agent"}),(0,r.jsx)(n.td,{children:"render-contract"}),(0,r.jsx)(n.td,{children:"Can render a handful of primitives; supports replay stepping"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/784",children:"#784"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-webgpu): device init + clear"})]}),(0,r.jsx)(n.td,{children:"WebGPU init + resize + present loop"}),(0,r.jsx)(n.td,{children:"WebGPU Renderer Agent"}),(0,r.jsx)(n.td,{children:"render-contract"}),(0,r.jsx)(n.td,{children:"Renders stable clear color; handles device loss gracefully"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/785",children:"#785"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-webgpu): sprites + batching"})]}),(0,r.jsx)(n.td,{children:"Quad batching + texture/atlas loader"}),(0,r.jsx)(n.td,{children:"WebGPU Renderer Agent"}),(0,r.jsx)(n.td,{children:"device init"}),(0,r.jsx)(n.td,{children:"Draw N sprites deterministically with stable sort"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/786",children:"#786"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-webgpu): GPU UI primitives"})]}),(0,r.jsx)(n.td,{children:"Rect/image primitives + clipping"}),(0,r.jsx)(n.td,{children:"WebGPU Renderer Agent"}),(0,r.jsx)(n.td,{children:"sprites"}),(0,r.jsx)(n.td,{children:"HUD panels render without DOM"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/787",children:"#787"})," ",(0,r.jsx)(n.code,{children:"feat(renderer-webgpu): text pipeline"})]}),(0,r.jsx)(n.td,{children:"Bitmap/MSDF text rendering + deterministic layout"}),(0,r.jsx)(n.td,{children:"WebGPU Renderer Agent"}),(0,r.jsx)(n.td,{children:"UI primitives"}),(0,r.jsx)(n.td,{children:"Text renders deterministically for packaged fonts"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/788",children:"#788"})," ",(0,r.jsx)(n.code,{children:"feat(shell-desktop): sim worker + frame pump"})]}),(0,r.jsx)(n.td,{children:"Run core in Worker, emit ViewModel/RCB to renderer"}),(0,r.jsx)(n.td,{children:"Desktop Shell Agent"}),(0,r.jsx)(n.td,{children:"Electron scaffolding + contract"}),(0,r.jsx)(n.td,{children:"Sim steps deterministically; renderer receives frames"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/789",children:"#789"})," ",(0,r.jsx)(n.code,{children:"feat(replay): sim replay container + runner"})]}),(0,r.jsx)(n.td,{children:"Write/read sim replay files; CLI or in-app UI"}),(0,r.jsx)(n.td,{children:"Replay & Tooling Agent"}),(0,r.jsx)(n.td,{children:"render-contract + shell"}),(0,r.jsx)(n.td,{children:"Record & replay sim commands; validate final state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/790",children:"#790"})," ",(0,r.jsx)(n.code,{children:"feat(replay): visual replay (ViewModel/RCB)"})]}),(0,r.jsx)(n.td,{children:"Record per-frame ViewModel/RCB; hash validation"}),(0,r.jsx)(n.td,{children:"Replay & Tooling Agent"}),(0,r.jsx)(n.td,{children:"replay container + renderer"}),(0,r.jsx)(n.td,{children:"Replay reproduces identical frame hashes on same build/content"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/791",children:"#791"})," ",(0,r.jsx)(n.code,{children:"test(render-compiler): deterministic RCB generation"})]}),(0,r.jsx)(n.td,{children:"Golden tests for compilation determinism"}),(0,r.jsx)(n.td,{children:"Renderer Contract Agent"}),(0,r.jsx)(n.td,{children:"contract"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"pnpm test"})," passes; deterministic ordering validated"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 1 \u2014 Foundations"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Electron shell scaffolding + renderer contract + minimal debug renderer + WebGPU \u201cclear screen\u201d."}),"\n",(0,r.jsx)(n.li,{children:"Establish replay container header conventions and basic sim recording integration."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 2 \u2014 2D Rendering + GPU UI"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sprites, atlases, UI primitives, and an initial text strategy."}),"\n",(0,r.jsx)(n.li,{children:"Deterministic compile rules + golden tests for RCB generation."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Phase 3 \u2014 Replay Tooling"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Combined replay runner (sim + visual) with hash validation and step-through UI."}),"\n",(0,r.jsx)(n.li,{children:"Perf HUD and capture/export workflows for debugging."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hand-off Package"})," (minimum context for implementation agents):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"})," (step stamping + determinism contract)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts"})," (tick loop and step lifecycle)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"})," (existing command replay utility)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/core/src/resource-publish-transport.ts"})," (typed-array transport patterns)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"packages/controls/src/index.ts"})," (input \u2192 command mapping contract)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication Cadence"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Phase boundary reviews (contract + scaffolding, then rendering primitives, then replay tooling)."}),"\n",(0,r.jsx)(n.li,{children:"Keep follow-up issues small and sliceable (one contract change per PR where possible)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Packets"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Always load: ",(0,r.jsx)(n.code,{children:"docs/design-document-template.md"}),", ",(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md"}),", Issue 778."]}),"\n",(0,r.jsxs)(n.li,{children:["For determinism: ",(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"}),", ",(0,r.jsx)(n.code,{children:"docs/runtime-step-lifecycle.md"}),", ",(0,r.jsx)(n.code,{children:"docs/state-synchronization-protocol-design.md"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["For replay: ",(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prompting & Constraints"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Keep the sim deterministic: no wall-clock time or unseeded randomness in selectors/compilers."}),"\n",(0,r.jsx)(n.li,{children:"Keep renderer contract data-only and versioned; avoid leaking core internals into renderer."}),"\n",(0,r.jsx)(n.li,{children:"Prefer pure functions for compilation and hashing so tests can run in Node without GPU."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Safety Rails"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Do not edit checked-in ",(0,r.jsx)(n.code,{children:"dist/"})," outputs by hand."]}),"\n",(0,r.jsx)(n.li,{children:"Do not introduce console noise that could corrupt JSON-based test reporters."}),"\n",(0,r.jsx)(n.li,{children:"Treat replay/content/asset files as untrusted input: validate before use."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation Hooks"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"pnpm lint"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pnpm test"})," (and package-filtered tests during iteration)"]}),"\n",(0,r.jsxs)(n.li,{children:["If tests affect coverage, regenerate via ",(0,r.jsx)(n.code,{children:"pnpm coverage:md"})," (do not edit ",(0,r.jsx)(n.code,{children:"docs/coverage/index.md"})," manually)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use DOM/CSS for UI"}),": rejected due to explicit constraint; also undermines deterministic UI/layout when relying on browser font metrics and CSS."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use an off-the-shelf renderer (PixiJS/WebGL/Unity/Godot)"}),": rejected for long-horizon control, determinism, and deep integration needs (replay + debug overlays + contract stability)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tauri instead of Electron"}),": viable long-term, but Electron is chosen initially for ecosystem maturity and faster iteration on WebGPU/WebView behavior; revisit once contracts stabilize."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Run sim in Electron main process"}),": viable, but sim-in-worker (renderer process) aligns with existing browser-safe runtime entrypoints and keeps a strict UI/IO boundary; evaluate per performance/profiling."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unit / Integration"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Contract-level tests: canonicalization, hashing, deterministic ordering of ViewModel/RCB structures."}),"\n",(0,r.jsx)(n.li,{children:"Replay tests: sim replay produces identical end-state checksums; combined replay validates ViewModel/RCB frame hashes."}),"\n",(0,r.jsx)(n.li,{children:"Shell tests (where feasible): IPC message validation, file format validation."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add micro-benchmarks for compile step (ViewModel \u2192 RCB) and sprite batching."}),"\n",(0,r.jsx)(n.li,{children:"Track renderer frame time budgets and regression thresholds (CI-reported, not necessarily gating initially)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling / A11y"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"GPU UI must include focus navigation and readable text scaling strategies (tracked as a follow-up workstream if not immediately delivered)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Risk"}),(0,r.jsx)(n.th,{children:"Impact"}),(0,r.jsx)(n.th,{children:"Mitigation"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WebGPU platform/driver variance"}),(0,r.jsx)(n.td,{children:"Rendering differences or device loss"}),(0,r.jsx)(n.td,{children:"Implement robust device-loss handling; keep debug renderer; gate advanced features behind capability checks"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Text determinism (fonts/layout)"}),(0,r.jsx)(n.td,{children:"Replay mismatches across machines"}),(0,r.jsx)(n.td,{children:"Use packaged fonts + deterministic metrics; start with bitmap/MSDF and constrain shaping; record layout decisions in replay if needed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Renderer contract churn"}),(0,r.jsx)(n.td,{children:"Downstream work blocked by breaking changes"}),(0,r.jsx)(n.td,{children:"Version contracts; keep changes additive; add \u201ccontract conformance\u201d tests and replay golden sets"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Large replay files"}),(0,r.jsx)(n.td,{children:"Slow IO, poor UX"}),(0,r.jsx)(n.td,{children:"Chunk frames; optional recording modes; compression as follow-up"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Asset pipeline complexity"}),(0,r.jsx)(n.td,{children:"Non-determinism, long iteration times"}),(0,r.jsx)(n.td,{children:"Stable asset manifests + hashes; deterministic atlas packing; start simple and iterate"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Electron security pitfalls"}),(0,r.jsx)(n.td,{children:"RCE risk"}),(0,r.jsx)(n.td,{children:"Follow security checklist; minimal preload API; no remote content by default"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Milestones"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Introduce packages behind dev-only entrypoints first."}),"\n",(0,r.jsx)(n.li,{children:"Promote to \u201cfirst-party shell\u201d once replay + renderer contract are stable and smoke-tested on all three OSes."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Migration Strategy"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Additive: no required changes for existing core consumers."}),"\n",(0,r.jsx)(n.li,{children:"Replay formats are versioned; older replays remain loadable via adapters or explicit \u201cunsupported version\u201d errors."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Track progress in Issue 778 with links to the issue map entries and the latest replay/renderer contract versions."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Text strategy"}),": bitmap fonts vs MSDF; shaping scope (ASCII only vs full shaping via HarfBuzz/WASM)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"UI layout engine"}),": custom layout vs flexbox-like solver (Yoga) vs immediate-mode UI."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coordinate and unit conventions"}),": world-units vs pixel-units; camera scaling rules; integer quantization boundaries."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Where ViewModel is authored"}),": in ",(0,r.jsx)(n.code,{children:"packages/core"})," selectors vs a game module in the shell vs content-driven scene graph."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Renderer fallback policy"}),": is a WebGL fallback required, or is debug renderer sufficient?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Replay container format details"}),": JSON vs binary, compression, streaming, hash digest size/perf trade-offs (e.g., full SHA-256 vs truncated/faster hashes)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add a dedicated \u201cShell & Rendering\u201d documentation section (including how downstream apps can reuse the renderer contract without Electron)."}),"\n",(0,r.jsx)(n.li,{children:"Extend content schemas to optionally declare asset manifests and scene composition metadata (if/when game requirements demand it)."}),"\n",(0,r.jsx)(n.li,{children:"Add a \u201creplay inspector\u201d tool (CLI + in-app) with diff views, frame scrubber, and export-to-bug-report workflow."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"15-references",children:"15. References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/778",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/778"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/design-document-template.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/idle-engine-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/runtime-step-lifecycle.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docs/state-synchronization-protocol-design.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/internals.browser.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/command-recorder.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/core/src/resource-publish-transport.ts"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"packages/controls/src/index.ts"})}),"\n",(0,r.jsxs)(n.li,{children:["WebGPU spec: ",(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/webgpu/",children:"https://www.w3.org/TR/webgpu/"})]}),"\n",(0,r.jsxs)(n.li,{children:["WGSL spec: ",(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/WGSL/",children:"https://www.w3.org/TR/WGSL/"})]}),"\n",(0,r.jsxs)(n.li,{children:["Electron security guide: ",(0,r.jsx)(n.a,{href:"https://www.electronjs.org/docs/latest/tutorial/security",children:"https://www.electronjs.org/docs/latest/tutorial/security"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shell"}),": The host application that owns IO, input, scheduling, and integrates sim + renderer."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ViewModel"}),": Semantic, renderer-agnostic data describing what should appear in the scene/UI."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RenderCommandBuffer (RCB)"}),": Renderer-ready draw list and associated metadata with deterministic ordering."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sim Replay"}),": Authoritative replay based on initial state + command stream + RNG."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Visual Replay"}),": Replay of ViewModel and/or RCB frames for visual debugging without rerunning sim."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Date"}),(0,r.jsx)(n.th,{children:"Author"}),(0,r.jsx)(n.th,{children:"Change Summary"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2026-01-16"}),(0,r.jsx)(n.td,{children:"Codex (AI)"}),(0,r.jsx)(n.td,{children:"Initial draft for Issue 778"})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},7678:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>t});var i=s(9430);const r={},l=i.createContext(r);function d(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);