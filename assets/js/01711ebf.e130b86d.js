"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[428],{4337:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"controls-contract-design-issue-705","title":"Controls Contract Design (Issue 705)","description":"Document Control","source":"@site/../../docs/controls-contract-design-issue-705.md","sourceDirName":".","slug":"/controls-contract-design-issue-705","permalink":"/Idle-Game-Engine/controls-contract-design-issue-705","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/controls-contract-design-issue-705.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Controls Contract Design (Issue 705)","sidebar_position":5},"sidebar":"developerSidebar","previous":{"title":"Runtime Command Queue Design","permalink":"/Idle-Game-Engine/runtime-command-queue-design"},"next":{"title":"Runtime Event Pub/Sub Design","permalink":"/Idle-Game-Engine/runtime-event-pubsub-design"}}');var t=n(5270),d=n(7678);const r={title:"Controls Contract Design (Issue 705)",sidebar_position:5},c="Controls Contract Design (Issue 705)",o={},l=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"controls-contract-design-issue-705",children:"Controls Contract Design (Issue 705)"})}),"\n",(0,t.jsx)(s.h2,{id:"document-control",children:"Document Control"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Title"}),": Define controls contract package for Issue 705"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Authors"}),": Codex (AI)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Reviewers"}),": TODO (Owner: Runtime Core Maintainers)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Status"}),": Draft"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Last Updated"}),": 2025-12-30"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Related Issues"}),": ",(0,t.jsx)(s.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/705",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/705"}),", ",(0,t.jsx)(s.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/706",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/706"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Execution Mode"}),": AI-led"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,t.jsxs)(s.p,{children:["Regarding issue 705 on GitHub, use gh: this design introduces ",(0,t.jsx)(s.code,{children:"@idle-engine/controls"}),", a platform-agnostic controls contract and helper layer that maps input intents into deterministic runtime ",(0,t.jsx)(s.code,{children:"Command"})," objects aligned with ",(0,t.jsx)(s.code,{children:"RUNTIME_COMMAND_TYPES"})," and payloads, keeping ",(0,t.jsx)(s.code,{children:"packages/core"})," presentation-agnostic while giving downstream shells a stable API and documentation in ",(0,t.jsx)(s.code,{children:"docs/"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Background"}),": Issue 705 builds on deterministic command definitions (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"}),") and queue semantics (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:18"}),") documented in ",(0,t.jsx)(s.code,{children:"docs/runtime-command-queue-design.md:19"}),", with automation already providing a deterministic mapping helper (",(0,t.jsx)(s.code,{children:"packages/core/src/automation-system.ts:862"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Problem"}),": Issue 705 lacks a shared control/binding contract for shells, resulting in inconsistent input mappings and no standard helper to stamp ",(0,t.jsx)(s.code,{children:"step"}),", ",(0,t.jsx)(s.code,{children:"timestamp"}),", and ",(0,t.jsx)(s.code,{children:"priority"})," compatible with the core command model."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Forces"}),": Issue 705 must keep ",(0,t.jsx)(s.code,{children:"packages/core"})," presentation-agnostic, avoid DOM/Node dependencies, preserve determinism with step-based timestamps, and align naming with ",(0,t.jsx)(s.code,{children:"RUNTIME_COMMAND_TYPES"})," (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:107"}),")."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Goals"}),":","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Issue 705 defines ",(0,t.jsx)(s.code,{children:"ControlAction"}),", ",(0,t.jsx)(s.code,{children:"ControlBinding"}),", ",(0,t.jsx)(s.code,{children:"ControlScheme"}),", ",(0,t.jsx)(s.code,{children:"ControlEvent"}),", and ",(0,t.jsx)(s.code,{children:"ControlContext"})," in a new ",(0,t.jsx)(s.code,{children:"packages/controls"})," package, aligned to ",(0,t.jsx)(s.code,{children:"RuntimeCommandType"})," payloads (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:107"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["Issue 705 delivers helpers that create deterministic ",(0,t.jsx)(s.code,{children:"Command"})," objects with ",(0,t.jsx)(s.code,{children:"CommandPriority.PLAYER"})," defaults (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:77"}),") and step-based timestamps, matching command queue expectations (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:74"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["Issue 705 adds ",(0,t.jsx)(s.code,{children:"docs/"})," guidance and a sidebar entry for shell usage (",(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"}),")."]}),"\n",(0,t.jsx)(s.li,{children:"Issue 705 optionally normalizes and validates control schemes with stable ordering and required references."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Non-Goals"}),":","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Issue 705 does not implement device-specific capture (keyboard/mouse/gamepad/touch)."}),"\n",(0,t.jsx)(s.li,{children:"Issue 705 does not add UI or persistence for bindings."}),"\n",(0,t.jsxs)(s.li,{children:["Issue 705 does not change runtime command queue semantics or dispatcher behavior (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:74"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Primary Stakeholders"}),": Issue 705 is owned by Runtime Core maintainers, with downstream shell maintainers and Docs maintainers as key stakeholders."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Agent Roles"}),":"]}),"\n"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Agent"}),(0,t.jsx)(s.th,{children:"Responsibilities"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Controls Contract Agent"}),(0,t.jsxs)(s.td,{children:["Issue 705: define control types and exports in ",(0,t.jsx)(s.code,{children:"packages/controls"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Controls Helper Agent"}),(0,t.jsx)(s.td,{children:"Issue 705: implement control-to-command helpers and normalization utilities."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Testing Agent"}),(0,t.jsx)(s.td,{children:"Issue 705: add unit coverage for mapping and validation helpers."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Docs Agent"}),(0,t.jsxs)(s.td,{children:["Issue 705: add and wire documentation in ",(0,t.jsx)(s.code,{children:"docs/"})," and ",(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"}),"."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Integration Agent"}),(0,t.jsx)(s.td,{children:"Issue 705: validate workspace build/test wiring and exports."})]})]})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Affected Packages/Services"}),": Issue 705 introduces ",(0,t.jsx)(s.code,{children:"packages/controls"}),", references ",(0,t.jsx)(s.code,{children:"@idle-engine/core"})," exports (",(0,t.jsx)(s.code,{children:"packages/core/src/index.ts:971"}),"), and updates ",(0,t.jsx)(s.code,{children:"docs/"})," plus ",(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Compatibility Considerations"}),": Issue 705 is additive, preserves backwards compatibility in ",(0,t.jsx)(s.code,{children:"packages/core"}),", and requires a stable contract version field for control schemes."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,t.jsxs)(s.p,{children:["Issue 705 currently relies on command definitions (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"}),"), deterministic queue ordering (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:18"}),"), and queue tests (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.test.ts:45"}),") without a shared control/binding contract for shells. There is no ",(0,t.jsx)(s.code,{children:"packages/controls"})," package today (follow-up: create ",(0,t.jsx)(s.code,{children:"packages/controls"})," as a new workspace module), and presentation shell docs are archived (",(0,t.jsx)(s.code,{children:"docs/index.md:22"}),")."]}),"\n",(0,t.jsx)(s.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,t.jsx)(s.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Narrative"}),": Issue 705 adds a ",(0,t.jsx)(s.code,{children:"@idle-engine/controls"})," package that accepts ",(0,t.jsx)(s.code,{children:"ControlEvent"})," intents from shells, resolves them against a ",(0,t.jsx)(s.code,{children:"ControlScheme"}),", and emits deterministic ",(0,t.jsx)(s.code,{children:"Command"})," objects using a ",(0,t.jsx)(s.code,{children:"ControlContext"})," for step/timestamp stamping. The runtime remains unchanged; shells enqueue commands using the existing queue API (",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:93"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Diagram"}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Shell input capture\n  -> ControlEvent (intent + phase)\n  -> ControlScheme (bindings + actions)\n  -> resolveControlActions(scheme, event)\n  -> createControlCommand(action, context)\n  -> CommandQueue.enqueue(Command)\n"})}),"\n",(0,t.jsx)(s.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Runtime Changes"}),": Issue 705 introduces no runtime changes; ",(0,t.jsx)(s.code,{children:"packages/core"})," remains deterministic and presentation-agnostic (",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Data & Schemas"}),": Issue 705 defines platform-agnostic contracts aligned to ",(0,t.jsx)(s.code,{children:"RuntimeCommandType"})," payloads, e.g., ",(0,t.jsx)(s.code,{children:"ControlEvent"}),", ",(0,t.jsx)(s.code,{children:"ControlAction"}),", ",(0,t.jsx)(s.code,{children:"ControlBinding"}),", ",(0,t.jsx)(s.code,{children:"ControlScheme"}),", and ",(0,t.jsx)(s.code,{children:"ControlContext"})," in ",(0,t.jsx)(s.code,{children:"packages/controls"})," (follow-up: create ",(0,t.jsx)(s.code,{children:"packages/controls/src/index.ts"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"APIs & Contracts"}),": Issue 705 exports ",(0,t.jsx)(s.code,{children:"resolveControlActions"}),", ",(0,t.jsx)(s.code,{children:"createControlCommand"}),", and ",(0,t.jsx)(s.code,{children:"createControlCommands"})," to resolve actions and create commands, including defaults for priority and step offsets consistent with automation stamping (",(0,t.jsx)(s.code,{children:"packages/core/src/automation-system.ts:862"}),"). Action ids are expected to be unique; helpers reject duplicates."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Tooling & Automation"}),": Issue 705 adds documentation under ",(0,t.jsx)(s.code,{children:"docs/"})," and updates ",(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"}),", plus workspace scripts for ",(0,t.jsx)(s.code,{children:"packages/controls"})," (follow-up: define ",(0,t.jsx)(s.code,{children:"packages/controls/package.json"}),")."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Deployment"}),": Issue 705 is additive; no runtime migrations are required."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Telemetry & Observability"}),": Issue 705 introduces no new telemetry in ",(0,t.jsx)(s.code,{children:"packages/core"}),"; shells may instrument control event ingestion."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Security & Compliance"}),": Issue 705 requires JSON-safe metadata only and forbids DOM/Node APIs to keep contracts portable."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,t.jsx)(s.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Issue Title"}),(0,t.jsx)(s.th,{children:"Scope Summary"}),(0,t.jsx)(s.th,{children:"Proposed Assignee/Agent"}),(0,t.jsx)(s.th,{children:"Dependencies"}),(0,t.jsx)(s.th,{children:"Acceptance Criteria"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"chore(controls): scaffold package"}),(0,t.jsxs)(s.td,{children:["Issue 705: add ",(0,t.jsx)(s.code,{children:"packages/controls"})," with build/test/lint scripts"]}),(0,t.jsx)(s.td,{children:"Controls Contract Agent"}),(0,t.jsx)(s.td,{children:"Doc approval"}),(0,t.jsx)(s.td,{children:"Package builds; exports defined; no DOM/Node deps"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"feat(controls): define control contracts"}),(0,t.jsx)(s.td,{children:"Issue 705: types for actions, bindings, schemes, events, context"}),(0,t.jsx)(s.td,{children:"Controls Contract Agent"}),(0,t.jsx)(s.td,{children:"Package scaffold"}),(0,t.jsx)(s.td,{children:"Type-only imports used; contracts exported"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"feat(controls): helper mapping"}),(0,t.jsxs)(s.td,{children:["Issue 705: map control events to ",(0,t.jsx)(s.code,{children:"Command"})," with deterministic stamping"]}),(0,t.jsx)(s.td,{children:"Controls Helper Agent"}),(0,t.jsx)(s.td,{children:"Contract types"}),(0,t.jsx)(s.td,{children:"Default priority/step/timestamp applied; docs updated"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"feat(controls): normalize/validate"}),(0,t.jsx)(s.td,{children:"Issue 705: optional normalization + validation of schemes"}),(0,t.jsx)(s.td,{children:"Controls Helper Agent"}),(0,t.jsx)(s.td,{children:"Contract types"}),(0,t.jsx)(s.td,{children:"Stable ordering; validation errors returned"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"test(controls): helpers"}),(0,t.jsx)(s.td,{children:"Issue 705: unit tests for mapping/validation"}),(0,t.jsx)(s.td,{children:"Testing Agent"}),(0,t.jsx)(s.td,{children:"Helpers"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"pnpm test --filter @idle-engine/controls"})," passes"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"docs: controls contract design"}),(0,t.jsx)(s.td,{children:"Issue 705: add design doc + sidebar update"}),(0,t.jsx)(s.td,{children:"Docs Agent"}),(0,t.jsx)(s.td,{children:"None"}),(0,t.jsxs)(s.td,{children:["Doc in ",(0,t.jsx)(s.code,{children:"docs/"}),"; sidebar updated"]})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Phase 1"}),": Issue 705 doc approval and ",(0,t.jsx)(s.code,{children:"packages/controls"})," scaffolding complete."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Phase 2"}),": Issue 705 helpers, validation, and tests complete."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Hand-off Package"}),": Issue 705 agents should load ",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"}),", ",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:18"}),", ",(0,t.jsx)(s.code,{children:"packages/core/src/automation-system.ts:862"}),", and ",(0,t.jsx)(s.code,{children:"docs/runtime-command-queue-design.md:19"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Communication Cadence"}),": Issue 705 updates at phase boundaries, with daily updates during implementation."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Context Packets"}),": Issue 705 agents must read ",(0,t.jsx)(s.code,{children:"docs/design-document-template.md"}),", ",(0,t.jsx)(s.code,{children:"docs/runtime-command-queue-design.md:19"}),", ",(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"}),", ",(0,t.jsx)(s.code,{children:"packages/core/src/automation-system.ts:862"}),", and ",(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Prompting & Constraints"}),": Issue 705 prompt snippet:"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"You are the Controls Contract Agent for Issue 705. Implement @idle-engine/controls with type-only imports from @idle-engine/core, keep helpers pure and deterministic, avoid DOM/Node APIs, and align naming with RUNTIME_COMMAND_TYPES.\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Safety Rails"}),": Issue 705 agents must not edit ",(0,t.jsx)(s.code,{children:"dist/"})," outputs, must not use non-deterministic timestamps, and must keep changes within ",(0,t.jsx)(s.code,{children:"packages/controls"})," and ",(0,t.jsx)(s.code,{children:"docs/"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Validation Hooks"}),": Issue 705 completion requires ",(0,t.jsx)(s.code,{children:"pnpm lint"}),", ",(0,t.jsx)(s.code,{children:"pnpm test --filter @idle-engine/controls"}),", and ",(0,t.jsx)(s.code,{children:"pnpm coverage:md"})," if tests or coverage change."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,t.jsx)(s.p,{children:"Issue 705 alternatives considered and rejected:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Put control contracts in ",(0,t.jsx)(s.code,{children:"packages/core"})," (breaks presentation-agnostic boundary)."]}),"\n",(0,t.jsx)(s.li,{children:"Let each shell define its own binding schema (fragmented API, inconsistent priorities)."}),"\n",(0,t.jsxs)(s.li,{children:["Reuse transport envelopes from ",(0,t.jsx)(s.code,{children:"packages/core"})," (transport semantics do not express bindings)."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Unit / Integration"}),": Issue 705 adds ",(0,t.jsx)(s.code,{children:"packages/controls"})," unit tests for mapping, defaults, and validation, with the core command queue tested in ",(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.test.ts:45"})," as a reference baseline."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Performance"}),": Issue 705 ensures mapping helpers are linear in scheme size and avoid per-event allocations beyond lookup."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Tooling / A11y"}),": Issue 705 has no UI surface; accessibility testing is not applicable."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Risk"}),(0,t.jsx)(s.th,{children:"Impact"}),(0,t.jsx)(s.th,{children:"Mitigation"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Issue 705 contract is too generic"}),(0,t.jsx)(s.td,{children:"Shells diverge and tooling fragments"}),(0,t.jsx)(s.td,{children:"Provide canonical intent patterns and validation defaults in docs"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Issue 705 helpers use wall-clock time"}),(0,t.jsx)(s.td,{children:"Determinism breaks"}),(0,t.jsxs)(s.td,{children:["Require step-based timestamps in ",(0,t.jsx)(s.code,{children:"ControlContext"})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Issue 705 adds runtime coupling"}),(0,t.jsx)(s.td,{children:"Version skew between controls and core"}),(0,t.jsx)(s.td,{children:"Use type-only imports and keep helpers pure"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Milestones"}),": Issue 705 ships in two phases (contract + docs, then helpers + tests)."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Migration Strategy"}),": Issue 705 is additive with no data migration required."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Communication"}),": Issue 705 release notes should link to this doc and reference ",(0,t.jsx)(s.code,{children:"@idle-engine/controls"})," usage."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Issue 705 TODO (Owner: Shell Maintainers): Should ",(0,t.jsx)(s.code,{children:"ControlEvent"})," support analog axis values beyond metadata?"]}),"\n",(0,t.jsxs)(s.li,{children:["Issue 705 TODO (Owner: Runtime Core Maintainers): What canonical ",(0,t.jsx)(s.code,{children:"ControlIntent"})," naming scheme should be recommended?"]}),"\n",(0,t.jsx)(s.li,{children:"Issue 705 TODO (Owner: Docs Maintainers): Where should controls docs sit in the Docusaurus sidebar hierarchy?"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Issue 705 follow-up (Owner: Shell Maintainers): Integrate ",(0,t.jsx)(s.code,{children:"@idle-engine/controls"})," into downstream shells."]}),"\n",(0,t.jsxs)(s.li,{children:["Issue 705 follow-up (Owner: Content Team): Add a sample control scheme to ",(0,t.jsx)(s.code,{children:"packages/content-sample"}),"."]}),"\n",(0,t.jsx)(s.li,{children:"Issue 705 follow-up (Owner: Tooling Team): Consider a CLI validator for control schemes."}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"15-references",children:"15. References"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/705",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/705"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hansjm10/Idle-Game-Engine/issues/706",children:"https://github.com/hansjm10/Idle-Game-Engine/issues/706"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"docs/design-document-template.md"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"docs/runtime-command-queue-design.md:19"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"docs/index.md:22"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:18"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:77"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command.ts:107"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:18"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.ts:93"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/command-queue.test.ts:45"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/automation-system.ts:862"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/core/src/index.ts:971"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"packages/docs/sidebars.ts:15"})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Issue 705"}),": The GitHub issue requesting a controls contract package for the Idle Engine."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"ControlAction"}),": Issue 705 action definition that maps to a runtime command payload."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"ControlBinding"}),": Issue 705 binding that links an intent to a control action."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"ControlScheme"}),": Issue 705 collection of actions and bindings for a shell."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"ControlEvent"}),": Issue 705 normalized input intent emitted by a shell."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"ControlContext"}),": Issue 705 timing context for deterministic command stamping."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Date"}),(0,t.jsx)(s.th,{children:"Author"}),(0,t.jsx)(s.th,{children:"Change Summary"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"2025-12-30"}),(0,t.jsx)(s.td,{children:"Codex (AI)"}),(0,t.jsx)(s.td,{children:"Issue 705 initial design doc draft"})]})})]})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},7678:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>c});var i=n(9430);const t={},d=i.createContext(t);function r(e){const s=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(d.Provider,{value:s},e.children)}}}]);