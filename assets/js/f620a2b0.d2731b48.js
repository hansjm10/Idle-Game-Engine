"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[3974],{7678:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var r=s(9430);const i={},o=r.createContext(i);function t(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(o.Provider,{value:n},e.children)}},9254:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"build-resource-generator-upgrade-ui-components-design","title":"Build Resource/Generator/Upgrade UI Components","description":"Document Control","source":"@site/../../docs/build-resource-generator-upgrade-ui-components-design.md","sourceDirName":".","slug":"/build-resource-generator-upgrade-ui-components-design","permalink":"/Idle-Game-Engine/build-resource-generator-upgrade-ui-components-design","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/build-resource-generator-upgrade-ui-components-design.md","tags":[],"version":"current","frontMatter":{}}');var i=s(5270),o=s(7678);const t={},a="Build Resource/Generator/Upgrade UI Components",l={},d=[{value:"Document Control",id:"document-control",level:2},{value:"1. Summary",id:"1-summary",level:2},{value:"2. Context &amp; Problem Statement",id:"2-context--problem-statement",level:2},{value:"3. Goals &amp; Non-Goals",id:"3-goals--non-goals",level:2},{value:"4. Stakeholders, Agents &amp; Impacted Surfaces",id:"4-stakeholders-agents--impacted-surfaces",level:2},{value:"5. Current State",id:"5-current-state",level:2},{value:"6. Proposed Solution",id:"6-proposed-solution",level:2},{value:"6.1 Architecture Overview",id:"61-architecture-overview",level:3},{value:"6.2 Detailed Design",id:"62-detailed-design",level:3},{value:"Field Sourcing",id:"field-sourcing",level:4},{value:"Example Snapshot &amp; Command Flow",id:"example-snapshot--command-flow",level:4},{value:"Cost Calculation Formulas (Existing Implementation)",id:"cost-calculation-formulas-existing-implementation",level:4},{value:"Example Snapshot &amp; Command Flow",id:"example-snapshot--command-flow-1",level:4},{value:"Failure &amp; Mismatch Handling",id:"failure--mismatch-handling",level:4},{value:"Upgrade Purchase Contract",id:"upgrade-purchase-contract",level:4},{value:"6.3 Operational Considerations",id:"63-operational-considerations",level:3},{value:"7. Work Breakdown &amp; Delivery Plan",id:"7-work-breakdown--delivery-plan",level:2},{value:"7.1 Issue Map",id:"71-issue-map",level:3},{value:"7.2 Milestones",id:"72-milestones",level:3},{value:"7.3 Coordination Notes",id:"73-coordination-notes",level:3},{value:"8. Agent Guidance &amp; Guardrails",id:"8-agent-guidance--guardrails",level:2},{value:"9. Alternatives Considered",id:"9-alternatives-considered",level:2},{value:"10. Testing &amp; Validation Plan",id:"10-testing--validation-plan",level:2},{value:"11. Risks &amp; Mitigations",id:"11-risks--mitigations",level:2},{value:"12. Rollout Plan",id:"12-rollout-plan",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. Follow-Up Work",id:"14-follow-up-work",level:2},{value:"15. References",id:"15-references",level:2},{value:"Appendix A \u2014 Glossary",id:"appendix-a--glossary",level:2},{value:"Appendix B \u2014 Change Log",id:"appendix-b--change-log",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"build-resourcegeneratorupgrade-ui-components",children:"Build Resource/Generator/Upgrade UI Components"})}),"\n",(0,i.jsx)(n.h2,{id:"document-control",children:"Document Control"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Title"}),": Build resource/generator/upgrade UI components"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Authors"}),": Idle Engine Design-Authoring Agent (Autonomous Delivery)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reviewers"}),": Shell UX Maintainers (Presentation Shell Workstream); Runtime Core Maintainers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status"}),": Draft"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Last Updated"}),": 2025-10-31"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Related Issues"}),": Idle-Game-Engine#18"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Execution Mode"}),": AI-led"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"1-summary",children:"1. Summary"}),"\n",(0,i.jsx)(n.p,{children:"The progression UI initiative replaces the placeholder shell with production-ready progression surfaces by extending worker snapshots, surfacing generator and upgrade contracts, and composing accessible React components that dispatch deterministic commands, enabling players and AI automation to interact with the Idle Engine loop end to end."}),"\n",(0,i.jsx)(n.h2,{id:"2-context--problem-statement",children:"2. Context & Problem Statement"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Background"}),": The current shell renders only runtime ticks and diagnostics (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/App.tsx:32"}),") while core systems already model resources and generator purchases (",(0,i.jsx)(n.code,{children:"packages/core/src/resource-command-handlers.ts:54"}),") and sample packs describe generators/resources (",(0,i.jsx)(n.code,{children:"packages/content-sample/src/generated/@idle-engine/sample-pack.generated.ts:90"}),"); existing design guidance mandates default UI kits for resources and upgrades (",(0,i.jsx)(n.code,{children:"docs/idle-engine-design.md"})," \xa76.2)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": There is no way to visualise or interact with resources, generators, or upgrades in the shell, blocking the progression UI milestone and contradicting Presentation Phase goals (",(0,i.jsx)(n.code,{children:"docs/implementation-plan.md:56"}),"); ",(0,i.jsx)(n.code,{children:"ShellRuntimeState"})," omits resource payloads (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/shell-state.types.ts:16"}),") and the worker protocol publishes no progression detail (",(0,i.jsx)(n.code,{children:"@idle-engine/runtime-bridge-contracts"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Forces"}),": Progression UI work must preserve deterministic worker messaging (",(0,i.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:1034"}),"), obey worker-bridge safety rails (",(0,i.jsx)(n.code,{children:"docs/runtime-react-worker-bridge-design.md:160"}),"), remain accessible for upcoming smoke tests (",(0,i.jsx)(n.code,{children:"docs/accessibility-smoke-tests-design.md:57"}),"), and align with AI board workflows (",(0,i.jsx)(n.code,{children:"docs/project-board-workflow.md:21"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"3-goals--non-goals",children:"3. Goals & Non-Goals"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goals"}),": Deliver worker snapshots and shell view-models for the progression UI; render accessible resource dashboards, generator lists, and upgrade modals; enable command dispatch (",(0,i.jsx)(n.code,{children:"PURCHASE_GENERATOR"}),", planned upgrade purchase) with optimistic feedback; instrument telemetry for AI observability."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Non-Goals"}),": Building social or guild UI (tracked separately); overhauling core economics or content schema; shipping art direction beyond utilitarian layout for this progression UI milestone."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"4-stakeholders-agents--impacted-surfaces",children:"4. Stakeholders, Agents & Impacted Surfaces"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Primary Stakeholders"}),": Presentation Shell maintainers; Runtime Core systems leads; Content authoring team enabling the progression UI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agent Roles"}),": Design Authoring Agent (this document) sets guardrails; Runtime Protocol Agent updates worker payloads; Shell UI Implementation Agent builds components; Progression QA & A11y Agent validates progression UI flows."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Affected Packages/Services"}),": ",(0,i.jsx)(n.code,{children:"packages/core"}),"; ",(0,i.jsx)(n.code,{children:"packages/shell-web"}),"; ",(0,i.jsx)(n.code,{children:"packages/content-sample"}),"; ",(0,i.jsx)(n.code,{children:"docs/"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compatibility Considerations"}),": Bump ",(0,i.jsx)(n.code,{children:"WORKER_MESSAGE_SCHEMA_VERSION"})," (",(0,i.jsx)(n.code,{children:"@idle-engine/runtime-bridge-contracts"}),") with backward opt-out; rely on the ",(0,i.jsx)(n.code,{children:"SCHEMA_VERSION_MISMATCH"})," guard in ",(0,i.jsx)(n.code,{children:"packages/shell-web/src/runtime.worker.ts:818"})," and the bridge-side filter (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/worker-bridge.ts:223"}),") to block incompatible envelopes while logging telemetry; surface a fatal notification in the shell and block worker-driven progression UI until the bundles are rebuilt (the inline runtime remains feature-flag gated); maintain command contracts from ",(0,i.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:1034"}),"; ensure serialized saves remain forward-compatible."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"5-current-state",children:"5. Current State"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Shell shows only tick count and event inspector (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/App.tsx:32"}),"), blocking progression UI usage."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ShellState"})," lacks resource/generator fields (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/shell-state.types.ts:16"}),"), so hooks cannot consume progression data."]}),"\n",(0,i.jsxs)(n.li,{children:["Worker bridge proxies state and commands but serializes only events and backpressure (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/worker-bridge.ts:672"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Runtime exposes generator purchase handlers without UI integration (",(0,i.jsx)(n.code,{children:"packages/core/src/resource-command-handlers.ts:54"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Sample content already defines resources/generators for the progression UI to visualise (",(0,i.jsx)(n.code,{children:"packages/content-sample/src/generated/@idle-engine/sample-pack.generated.ts:90"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Project plan requires rendering resource panels and upgrade modals in this phase (",(0,i.jsx)(n.code,{children:"docs/implementation-plan.md:56"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"6-proposed-solution",children:"6. Proposed Solution"}),"\n",(0,i.jsx)(n.h3,{id:"61-architecture-overview",children:"6.1 Architecture Overview"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Narrative"}),": Extend runtime snapshots with a consolidated ",(0,i.jsx)(n.code,{children:"ProgressionSnapshot"})," (resources, generators, upgrades) inside the worker; ",(0,i.jsx)(n.code,{children:"ShellStateProvider"})," consumes this snapshot, derives memoized view-models, and hands them to new React components that drive the progression UI while dispatching commands back through the existing bridge."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Diagram"}),":","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"+---------------------------+        +-----------------------------+\n| React Shell Components    |        | Worker Runtime              |\n| - ResourceDashboard       |<------\x3e| - ProgressionSnapshot pump  |\n| - GeneratorPanel          |        | - Command handlers          |\n| - UpgradeModal            |-------\x3e| - Purchase/upgrade evaluators|\n+---------------------------+        +-----------------------------+\n           ^                                         |\n           | telemetry + tests                       v\n+---------------------------+        +-----------------------------+\n| AI Validation Pipelines   |        | Content Sample Extensions   |\n+---------------------------+        +-----------------------------+\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"62-detailed-design",children:"6.2 Detailed Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Runtime Changes"}),": Extend ",(0,i.jsx)(n.code,{children:"RuntimeStatePayload"})," with frozen resource/generator/upgrade arrays derived from ",(0,i.jsx)(n.code,{children:"SerializedResourceState"})," and generator indices inside the worker; add upgrade ownership scaffolding (TODO owner: Runtime Protocol Agent) while keeping progression UI data deterministic and double-buffered."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data & Schemas"}),": Introduce ",(0,i.jsx)(n.code,{children:"ProgressionSnapshot"})," TypeScript types exported from ",(0,i.jsx)(n.code,{children:"@idle-engine/core"})," for the progression UI; align generator cost curves with sample pack schema (",(0,i.jsx)(n.code,{children:"packages/content-sample/src/generated/@idle-engine/sample-pack.generated.ts:114"}),") and reserve upgrade schema wiring as TODO (Content Systems owner)."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"field-sourcing",children:"Field Sourcing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Resources"}),": Publish ",(0,i.jsx)(n.code,{children:"resources"})," by reshaping ",(0,i.jsx)(n.code,{children:"SerializedResourceState"})," fields (",(0,i.jsx)(n.code,{children:"packages/core/src/resource-state.ts:119"}),") into presentation-friendly records. Carry forward ",(0,i.jsx)(n.code,{children:"unlocked"}),"/",(0,i.jsx)(n.code,{children:"visible"})," flags so UI can respect gating, compute ",(0,i.jsx)(n.code,{children:"perSecond"})," as ",(0,i.jsx)(n.code,{children:"resourceState.getNetPerSecond(index)"}),", and compute ",(0,i.jsx)(n.code,{children:"perTick"})," as ",(0,i.jsx)(n.code,{children:"perSecond * (stepDurationMs / 1000)"}),", where ",(0,i.jsx)(n.code,{children:"stepDurationMs"})," is the step size provided when constructing the worker runtime (the worker currently defaults this to 100\u202fms)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Generators"}),": Hydrate generator rows from the authoritative progression systems (existing handlers in ",(0,i.jsx)(n.code,{children:"packages/core/src/resource-command-handlers.ts:54"}),"). Instead of collapsing pricing, surface the full ",(0,i.jsx)(n.code,{children:"GeneratorPurchaseQuote.costs"})," array (resource ID + amount) so UI remains accurate for future multi-resource definitions. Expose ",(0,i.jsx)(n.code,{children:"nextPurchaseReadyAtStep"})," as ",(0,i.jsx)(n.code,{children:"currentStep + 1"})," when no cooldown applies, mirroring the command queue\u2019s deterministic \u201cnext tick\u201d execution window."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Upgrades"}),": Surface upgrade visibility, availability, and multi-resource pricing from the upgrade progression system once the TODO scaffolding lands. While stubbing in the interim, keep snapshot entries aligned with ",(0,i.jsx)(n.code,{children:"status: 'locked' | 'available' | 'purchased'"}),", attach ",(0,i.jsx)(n.code,{children:"costs"})," arrays when pricing exists, carry a ",(0,i.jsx)(n.code,{children:"visible"})," flag, and gate any ",(0,i.jsx)(n.code,{children:"available"})," state behind real economics shipped from ",(0,i.jsx)(n.code,{children:"packages/content-sample"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"APIs & Contracts"}),": Add ",(0,i.jsx)(n.code,{children:"PURCHASE_UPGRADE"})," command type (TODO owner: Runtime Protocol Agent) mirroring ",(0,i.jsx)(n.code,{children:"PurchaseGeneratorPayload"})," (",(0,i.jsx)(n.code,{children:"packages/core/src/command.ts:121"}),"); expose read-only view helpers on the shell bridge for the progression UI; guarantee schema version negotiation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tooling & Automation"}),": Update Vitest suites for worker and shell modules (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/runtime.worker.test.ts"}),") to assert new payloads and rejection flows; add component unit tests for the progression UI using React Testing Library; ensure ",(0,i.jsx)(n.code,{children:"pnpm test --filter shell-web"})," remains primary validation (",(0,i.jsx)(n.code,{children:"docs/runtime-react-worker-bridge-design.md:164"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Migration"}),": Replace ",(0,i.jsx)(n.code,{children:"isVisible"}),"/",(0,i.jsx)(n.code,{children:"isUnlocked"})," with ",(0,i.jsx)(n.code,{children:"visible"}),"/",(0,i.jsx)(n.code,{children:"unlocked"})," in progression view consumers (resources, generators, upgrades, achievements, automations, transforms, prestige layers)."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"example-snapshot--command-flow",children:"Example Snapshot & Command Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type ProgressionSnapshot = Readonly<{\n  step: number;\n  publishedAt: number;\n  resources: readonly ResourceView[];\n  generators: readonly GeneratorView[];\n  upgrades: readonly UpgradeView[];\n}>;\n\ntype ResourceView = Readonly<{\n  id: string;\n  displayName: string;\n  amount: number;\n  unlocked: boolean;\n  visible: boolean;\n  capacity?: number;\n  perSecond: number;\n  perTick: number;\n}>;\n\ntype GeneratorCostView = Readonly<{\n  resourceId: string;\n  amount: number;\n  canAfford: boolean;\n  currentAmount?: number;\n}>;\n\ntype GeneratorView = Readonly<{\n  id: string;\n  displayName: string;\n  owned: number;\n  enabled: boolean;\n  unlocked: boolean;\n  visible: boolean;\n  unlockHint?: string;\n  costs: readonly GeneratorCostView[];\n  canAfford: boolean;\n  produces: readonly { resourceId: string; rate: number }[];\n  consumes: readonly { resourceId: string; rate: number }[];\n  nextPurchaseReadyAtStep: number;\n}>;\n\ntype UpgradeCostView = Readonly<{\n  resourceId: string;\n  amount: number;\n  canAfford: boolean;\n  currentAmount?: number;\n}>;\n\ntype UpgradeView = Readonly<{\n  id: string;\n  displayName: string;\n  status: 'locked' | 'available' | 'purchased';\n  canAfford: boolean;\n  costs?: readonly UpgradeCostView[];\n  unlockHint?: string;\n  visible: boolean;\n}>;\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "step": 420,\n  "publishedAt": 1730395539123,\n  "resources": [\n    {\n      "id": "sample-pack.energy",\n      "displayName": "Energy",\n      "amount": 125.5,\n      "unlocked": true,\n      "visible": true,\n      "capacity": 250,\n      "perSecond": 5.5,\n      "perTick": 0.55\n    },\n    {\n      "id": "sample-pack.crystal",\n      "displayName": "Crystal",\n      "amount": 4,\n      "unlocked": true,\n      "visible": true,\n      "perSecond": 0.25,\n      "perTick": 0.025\n    }\n  ],\n  "generators": [\n    {\n      "id": "sample-pack.reactor",\n      "displayName": "Reactor",\n      "owned": 6,\n      "unlocked": true,\n      "visible": true,\n      "costs": [\n        {\n          "resourceId": "sample-pack.energy",\n          "amount": 23.13,\n          "canAfford": true,\n          "currentAmount": 125.5\n        }\n      ],\n      "canAfford": true,\n      "produces": [\n        { "resourceId": "sample-pack.energy", "rate": 1 }\n      ],\n      "consumes": [],\n      "nextPurchaseReadyAtStep": 421\n    },\n    {\n      "id": "sample-pack.harvester",\n      "displayName": "Crystal Harvester",\n      "owned": 1,\n      "unlocked": true,\n      "visible": true,\n      "costs": [\n        {\n          "resourceId": "sample-pack.energy",\n          "amount": 30,\n          "canAfford": true,\n          "currentAmount": 125.5\n        }\n      ],\n      "canAfford": true,\n      "produces": [\n        { "resourceId": "sample-pack.crystal", "rate": 0.25 }\n      ],\n      "consumes": [\n        { "resourceId": "sample-pack.energy", "rate": 0.5 }\n      ],\n      "nextPurchaseReadyAtStep": 421\n    }\n  ],\n  "upgrades": [\n    {\n      "id": "sample-pack.harvester-efficiency",\n      "displayName": "Harvester Efficiency",\n      "status": "locked",\n      "canAfford": true,\n      "unlockHint": "Accumulate 20 crystal to reveal this upgrade.",\n      "visible": false\n    },\n    {\n      "id": "sample-pack.reactor-insulation",\n      "displayName": "Reactor Insulation",\n      "status": "available",\n      "canAfford": true,\n      "costs": [\n        {\n          "resourceId": "sample-pack.energy",\n          "amount": 75,\n          "canAfford": true,\n          "currentAmount": 125.5\n        }\n      ],\n      "visible": true\n    },\n    {\n      "id": "sample-pack.reactor-overclock",\n      "displayName": "Reactor Overclock",\n      "status": "purchased",\n      "canAfford": true,\n      "visible": true\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Upgrades in the snapshot illustration use placeholder IDs; update them once ",(0,i.jsx)(n.code,{children:"packages/content-sample"})," adds real upgrade definitions alongside the generator content. The example covers locked, available, and purchased states so UI consumers can map every variant."]}),"\n",(0,i.jsx)(n.h4,{id:"cost-calculation-formulas-existing-implementation",children:"Cost Calculation Formulas (Existing Implementation)"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": This subsection documents the ",(0,i.jsx)(n.strong,{children:"existing cost calculation implementation"})," as shipped in PR #303 (",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"}),"). This is retroactive documentation of production code."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Generator Costs"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"Generator purchase costs scale with the number already owned. The cost for purchasing a generator at a specific level is calculated as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"cost = baseCost \xd7 evaluateCostFormula(costCurve, purchaseIndex)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Where:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"baseCost"})," is the base cost defined in the generator's ",(0,i.jsx)(n.code,{children:"purchase.baseCost"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"costCurve"})," is the numeric formula from ",(0,i.jsx)(n.code,{children:"purchase.costCurve"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"purchaseIndex"})," is the current owned count (the level being purchased)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For bulk purchases, costs are summed individually:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"for (let offset = 0; offset < count; offset++) {\n  const purchaseLevel = owned + offset;\n  totalCost += baseCost \xd7 evaluateCostFormula(costCurve, purchaseLevel);\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),": If a generator has ",(0,i.jsx)(n.code,{children:"baseCost: 10"})," and ",(0,i.jsx)(n.code,{children:"costCurve: { kind: 'exponential', base: 1, growth: 1.15 }"}),", the 5th purchase (when owned=5) costs ",(0,i.jsx)(n.code,{children:"10 \xd7 1.15^5 = 20.11"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Upgrade Costs"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Upgrade costs are calculated based on the current purchase count. For ",(0,i.jsx)(n.strong,{children:"non-repeatable upgrades"})," (one-time purchases):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"cost = baseCost \xd7 evaluateCostFormula(costCurve, purchaseLevel)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.strong,{children:"repeatable upgrades"})," (upgrades with ",(0,i.jsx)(n.code,{children:"repeatable"})," configuration), an additional cost multiplier applies:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"amount = baseCost \xd7 evaluateCostFormula(costCurve, purchaseLevel) \xd7 evaluateCostFormula(repeatableCostCurve, purchaseLevel)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Where:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"baseCost"})," is from ",(0,i.jsx)(n.code,{children:"cost.baseCost"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"costCurve"})," is from ",(0,i.jsx)(n.code,{children:"cost.costCurve"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"purchaseLevel"})," is the current ",(0,i.jsx)(n.code,{children:"purchases"})," count"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"repeatableCostCurve"})," is from ",(0,i.jsx)(n.code,{children:"repeatable.costCurve"})," (if upgrade is repeatable)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This composition allows both the base cost and the repeatable multiplier to scale independently with purchase count."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),": A repeatable upgrade with ",(0,i.jsx)(n.code,{children:"baseCost: 100"}),", ",(0,i.jsx)(n.code,{children:"costCurve: { kind: 'linear', base: 1, slope: 0.1 }"}),", and ",(0,i.jsx)(n.code,{children:"repeatable.costCurve: { kind: 'exponential', base: 1, growth: 1.2 }"})," would cost at purchase level 3:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"100 \xd7 (1 + 0.1\xd73) \xd7 1.2^3 = 100 \xd7 1.3 \xd7 1.728 = 224.64\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Repeatable Upgrade Status"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Repeatable upgrades remain ",(0,i.jsx)(n.code,{children:"status: 'available'"})," after purchase as long as ",(0,i.jsx)(n.code,{children:"purchases < maxPurchases"}),". If ",(0,i.jsx)(n.code,{children:"maxPurchases"})," is undefined or ",(0,i.jsx)(n.code,{children:"Infinity"}),", the upgrade stays perpetually available. This allows upgrades to be purchased multiple times with escalating costs."]}),"\n",(0,i.jsxs)(n.p,{children:["Tested in ",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.test.ts"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Implementation Reference"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Generator cost calculation: ",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["Upgrade cost calculation: ",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["Bulk purchase accumulation: ",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["Repeatable upgrade test: ",(0,i.jsx)(n.code,{children:"packages/core/src/progression-coordinator.test.ts"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"example-snapshot--command-flow-1",children:"Example Snapshot & Command Flow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:['Player clicks "Buy Reactor" in ',(0,i.jsx)(n.code,{children:"GeneratorPanel"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Component calls ",(0,i.jsx)(n.code,{children:"bridge.sendCommand('PURCHASE_GENERATOR', { generatorId: 'sample-pack.reactor', count: 1 })"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Worker validates funds, applies the purchase through ",(0,i.jsx)(n.code,{children:"resource-command-handlers.ts"}),", emits telemetry, and republishes the snapshot at ",(0,i.jsx)(n.code,{children:"step + 1"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ShellStateProvider"})," receives the updated snapshot, recomputes memoized selectors, and re-renders the dashboard with optimistic feedback already reflected because the component staged the delta while awaiting confirmation."]}),"\n",(0,i.jsxs)(n.li,{children:["Analytics facade logs ",(0,i.jsx)(n.code,{children:"GeneratorPurchaseConfirmed"})," with the request latency once the worker response arrives."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"failure--mismatch-handling",children:"Failure & Mismatch Handling"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If the worker rejects a purchase (insufficient currency, invalid generator, or upgrade lock), the snapshot emitted on the next tick omits the optimistic delta. ",(0,i.jsx)(n.code,{children:"ShellStateProvider"})," rolls back the pending state and surfaces a toast summarising the denial while logging ",(0,i.jsx)(n.code,{children:"GeneratorPurchaseDenied"})," / ",(0,i.jsx)(n.code,{children:"UpgradePurchaseDenied"})," through ",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/shell-analytics.ts:1"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["When the bridge receives an ",(0,i.jsx)(n.code,{children:"ERROR"})," envelope with a ",(0,i.jsx)(n.code,{children:"requestId"}),", it cancels the pending optimistic entry, emits ",(0,i.jsx)(n.code,{children:"ProgressionUiCommandError"}),", and replays the authoritative snapshot once available (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/worker-bridge.ts:246"}),"). Components must treat the rollback as deterministic and keep focus in place for accessibility."]}),"\n",(0,i.jsxs)(n.li,{children:["Schema mismatches still hit the guardrail at ",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/worker-bridge.ts:223"}),"; emit ",(0,i.jsx)(n.code,{children:"ProgressionUiSchemaMismatch"}),", show the fatal notification described in \xa74, and block progression UI interactions until the refreshed worker reports READY."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"upgrade-purchase-contract",children:"Upgrade Purchase Contract"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Introduce ",(0,i.jsx)(n.code,{children:"RUNTIME_COMMAND_TYPES.PURCHASE_UPGRADE"})," in ",(0,i.jsx)(n.code,{children:"packages/core/src/command.ts"}),", pairing it with a ",(0,i.jsx)(n.code,{children:"PurchaseUpgradePayload"})," containing ",(0,i.jsx)(n.code,{children:"upgradeId"})," and optional ",(0,i.jsx)(n.code,{children:"metadata"})," for future side effects. The shell bridge stamps the command with ",(0,i.jsx)(n.code,{children:"CommandPriority.PLAYER"}),", matching ",(0,i.jsx)(n.code,{children:"PURCHASE_GENERATOR"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Worker-side handlers mirror generator purchases: validate availability, evaluate resource costs using the same currency resolver, and, on success, emit an updated ",(0,i.jsx)(n.code,{children:"ProgressionSnapshot"})," alongside telemetry (",(0,i.jsx)(n.code,{children:"UpgradePurchaseConfirmed"})," / ",(0,i.jsx)(n.code,{children:"UpgradePurchaseDenied"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Extend ",(0,i.jsx)(n.code,{children:"ShellStateProvider"})," optimistic handling to stage upgrade status as ",(0,i.jsx)(n.code,{children:"pending"})," until the next snapshot arrives, ensuring UI feedback is consistent with generator purchases."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"63-operational-considerations",children:"6.3 Operational Considerations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deployment"}),": Progression UI is enabled by default. Maintain schema guardrails and ensure the a11y and component test suites pass cleanly in CI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Telemetry & Observability"}),": Emit shell analytics events through existing facade (",(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/shell-analytics.ts:1"}),") for resource purchases and upgrade actions; fire a ",(0,i.jsx)(n.code,{children:"ProgressionUiSchemaMismatch"})," event when the bridge filters worker envelopes so rollout monitors highlight version skew; gauge adoption via weekly reports."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security & Compliance"}),": Ensure no PII in snapshots; honour command authorization policies during progression UI interactions; maintain worker isolation per security guidelines."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"7-work-breakdown--delivery-plan",children:"7. Work Breakdown & Delivery Plan"}),"\n",(0,i.jsx)(n.h3,{id:"71-issue-map",children:"7.1 Issue Map"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Issue Title"}),(0,i.jsx)(n.th,{children:"Scope Summary"}),(0,i.jsx)(n.th,{children:"Proposed Assignee/Agent"}),(0,i.jsx)(n.th,{children:"Dependencies"}),(0,i.jsx)(n.th,{children:"Acceptance Criteria"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"feat(core): emit progression snapshot"}),(0,i.jsxs)(n.td,{children:["Add ",(0,i.jsx)(n.code,{children:"ProgressionSnapshot"})," export, worker serialization, schema bump for the progression UI"]}),(0,i.jsx)(n.td,{children:"Runtime Protocol Agent"}),(0,i.jsx)(n.td,{children:"Telemetry scaffolding ready"}),(0,i.jsx)(n.td,{children:"Vitest worker-suite validates snapshot; schema version doc updated"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"feat(shell-web): integrate progression state"}),(0,i.jsxs)(n.td,{children:["Extend ",(0,i.jsx)(n.code,{children:"ShellStateProvider"}),", selectors, context for the progression UI"]}),(0,i.jsx)(n.td,{children:"Shell UI Implementation Agent"}),(0,i.jsx)(n.td,{children:"Progression snapshot merged"}),(0,i.jsx)(n.td,{children:"Shell hook tests prove memoization; bridge still passes diagnostics tests"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"feat(shell-web): resource dashboard UI"}),(0,i.jsx)(n.td,{children:"Render resource list with capacities, rates, accessibility hooks"}),(0,i.jsx)(n.td,{children:"Shell UI Implementation Agent"}),(0,i.jsx)(n.td,{children:"Progression hook available"}),(0,i.jsxs)(n.td,{children:["Component tests cover locked/unlocked states; passes ",(0,i.jsx)(n.code,{children:"pnpm test --filter shell-web"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"feat(shell-web): generator & upgrade interactions"}),(0,i.jsx)(n.td,{children:"Create generator cards, command dispatch, upgrade modal"}),(0,i.jsx)(n.td,{children:"Shell UI Implementation Agent"}),(0,i.jsx)(n.td,{children:"Dashboard UI merged"}),(0,i.jsx)(n.td,{children:"Commands fire with optimistic updates; rejected purchases revert UI with toast + telemetry assertions; QA sign-off captured"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"docs/content-sample: enrich progression data"}),(0,i.jsx)(n.td,{children:"Backfill generators, upgrades, localization for the progression UI showcase"}),(0,i.jsx)(n.td,{children:"Content Data Agent"}),(0,i.jsx)(n.td,{children:"Progression snapshot contract final"}),(0,i.jsx)(n.td,{children:"Content tests regenerate artifacts; upgrade economics and unlocks ship before flag enablement; docs note new content"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"72-milestones",children:"7.2 Milestones"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Phase 1"}),": Finalize progression snapshot contract, raise schema version, land worker tests; exit when progression UI data flows to shell."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Phase 2"}),": Ship resource dashboard and generator cards behind feature flag; exit when manual smoke confirms deterministic updates."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Phase 3"}),": Enable upgrade modal, telemetry, and accessibility validation; exit when Playwright smoke runs clean."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"73-coordination-notes",children:"7.3 Coordination Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Hand-off Package"}),": Provide agents with snapshot type definitions, sample content diffs, and schema bump notes for the progression UI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Communication Cadence"}),": Daily async status updates via project board comments; formal review checkpoints at milestone boundaries; escalate blockers through Issue #18 thread."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"8-agent-guidance--guardrails",children:"8. Agent Guidance & Guardrails"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Context Packets"}),": Agents must preload ",(0,i.jsx)(n.code,{children:"docs/idle-engine-design.md"}),", ",(0,i.jsx)(n.code,{children:"docs/runtime-command-queue-design.md"}),", and relevant source files before acting on the progression UI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Prompting & Constraints"}),": Use command templates referencing ",(0,i.jsx)(n.code,{children:"bridge.sendCommand"})," patterns; follow naming conventions and commit style while focusing on the progression UI."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Safety Rails"}),": Do not bypass worker bridge isolation (",(0,i.jsx)(n.code,{children:"docs/runtime-react-worker-bridge-design.md:160"}),"); avoid mutating serialized state; keep acceptance suites green (no feature flag gating)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation Hooks"}),": Run ",(0,i.jsx)(n.code,{children:"pnpm lint"}),", ",(0,i.jsx)(n.code,{children:"pnpm test --filter shell-web"}),", and ",(0,i.jsx)(n.code,{children:"pnpm test:a11y"})," after UI modifications; document outputs in issue comments."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"9-alternatives-considered",children:"9. Alternatives Considered"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Rely on ad hoc shell-side calculations without worker updates: rejected because it diverges from determinism and cannot reflect authoritative generator costs for the progression UI."}),"\n",(0,i.jsxs)(n.li,{children:["Build a separate standalone UI prototype: rejected as it duplicates bridge logic and violates deployment plan tied to ",(0,i.jsx)(n.code,{children:"packages/shell-web"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"10-testing--validation-plan",children:"10. Testing & Validation Plan"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unit / Integration"}),": Expand worker serialization tests and React component snapshots; ensure progression UI hooks handle locked/unlocked transitions."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": Profile resource list rendering with 100+ nodes; ensure updates stay below 16\u202fms using memoization."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tooling / A11y"}),": Re-run Playwright smoke once the progression UI ships (",(0,i.jsx)(n.code,{children:"docs/accessibility-smoke-tests-design.md:57"}),"); add axe assertions for modal focus traps."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Release Gates"}),": Block feature-flag promotion until ",(0,i.jsx)(n.code,{children:"pnpm lint"}),", ",(0,i.jsx)(n.code,{children:"pnpm test --filter core"}),", ",(0,i.jsx)(n.code,{children:"pnpm test --filter shell-web"}),", and ",(0,i.jsx)(n.code,{children:"pnpm test:a11y"})," complete without flake; record a manual scenario covering first generator purchase and upgrade reveal to validate optimistic UI against the example snapshot and confirm ",(0,i.jsx)(n.code,{children:"ProgressionUiSchemaMismatch"})," remains absent."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"11-risks--mitigations",children:"11. Risks & Mitigations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Schema drift between worker and shell for the progression UI; mitigate via shared types and compile-time checks."}),"\n",(0,i.jsx)(n.li,{children:"Feature flag left disabled in production leading to dead code; mitigate by tracking rollout issue and gating removal in Follow-Up Work."}),"\n",(0,i.jsx)(n.li,{children:"Upgrade economics missing until content team supplies data; mitigate via the Content Systems deliverable documented in \xa713 and block flag enablement until it lands."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"12-rollout-plan",children:"12. Rollout Plan"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Milestones"}),": Enable flag in ",(0,i.jsx)(n.code,{children:"dev"})," after Phase 2 once Release Gates pass on a ",(0,i.jsx)(n.code,{children:"pnpm test --filter shell-web"})," focused run; promote to ",(0,i.jsx)(n.code,{children:"main"})," after the telemetry dashboard confirms no ",(0,i.jsx)(n.code,{children:"ProgressionUiSchemaMismatch"})," events for 72 hours; remove the flag after two stable releases and a green rerun of ",(0,i.jsx)(n.code,{children:"pnpm test:a11y"})," on the enabled build."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Migration Strategy"}),": Maintain fallback to old shell layout by gating new components; provide migration doc for any third-party shells."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Communication"}),": Announce progression UI availability in weekly status reports; update onboarding documentation post-rollout."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Content Systems (Issue #18 checkpoint): Deliver the definitive upgrade catalog and unlock sequencing before Phase 2 exits; progression flag cannot flip without this data set."}),"\n",(0,i.jsx)(n.li,{children:"UX Lead: Provide visual hierarchy guidelines and iconography requirements so GeneratorPanel/UpgradeModal align with shell patterns."}),"\n",(0,i.jsxs)(n.li,{children:["Runtime Protocol Agent: Finalise upgrade purchase command semantics and refund behaviour, then codify them in ",(0,i.jsx)(n.code,{children:"packages/core/src/command.ts"})," alongside regression tests."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"14-follow-up-work",children:"14. Follow-Up Work"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Document automation toggles and prestige integration once the progression UI stabilizes."}),"\n",(0,i.jsx)(n.li,{children:"Evaluate persistence integration so progression state survives reloads."}),"\n",(0,i.jsx)(n.li,{children:"Plan tutorial overlays leveraging new UI surfaces."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"15-references",children:"15. References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/App.tsx:32"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"packages/shell-web/src/modules/shell-state.types.ts:16"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"@idle-engine/runtime-bridge-contracts"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"packages/core/src/resource-command-handlers.ts:54"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"packages/content-sample/src/generated/@idle-engine/sample-pack.generated.ts:90"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docs/idle-engine-design.md"})," \xa76.2"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docs/implementation-plan.md:56"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docs/runtime-command-queue-design.md:1034"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docs/runtime-react-worker-bridge-design.md:160"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docs/accessibility-smoke-tests-design.md:57"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docs/project-board-workflow.md:21"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"appendix-a--glossary",children:"Appendix A \u2014 Glossary"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Progression UI"}),": The initiative delivering resource dashboards, generator cards, and upgrade modals in the shell."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Progression Snapshot"}),": Worker-emitted frozen structure capturing resources, generators, and upgrades for rendering."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ResourceDashboard"}),": Proposed React component summarizing resource amounts, capacities, and rates."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GeneratorPanel"}),": Component listing generators, ownership counts, and purchase actions."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"UpgradeModal"}),": Overlay presenting upgrade catalog entries with purchase controls and dependencies."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"appendix-b--change-log",children:"Appendix B \u2014 Change Log"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Date"}),(0,i.jsx)(n.th,{children:"Author"}),(0,i.jsx)(n.th,{children:"Change Summary"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2025-10-31"}),(0,i.jsx)(n.td,{children:"Idle Engine Design-Authoring Agent"}),(0,i.jsx)(n.td,{children:"Initial draft for progression UI components"})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);