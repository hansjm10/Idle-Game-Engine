"use strict";(globalThis.webpackChunk_idle_engine_docs=globalThis.webpackChunk_idle_engine_docs||[]).push([[4701],{6252:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"automation-authoring-guide","title":"Automation Content Authoring Guide","description":"Step-by-step guide for authoring automation definitions in content packs","source":"@site/../../docs/automation-authoring-guide.md","sourceDirName":".","slug":"/automation-authoring-guide","permalink":"/Idle-Game-Engine/automation-authoring-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/automation-authoring-guide.md","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"title":"Automation Content Authoring Guide","description":"Step-by-step guide for authoring automation definitions in content packs","sidebar_position":14}}');var t=s(5270),i=s(7678);const o={title:"Automation Content Authoring Guide",description:"Step-by-step guide for authoring automation definitions in content packs",sidebar_position:14},a="Automation Content Authoring Guide",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Automation Schema",id:"automation-schema",level:2},{value:"Required Fields",id:"required-fields",level:3},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Trigger Types",id:"trigger-types",level:2},{value:"1. Interval Trigger",id:"1-interval-trigger",level:3},{value:"2. Resource Threshold Trigger",id:"2-resource-threshold-trigger",level:3},{value:"3. Command Queue Empty Trigger",id:"3-command-queue-empty-trigger",level:3},{value:"4. Event Trigger",id:"4-event-trigger",level:3},{value:"Target Types",id:"target-types",level:2},{value:"Generator Target",id:"generator-target",level:3},{value:"Upgrade Target",id:"upgrade-target",level:3},{value:"System Target",id:"system-target",level:3},{value:"Cooldowns",id:"cooldowns",level:2},{value:"Resource Costs",id:"resource-costs",level:2},{value:"Limitations (current iteration)",id:"limitations-current-iteration",level:3},{value:"Unlock Conditions",id:"unlock-conditions",level:2},{value:"Always",id:"always",level:3},{value:"Resource Threshold",id:"resource-threshold",level:3},{value:"Compound Conditions",id:"compound-conditions",level:3},{value:"Enabled State",id:"enabled-state",level:2},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Example 1: Basic Auto-Clicker",id:"example-1-basic-auto-clicker",level:3},{value:"Example 2: Smart Upgrade Buyer",id:"example-2-smart-upgrade-buyer",level:3},{value:"Example 3: Idle Resource Collector",id:"example-3-idle-resource-collector",level:3},{value:"Example 4: Event-Driven Prestige",id:"example-4-event-driven-prestige",level:3},{value:"Validation Workflow",id:"validation-workflow",level:2},{value:"Step 1: Add automation to pack.json",id:"step-1-add-automation-to-packjson",level:3},{value:"Step 2: Validate schema",id:"step-2-validate-schema",level:3},{value:"Step 3: Test in runtime",id:"step-3-test-in-runtime",level:3},{value:"Step 4: Commit validated automation",id:"step-4-commit-validated-automation",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Start Simple",id:"1-start-simple",level:3},{value:"2. Always Use Cooldowns for Threshold/Queue-Empty Triggers",id:"2-always-use-cooldowns-for-thresholdqueue-empty-triggers",level:3},{value:"3. Disable Destructive Automations by Default",id:"3-disable-destructive-automations-by-default",level:3},{value:"4. Use Unlock Conditions to Gate Advanced Automations",id:"4-use-unlock-conditions-to-gate-advanced-automations",level:3},{value:"5. Test All Four Trigger Types",id:"5-test-all-four-trigger-types",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Automation Not Firing",id:"automation-not-firing",level:3},{value:"Automation Fires Too Frequently",id:"automation-fires-too-frequently",level:3},{value:"Automation Fires on Every Tick (Queue Empty Trigger)",id:"automation-fires-on-every-tick-queue-empty-trigger",level:3},{value:"Threshold Trigger Not Detecting Crossing",id:"threshold-trigger-not-detecting-crossing",level:3},{value:"References",id:"references",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"automation-content-authoring-guide",children:"Automation Content Authoring Guide"})}),"\n",(0,t.jsx)(n.p,{children:"This guide teaches content authors how to define automations in Idle Engine content packs. Automations enable idle gameplay by automatically triggering generators, upgrades, and system commands without manual player intervention."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Automations are defined in the ",(0,t.jsx)(n.code,{children:"automations"})," array of your ",(0,t.jsx)(n.code,{children:"pack.json"})," file. Each automation specifies:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trigger"}),": When the automation fires (interval, resource threshold, event, or queue empty)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Target"}),": What command to execute (generator, upgrade, or system)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Conditions"}),": When the automation is available (unlock conditions, enabled state)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Constraints"}),": Rate limiting and costs (cooldowns, resource costs)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"automation-schema",children:"Automation Schema"}),"\n",(0,t.jsx)(n.h3,{id:"required-fields",children:"Required Fields"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'{\n  "id": "pack-slug.automation-name",        // Unique identifier\n  "name": { "default": "Display Name" },     // Localized name\n  "description": { "default": "..." },       // Localized description\n  "targetType": "generator" | "upgrade" | "system",  // What to trigger\n  "targetId": "pack-slug.target-id",         // Target identifier (for generator/upgrade)\n  "trigger": { /* trigger definition */ },   // When to fire\n  "unlockCondition": { "kind": "always" }    // When available\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'{\n  "cooldown": 5000,                          // Milliseconds between fires\n  "resourceCost": {                          // Deduct resources when firing\n    "resourceId": "pack.resource",\n    "rate": { "kind": "constant", "value": 10 }\n  },\n  "enabledByDefault": true,                  // Initial enabled state\n  "order": 100,                              // Display order in UI\n  "systemTargetId": "system:prestige"        // System command (for targetType: "system")\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"trigger-types",children:"Trigger Types"}),"\n",(0,t.jsx)(n.h3,{id:"1-interval-trigger",children:"1. Interval Trigger"}),"\n",(0,t.jsx)(n.p,{children:"Fires periodically based on elapsed time."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": {\n    "kind": "interval",\n    "interval": { "kind": "constant", "value": 1000 }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Fires immediately on first tick (when automation is enabled and unlocked)"}),"\n",(0,t.jsx)(n.li,{children:"Subsequently fires when elapsed time \u2265 interval duration"}),"\n",(0,t.jsx)(n.li,{children:"Interval can be a numeric formula (constant, linear, exponential, etc.)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Auto-click generator every 5 seconds"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-clicker",\n  "name": { "default": "Auto Clicker" },\n  "description": { "default": "Automatically clicks the reactor every 5 seconds" },\n  "targetType": "generator",\n  "targetId": "sample-pack.reactor",\n  "trigger": {\n    "kind": "interval",\n    "interval": { "kind": "constant", "value": 5000 }\n  },\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": true,\n  "order": 1\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Auto-clicking generators at fixed intervals"}),"\n",(0,t.jsx)(n.li,{children:"Periodic resource collection"}),"\n",(0,t.jsx)(n.li,{children:"Timed upgrade purchases"}),"\n",(0,t.jsx)(n.li,{children:"Recurring prestige triggers"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"2-resource-threshold-trigger",children:"2. Resource Threshold Trigger"}),"\n",(0,t.jsx)(n.p,{children:"Fires when a resource amount crosses a threshold (transition from below to above, or vice versa)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "pack-slug.resource-id",\n    "comparator": "gte" | "gt" | "lte" | "lt",\n    "threshold": { "kind": "constant", "value": 100 }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Comparators:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"gte"}),": Greater than or equal to (\u2265)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"gt"}),": Greater than (>)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lte"}),": Less than or equal to (\u2264)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lt"}),": Less than (<)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Crossing Detection:"})}),"\n",(0,t.jsxs)(n.p,{children:["The automation fires only on threshold ",(0,t.jsx)(n.strong,{children:"crossings"})," (transitions), not continuously while the condition is met. For example, with ",(0,t.jsx)(n.code,{children:'comparator: "gte"'})," and ",(0,t.jsx)(n.code,{children:"threshold: 100"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Resource goes from 99 \u2192 100: ",(0,t.jsx)(n.strong,{children:"Fires"})," (crossing from below to above)"]}),"\n",(0,t.jsxs)(n.li,{children:["Resource stays at 100+: ",(0,t.jsx)(n.strong,{children:"Does not fire"})," (no crossing)"]}),"\n",(0,t.jsxs)(n.li,{children:["Resource goes from 100 \u2192 99 \u2192 105: ",(0,t.jsx)(n.strong,{children:"Fires"})," (crossed back above)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interaction with resourceCost:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["When a ",(0,t.jsx)(n.code,{children:"resourceCost"})," is configured, the cost is evaluated and charged at the moment the threshold crossing would fire."]}),"\n",(0,t.jsxs)(n.li,{children:["If the player cannot afford the cost at that moment, the automation does not enqueue and the crossing is ",(0,t.jsx)(n.strong,{children:"not consumed"}),". The automation will re-attempt on subsequent ticks while the threshold condition remains satisfied. Add a ",(0,t.jsx)(n.code,{children:"cooldown"})," if you want to rate\u2011limit these retries."]}),"\n",(0,t.jsx)(n.li,{children:"When the spend succeeds, the crossing is consumed (no immediate refire until the condition later falls below and crosses above again) and the command is enqueued."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Threshold with resourceCost (constant rate)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade-threshold-costed",\n  "name": { "default": "Auto Upgrade (Threshold + Cost)" },\n  "description": { "default": "Purchases an upgrade when energy crosses 50, spending 10 tokens if available" },\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-efficiency",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 50 }\n  },\n  "resourceCost": {\n    "resourceId": "sample-pack.tokens",\n    "rate": { "kind": "constant", "value": 10 }\n  },\n  "cooldown": 2000,\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": false,\n  "order": 2\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Auto-purchase upgrade when resources reach 50"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade-efficiency",\n  "name": { "default": "Auto Upgrade: Efficiency" },\n  "description": { "default": "Automatically purchases Efficiency upgrade when you have 50+ energy" },\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-efficiency",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 50 }\n  },\n  "cooldown": 2000,\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 25 }\n  },\n  "enabledByDefault": false,\n  "order": 2\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Auto-purchase upgrades when affordable"}),"\n",(0,t.jsx)(n.li,{children:"Trigger prestige at resource cap"}),"\n",(0,t.jsx)(n.li,{children:"Enable generators when resources are sufficient"}),"\n",(0,t.jsx)(n.li,{children:"Resource balancing (e.g., convert excess energy to crystals)"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"3-command-queue-empty-trigger",children:"3. Command Queue Empty Trigger"}),"\n",(0,t.jsx)(n.p,{children:"Fires when the command queue is empty (no commands pending execution)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": {\n    "kind": "commandQueueEmpty"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Fires when ",(0,t.jsx)(n.code,{children:"commandQueue.size === 0"})]}),"\n",(0,t.jsx)(n.li,{children:"Useful for low-priority automations that shouldn't interrupt other actions"}),"\n",(0,t.jsx)(n.li,{children:"Re-fires every tick while queue remains empty (use cooldown to rate limit)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Auto-collect idle resources when queue is empty"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-idle-collector",\n  "name": { "default": "Idle Collector" },\n  "description": { "default": "Collects resources when no other actions are pending" },\n  "targetType": "generator",\n  "targetId": "sample-pack.reactor",\n  "trigger": {\n    "kind": "commandQueueEmpty"\n  },\n  "cooldown": 10000,\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": true,\n  "order": 3\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Low-priority resource collection"}),"\n",(0,t.jsx)(n.li,{children:"Background maintenance tasks"}),"\n",(0,t.jsx)(n.li,{children:"Idle time optimization"}),"\n",(0,t.jsx)(n.li,{children:"Queue-sensitive automation chains"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important:"})," Without a cooldown, this fires every tick when queue is empty. Always add a cooldown for queue-empty triggers."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"4-event-trigger",children:"4. Event Trigger"}),"\n",(0,t.jsx)(n.p,{children:"Fires when a specific runtime event is published."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": {\n    "kind": "event",\n    "eventId": "pack-slug.event-id"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Listens for events published to the runtime event bus"}),"\n",(0,t.jsx)(n.li,{children:"Fires once per event occurrence"}),"\n",(0,t.jsxs)(n.li,{children:["Event must be defined in ",(0,t.jsx)(n.code,{children:"eventDefinitions"})," or base runtime events"]}),"\n",(0,t.jsxs)(n.li,{children:["When ",(0,t.jsx)(n.code,{children:"resourceCost"})," is present: the cost is evaluated and charged at fire\u2011time. If the spend fails due to insufficient resources, the pending event is retained and retried on subsequent ticks; on successful spend, the event is consumed and cooldown/last\u2011fired are updated."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Auto-purchase upgrade when milestone reached"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade-on-milestone",\n  "name": { "default": "Milestone Upgrade" },\n  "description": { "default": "Automatically purchases next upgrade when a milestone is reached" },\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-capacity",\n  "trigger": {\n    "kind": "event",\n    "eventId": "sample-pack.milestone-reached"\n  },\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": false,\n  "order": 4\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Reactive automation chains (one automation triggers another)"}),"\n",(0,t.jsx)(n.li,{children:"Milestone-based progression"}),"\n",(0,t.jsx)(n.li,{children:"Achievement-triggered rewards"}),"\n",(0,t.jsx)(n.li,{children:"Dynamic gameplay responses"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Runtime Events:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"automation:toggled"}),": Automation enabled/disabled"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resource:threshold-reached"}),": Resource crossed threshold"]}),"\n",(0,t.jsxs)(n.li,{children:["Custom events defined in content pack's ",(0,t.jsx)(n.code,{children:"eventDefinitions"})]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"target-types",children:"Target Types"}),"\n",(0,t.jsx)(n.h3,{id:"generator-target",children:"Generator Target"}),"\n",(0,t.jsx)(n.p,{children:"Triggers a generator to start producing resources."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "targetType": "generator",\n  "targetId": "pack-slug.generator-id"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Generated Command:"})," ",(0,t.jsx)(n.code,{children:"TOGGLE_GENERATOR"})," with ",(0,t.jsx)(n.code,{children:"enabled: true"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enables the generator (starts production)"}),"\n",(0,t.jsxs)(n.li,{children:["Does ",(0,t.jsx)(n.strong,{children:"not"})," toggle off (automation always enables)"]}),"\n",(0,t.jsx)(n.li,{children:"Generator must be unlocked for command to succeed"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-reactor",\n  "targetType": "generator",\n  "targetId": "sample-pack.reactor",\n  "trigger": { "kind": "interval", "interval": { "kind": "constant", "value": 3000 } },\n  "unlockCondition": { "kind": "always" }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"upgrade-target",children:"Upgrade Target"}),"\n",(0,t.jsx)(n.p,{children:"Purchases an upgrade."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "targetType": "upgrade",\n  "targetId": "pack-slug.upgrade-id"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Generated Command:"})," ",(0,t.jsx)(n.code,{children:"PURCHASE_UPGRADE"})," with ",(0,t.jsx)(n.code,{children:"{ upgradeId: targetId }"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Attempts to purchase one instance of the upgrade"}),"\n",(0,t.jsx)(n.li,{children:"Fails if upgrade is locked or player cannot afford it"}),"\n",(0,t.jsx)(n.li,{children:"Upgrade cost deducted automatically by command handler"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade-efficiency",\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-efficiency",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 50 }\n  },\n  "unlockCondition": { "kind": "always" }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"system-target",children:"System Target"}),"\n",(0,t.jsx)(n.p,{children:"Triggers a system command (e.g., prestige, save, reset)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "targetType": "system",\n  "systemTargetId": "system:prestige" | "system:save" | "system:reset"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Generated Command:"})," System-specific command type"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Executes system-level operations"}),"\n",(0,t.jsx)(n.li,{children:"System commands defined by runtime, not content pack"}),"\n",(0,t.jsx)(n.li,{children:"Use sparingly; most automation should target generators/upgrades"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-prestige",\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 1000 }\n  },\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.prestige-currency",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 1 }\n  },\n  "enabledByDefault": false,\n  "order": 10\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available System Targets:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"system:prestige"}),": Trigger prestige reset"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"system:save"}),": Force save game state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"system:reset"}),": Hard reset (rarely used in automations)"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"cooldowns",children:"Cooldowns"}),"\n",(0,t.jsx)(n.p,{children:"Cooldowns prevent automations from firing too frequently."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "cooldown": 5000  // Milliseconds\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"After firing, automation enters cooldown period"}),"\n",(0,t.jsx)(n.li,{children:"Cannot fire again until cooldown expires"}),"\n",(0,t.jsx)(n.li,{children:"Cooldown timer based on simulation steps (deterministic)"}),"\n",(0,t.jsxs)(n.li,{children:["Cooldown expiry: ",(0,t.jsx)(n.code,{children:"cooldownExpiresStep = currentStep + cooldownSteps + 1"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Interval triggers"}),": Usually don't need cooldown (interval provides rate limiting)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Threshold triggers"}),": Recommended to prevent rapid re-fires on threshold fluctuations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Queue empty triggers"}),": ",(0,t.jsx)(n.strong,{children:"Required"})," to prevent firing every tick"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event triggers"}),": Optional, depends on event frequency"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Threshold with cooldown"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade",\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-capacity",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 100 }\n  },\n  "cooldown": 5000,\n  "unlockCondition": { "kind": "always" }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Without cooldown:"})," If energy fluctuates around 100, automation fires repeatedly\n",(0,t.jsx)(n.strong,{children:"With cooldown:"})," After firing once, waits 5 seconds before checking again"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"resource-costs",children:"Resource Costs"}),"\n",(0,t.jsx)(n.p,{children:"Resource costs are deducted when an automation fires."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "resourceCost": {\n    "resourceId": "pack-slug.resource-id",\n    "rate": { "kind": "constant", "value": 10 }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Evaluation timing: cost ",(0,t.jsx)(n.code,{children:"rate"})," (a NumericFormula) is evaluated at ",(0,t.jsx)(n.strong,{children:"fire\u2011time"})," using current state."]}),"\n",(0,t.jsx)(n.li,{children:"Affordability: the engine checks if the player can afford the computed amount."}),"\n",(0,t.jsxs)(n.li,{children:["Deduction: on success, the cost is deducted ",(0,t.jsx)(n.strong,{children:"before"})," the command is enqueued; on failure, the automation does not enqueue."]}),"\n",(0,t.jsxs)(n.li,{children:["Cooldown/consumption on failure: failed spends do not update ",(0,t.jsx)(n.code,{children:"lastFired"})," or start cooldown. For event triggers, the pending event is retained; for resource\u2011threshold triggers, the false\u2192true crossing is not consumed and will retry while the condition holds (use ",(0,t.jsx)(n.code,{children:"cooldown"})," to rate\u2011limit)."]}),"\n",(0,t.jsx)(n.li,{children:"Formula support: constant formulas are supported; more advanced/multi\u2011resource costs are currently out of scope."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Auto-prestige with resource cost"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-prestige-expensive",\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "trigger": {\n    "kind": "interval",\n    "interval": { "kind": "constant", "value": 30000 }\n  },\n  "resourceCost": {\n    "resourceId": "sample-pack.prestige-tokens",\n    "rate": { "kind": "constant", "value": 1 }\n  },\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": false,\n  "order": 20\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'Premium automations (players "pay" for convenience)'}),"\n",(0,t.jsx)(n.li,{children:"Resource sinks (balance economy)"}),"\n",(0,t.jsx)(n.li,{children:"Gated automation (requires resource generation first)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," The upgrade's own cost is deducted automatically by the ",(0,t.jsx)(n.code,{children:"PURCHASE_UPGRADE"})," command handler. The ",(0,t.jsx)(n.code,{children:"resourceCost"})," field is for an ",(0,t.jsx)(n.em,{children:"additional"})," cost specific to the automation itself."]}),"\n",(0,t.jsx)(n.h3,{id:"limitations-current-iteration",children:"Limitations (current iteration)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resourceCost"})," supports a single resource with a ",(0,t.jsx)(n.code,{children:"rate"})," that is typically a constant NumericFormula. Complex formulas and multi\u2011resource/conditional costs are not yet supported."]}),"\n",(0,t.jsx)(n.li,{children:"Non\u2011finite cost evaluations (e.g., NaN/Infinity) are treated as invalid and the automation does not enqueue."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"unlock-conditions",children:"Unlock Conditions"}),"\n",(0,t.jsx)(n.p,{children:"Unlock conditions control when an automation becomes available."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "unlockCondition": {\n    "kind": "always" | "resourceThreshold" | "and" | "or" | "not"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Condition Types:"})}),"\n",(0,t.jsx)(n.h3,{id:"always",children:"Always"}),"\n",(0,t.jsx)(n.p,{children:"Automation is always unlocked."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{ "kind": "always" }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"resource-threshold",children:"Resource Threshold"}),"\n",(0,t.jsx)(n.p,{children:"Unlocks when a resource reaches a threshold."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "kind": "resourceThreshold",\n  "resourceId": "sample-pack.energy",\n  "comparator": "gte",\n  "amount": { "kind": "constant", "value": 50 }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"compound-conditions",children:"Compound Conditions"}),"\n",(0,t.jsxs)(n.p,{children:["Combine conditions with ",(0,t.jsx)(n.code,{children:"and"}),", ",(0,t.jsx)(n.code,{children:"or"}),", ",(0,t.jsx)(n.code,{children:"not"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "kind": "and",\n  "conditions": [\n    {\n      "kind": "resourceThreshold",\n      "resourceId": "sample-pack.energy",\n      "comparator": "gte",\n      "amount": { "kind": "constant", "value": 100 }\n    },\n    {\n      "kind": "resourceThreshold",\n      "resourceId": "sample-pack.crystal",\n      "comparator": "gte",\n      "amount": { "kind": "constant", "value": 10 }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Unlock Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Automations are ",(0,t.jsx)(n.strong,{children:"disabled"})," until unlocked"]}),"\n",(0,t.jsx)(n.li,{children:"Once unlocked, automations remain unlocked (persistent unlock state)"}),"\n",(0,t.jsx)(n.li,{children:"Unlock state persists in save files"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"MVP Limitation:"})," Currently only ",(0,t.jsx)(n.code,{children:'kind: "always"'})," conditions are evaluated. Full unlock condition evaluation requires integration with progression systems (deferred to future work)."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"enabled-state",children:"Enabled State"}),"\n",(0,t.jsx)(n.p,{children:"Automations can be toggled on/off by players (or other automations)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "enabledByDefault": true  // Initial state when unlocked\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enabledByDefault: true"}),": Automation starts enabled when unlocked"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enabledByDefault: false"}),": Automation starts disabled, player must enable"]}),"\n",(0,t.jsxs)(n.li,{children:["Players toggle via ",(0,t.jsx)(n.code,{children:"automation:toggled"})," command (UI-driven)"]}),"\n",(0,t.jsx)(n.li,{children:"Enabled state persists in save files"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example: Disabled by default (opt-in)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-prestige",\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "trigger": { /* ... */ },\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": false,  // Player must manually enable\n  "order": 100\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to Disable by Default:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Destructive actions (prestige, reset)"}),"\n",(0,t.jsx)(n.li,{children:"High-cost automations"}),"\n",(0,t.jsx)(n.li,{children:"Advanced/optional features"}),"\n",(0,t.jsx)(n.li,{children:"Automations requiring player strategy"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,t.jsx)(n.h3,{id:"example-1-basic-auto-clicker",children:"Example 1: Basic Auto-Clicker"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-reactor",\n  "name": {\n    "default": "Reactor Auto-Clicker",\n    "variants": {}\n  },\n  "description": {\n    "default": "Automatically enables the reactor every 3 seconds",\n    "variants": {}\n  },\n  "targetType": "generator",\n  "targetId": "sample-pack.reactor",\n  "trigger": {\n    "kind": "interval",\n    "interval": { "kind": "constant", "value": 3000 }\n  },\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": true,\n  "order": 1\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"example-2-smart-upgrade-buyer",children:"Example 2: Smart Upgrade Buyer"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-upgrade-efficiency",\n  "name": {\n    "default": "Smart Efficiency Buyer",\n    "variants": {}\n  },\n  "description": {\n    "default": "Purchases Efficiency upgrade when you reach 50 energy (max once per 5 seconds)",\n    "variants": {}\n  },\n  "targetType": "upgrade",\n  "targetId": "sample-pack.upgrade-efficiency",\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "threshold": { "kind": "constant", "value": 50 }\n  },\n  "cooldown": 5000,\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.energy",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 25 }\n  },\n  "enabledByDefault": false,\n  "order": 2\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"example-3-idle-resource-collector",children:"Example 3: Idle Resource Collector"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.idle-collector",\n  "name": {\n    "default": "Idle Resource Collector",\n    "variants": {}\n  },\n  "description": {\n    "default": "Collects resources when you\'re not actively playing (triggers when queue is empty)",\n    "variants": {}\n  },\n  "targetType": "generator",\n  "targetId": "sample-pack.reactor",\n  "trigger": {\n    "kind": "commandQueueEmpty"\n  },\n  "cooldown": 10000,\n  "unlockCondition": { "kind": "always" },\n  "enabledByDefault": true,\n  "order": 3\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"example-4-event-driven-prestige",children:"Example 4: Event-Driven Prestige"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "sample-pack.auto-prestige-milestone",\n  "name": {\n    "default": "Milestone Prestige",\n    "variants": {}\n  },\n  "description": {\n    "default": "Automatically prestiges when you reach a major milestone (disabled by default for safety)",\n    "variants": {}\n  },\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "trigger": {\n    "kind": "event",\n    "eventId": "sample-pack.major-milestone-reached"\n  },\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "sample-pack.prestige-currency",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 1 }\n  },\n  "enabledByDefault": false,\n  "order": 10\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"validation-workflow",children:"Validation Workflow"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-add-automation-to-packjson",children:"Step 1: Add automation to pack.json"}),"\n",(0,t.jsxs)(n.p,{children:["Edit your ",(0,t.jsx)(n.code,{children:"content/pack.json"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "metadata": { /* ... */ },\n  "resources": [ /* ... */ ],\n  "generators": [ /* ... */ ],\n  "upgrades": [ /* ... */ ],\n  "automations": [\n    {\n      "id": "my-pack.my-automation",\n      "name": { "default": "My Automation" },\n      "description": { "default": "Does something cool" },\n      "targetType": "generator",\n      "targetId": "my-pack.my-generator",\n      "trigger": {\n        "kind": "interval",\n        "interval": { "kind": "constant", "value": 5000 }\n      },\n      "unlockCondition": { "kind": "always" }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-validate-schema",children:"Step 2: Validate schema"}),"\n",(0,t.jsx)(n.p,{children:"Run the content compiler:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pnpm generate\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Expected output:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u2713 Validated content pack: @my-pack (0 warnings)\n\u2713 Compiled content pack: @my-pack\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"If errors:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u2717 Validation failed for @my-pack/content/pack.json\n  - automations[0].trigger.interval: Required\n  - automations[0].targetId: Resource 'my-pack.my-generator' not found\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Fix errors and re-run ",(0,t.jsx)(n.code,{children:"pnpm generate"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"step-3-test-in-runtime",children:"Step 3: Test in runtime"}),"\n",(0,t.jsx)(n.p,{children:"Create an integration test to verify the automation fires:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { describe, it, expect } from 'vitest';\nimport { createAutomationSystem } from '@idle-engine/core';\nimport contentPack from './content/compiled/@my-pack.normalized.json';\n\ndescribe('My Automation', () => {\n  it('fires after interval elapses', () => {\n    const commandQueue = new MockCommandQueue();\n    const system = createAutomationSystem({\n      automations: contentPack.automations,\n      stepDurationMs: 100,\n      commandQueue,\n      resourceState: mockResourceState,\n    });\n\n    // Setup\n    system.setup({ events: mockEventBus });\n\n    // Tick 1: Automation fires immediately (first tick)\n    system.tick({ step: 1, events: mockEventBus });\n    expect(commandQueue.size).toBe(1);\n    expect(commandQueue.peek().type).toBe('TOGGLE_GENERATOR');\n\n    // Tick 2-49: No fire (cooldown/interval)\n    for (let step = 2; step <= 49; step++) {\n      system.tick({ step, events: mockEventBus });\n    }\n    expect(commandQueue.size).toBe(1); // Still just the first command\n\n    // Tick 50: Fires again (5000ms / 100ms = 50 steps)\n    system.tick({ step: 51, events: mockEventBus });\n    expect(commandQueue.size).toBe(2);\n  });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-4-commit-validated-automation",children:"Step 4: Commit validated automation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'git add packages/my-pack/content/pack.json\ngit add packages/my-pack/content/compiled/\ngit commit -m "feat(content): add auto-clicker automation"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-start-simple",children:"1. Start Simple"}),"\n",(0,t.jsx)(n.p,{children:"Begin with interval triggers before moving to complex threshold/event triggers."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Good:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": { "kind": "interval", "interval": { "kind": "constant", "value": 5000 } }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Avoid (initially):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": {\n    "kind": "resourceThreshold",\n    "resourceId": "pack.res1",\n    "comparator": "gte",\n    "threshold": { "kind": "linear", "base": 50, "rate": { "variable": "level" } }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"2-always-use-cooldowns-for-thresholdqueue-empty-triggers",children:"2. Always Use Cooldowns for Threshold/Queue-Empty Triggers"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Bad:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": { "kind": "commandQueueEmpty" }\n  // No cooldown - fires every tick when queue is empty!\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Good:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": { "kind": "commandQueueEmpty" },\n  "cooldown": 10000  // Fires max once per 10 seconds\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-disable-destructive-automations-by-default",children:"3. Disable Destructive Automations by Default"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Bad:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "enabledByDefault": true  // Auto-prestige enabled by default = bad UX\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Good:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "targetType": "system",\n  "systemTargetId": "system:prestige",\n  "enabledByDefault": false  // Player opts in\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"4-use-unlock-conditions-to-gate-advanced-automations",children:"4. Use Unlock Conditions to Gate Advanced Automations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "pack.advanced-auto",\n  "unlockCondition": {\n    "kind": "resourceThreshold",\n    "resourceId": "pack.prestige-currency",\n    "comparator": "gte",\n    "amount": { "kind": "constant", "value": 10 }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This prevents early-game players from being overwhelmed by automation options."}),"\n",(0,t.jsx)(n.h3,{id:"5-test-all-four-trigger-types",children:"5. Test All Four Trigger Types"}),"\n",(0,t.jsx)(n.p,{children:"Create at least one automation for each trigger type in your content pack:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2713 Interval (auto-clicker)"}),"\n",(0,t.jsx)(n.li,{children:"\u2713 Resource threshold (auto-upgrader)"}),"\n",(0,t.jsx)(n.li,{children:"\u2713 Command queue empty (idle collector)"}),"\n",(0,t.jsx)(n.li,{children:"\u2713 Event (milestone responder)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This ensures your content exercises all runtime behaviors."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"automation-not-firing",children:"Automation Not Firing"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Is automation unlocked? (",(0,t.jsx)(n.code,{children:"unlockCondition"})," met?)"]}),"\n",(0,t.jsxs)(n.li,{children:["Is automation enabled? (",(0,t.jsx)(n.code,{children:"enabledByDefault"})," or manually toggled?)"]}),"\n",(0,t.jsx)(n.li,{children:"Is cooldown active? (Recently fired?)"}),"\n",(0,t.jsxs)(n.li,{children:["For threshold triggers: Did resource actually ",(0,t.jsx)(n.strong,{children:"cross"})," threshold (transition)?"]}),"\n",(0,t.jsx)(n.li,{children:"For event triggers: Is event being published?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Debug:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const state = getAutomationState(automationSystem);\nconst autoState = state.get('my-pack.my-automation');\nconsole.log('Enabled:', autoState?.enabled);\nconsole.log('Unlocked:', autoState?.unlocked);\nconsole.log('Last fired:', autoState?.lastFiredStep);\nconsole.log('Cooldown expires:', autoState?.cooldownExpiresStep);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"automation-fires-too-frequently",children:"Automation Fires Too Frequently"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Solution:"})," Add or increase cooldown:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "cooldown": 10000  // Minimum 10 seconds between fires\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"automation-fires-on-every-tick-queue-empty-trigger",children:"Automation Fires on Every Tick (Queue Empty Trigger)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"})," Queue empty triggers fire every tick when queue is empty."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Solution:"})," Add cooldown:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "trigger": { "kind": "commandQueueEmpty" },\n  "cooldown": 5000  // Required!\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"threshold-trigger-not-detecting-crossing",children:"Threshold Trigger Not Detecting Crossing"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"})," Resource fluctuates around threshold, but automation doesn't fire."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cause:"})," Crossing detection requires transition from ",(0,t.jsx)(n.code,{children:"false \u2192 true"}),". If resource was already above threshold when automation was enabled, no crossing occurred."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Solution:"})," Ensure resource starts below threshold, or use interval trigger instead for periodic checks."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"API Documentation"}),": ",(0,t.jsx)(n.code,{children:"docs/automation-system-api.md"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Design Document"}),": ",(0,t.jsx)(n.code,{children:"docs/automation-execution-system-design.md"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Content Schema"}),": ",(0,t.jsx)(n.code,{children:"packages/content-schema/src/modules/automations.ts"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sample Pack"}),": ",(0,t.jsx)(n.code,{children:"packages/content-sample/content/pack.json"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Runtime Implementation"}),": ",(0,t.jsx)(n.code,{children:"packages/core/src/automation-system.ts"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},7678:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(9430);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);