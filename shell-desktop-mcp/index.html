<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-shell-desktop-mcp" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Shell Desktop MCP Guide | Idle Engine Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hansjm10.github.io/Idle-Game-Engine/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hansjm10.github.io/Idle-Game-Engine/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hansjm10.github.io/Idle-Game-Engine/shell-desktop-mcp"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Shell Desktop MCP Guide | Idle Engine Docs"><meta data-rh="true" name="description" content="Enable and use the embedded MCP server shipped with @idle-engine/shell-desktop"><meta data-rh="true" property="og:description" content="Enable and use the embedded MCP server shipped with @idle-engine/shell-desktop"><link data-rh="true" rel="icon" href="/Idle-Game-Engine/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hansjm10.github.io/Idle-Game-Engine/shell-desktop-mcp"><link data-rh="true" rel="alternate" href="https://hansjm10.github.io/Idle-Game-Engine/shell-desktop-mcp" hreflang="en"><link data-rh="true" rel="alternate" href="https://hansjm10.github.io/Idle-Game-Engine/shell-desktop-mcp" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Shell Desktop MCP Guide","item":"https://hansjm10.github.io/Idle-Game-Engine/shell-desktop-mcp"}]}</script><link rel="stylesheet" href="/Idle-Game-Engine/assets/css/styles.0ca8729c.css">
<script src="/Idle-Game-Engine/assets/js/runtime~main.626a59a2.js" defer="defer"></script>
<script src="/Idle-Game-Engine/assets/js/main.1672bcab.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/Idle-Game-Engine/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_sIzO" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Idle-Game-Engine/"><div class="navbar__logo"><img src="/Idle-Game-Engine/img/logo.svg" alt="Idle Engine Logo" class="themedComponent_yXCL themedComponent--light_m26g"><img src="/Idle-Game-Engine/img/logo.svg" alt="Idle Engine Logo" class="themedComponent_yXCL themedComponent--dark_DQxa"></div><b class="navbar__title text--truncate">Idle Engine</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Idle-Game-Engine/">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/hansjm10/Idle-Game-Engine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_zgE_"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_VTTy colorModeToggle_mrTp"><button class="clean-btn toggleButton_Qf8c toggleButtonDisabled_hCyI" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_j9FX lightToggleIcon_i4Ty"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_j9FX darkToggleIcon_B1fV"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_j9FX systemToggleIcon_d9Wq"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_xdO6"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_fCXc"><div class="docsWrapper_oodB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ZUBg" type="button"></button><div class="docRoot_zYbW"><aside class="theme-doc-sidebar-container docSidebarContainer_cQjy"><div class="sidebarViewport_guUk"><div class="sidebar_flRn"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_e0X4"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_WJIo menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/Idle-Game-Engine/"><span title="Getting Started" class="categoryLinkLabel_uVix">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/"><span title="Overview" class="linkLabel_Hws7">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/contributor-handbook"><span title="Contributor Handbook" class="linkLabel_Hws7">Contributor Handbook</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/role-index"><span title="Role Index" class="linkLabel_Hws7">Role Index</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/design-document-template"><span title="Design Document Template" class="linkLabel_Hws7">Design Document Template</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_WJIo menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/Idle-Game-Engine/idle-engine-design"><span title="Core Runtime" class="categoryLinkLabel_uVix">Core Runtime</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/idle-engine-design"><span title="Idle Engine Design Document" class="linkLabel_Hws7">Idle Engine Design Document</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/runtime-step-lifecycle"><span title="Runtime Step Lifecycle Alignment" class="linkLabel_Hws7">Runtime Step Lifecycle Alignment</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/runtime-command-queue-design"><span title="Runtime Command Queue Design" class="linkLabel_Hws7">Runtime Command Queue Design</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/controls-contract-design-issue-705"><span title="Controls Contract Design (Issue 705)" class="linkLabel_Hws7">Controls Contract Design (Issue 705)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/desktop-shell-webgpu-renderer-replay-design-issue-778"><span title="Desktop Shell + WebGPU Renderer + Replay (Issue 778)" class="linkLabel_Hws7">Desktop Shell + WebGPU Renderer + Replay (Issue 778)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Idle-Game-Engine/shell-desktop-mcp"><span title="Shell Desktop MCP Guide" class="linkLabel_Hws7">Shell Desktop MCP Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/runtime-event-pubsub-design"><span title="Runtime Event Pub/Sub Design" class="linkLabel_Hws7">Runtime Event Pub/Sub Design</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/runtime-event-bus-decisions"><span title="Runtime Event Bus Follow-up Decisions" class="linkLabel_Hws7">Runtime Event Bus Follow-up Decisions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/runtime-event-manifest-authoring"><span title="Runtime Event Manifest Authoring" class="linkLabel_Hws7">Runtime Event Manifest Authoring</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/tick-accumulator-coverage-design"><span title="Tick Accumulator Edge Case Coverage" class="linkLabel_Hws7">Tick Accumulator Edge Case Coverage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/resource-state-storage-design"><span title="Resource State Storage Design" class="linkLabel_Hws7">Resource State Storage Design</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Idle-Game-Engine/diagnostic-timeline-design"><span title="Diagnostic Timeline Design Document" class="linkLabel_Hws7">Diagnostic Timeline Design Document</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_WJIo menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Idle-Game-Engine/content-dsl-schema-design"><span title="Content Pipeline" class="categoryLinkLabel_uVix">Content Pipeline</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_WJIo menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Idle-Game-Engine/coverage/"><span title="Diagnostics &amp; Quality" class="categoryLinkLabel_uVix">Diagnostics &amp; Quality</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_WJIo menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Idle-Game-Engine/implementation-plan"><span title="Operations &amp; Process" class="categoryLinkLabel_uVix">Operations &amp; Process</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_BJhZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_NkVs"><div class="docItemContainer_WMJH"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_iCU1" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Idle-Game-Engine/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_HviJ"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Runtime</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Shell Desktop MCP Guide</span></li></ul></nav><div class="tocCollapsible_Kd7K theme-doc-toc-mobile tocMobile_Gv4l"><button type="button" class="clean-btn tocCollapsibleButton_ajnv">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Shell Desktop MCP Guide</h1></header>
<p>The Electron desktop shell (<code>@idle-engine/shell-desktop</code>) ships an embedded <a href="https://modelcontextprotocol.io/" target="_blank" rel="noopener noreferrer" class="">Model Context Protocol (MCP)</a> server for local, developer-only automation.</p>
<ul>
<li class="">Disabled by default.</li>
<li class="">Binds to <code>127.0.0.1</code> only.</li>
<li class="">Uses SSE (Server-Sent Events) over HTTP.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_pQUT" id="quickstart">Quickstart<a href="#quickstart" class="hash-link" aria-label="Direct link to Quickstart" title="Direct link to Quickstart" translate="no">​</a></h2>
<p>Start the desktop shell with MCP enabled:</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">IDLE_ENGINE_ENABLE_MCP_SERVER=1 pnpm --filter @idle-engine/shell-desktop run start</span><br></span></code></pre></div></div>
<p>By default the server listens on port <code>8570</code> and prints a line like:</p>
<div class="language-text codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-text codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">[shell-desktop] MCP server listening at http://127.0.0.1:8570/mcp/sse</span><br></span></code></pre></div></div>
<p>If port <code>8570</code> is already taken and you did not explicitly set <code>IDLE_ENGINE_MCP_PORT</code>/<code>--mcp-port</code>, the shell auto-falls back to <code>8571</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="headless-linux-xpra">Headless Linux (xpra)<a href="#headless-linux-xpra" class="hash-link" aria-label="Direct link to Headless Linux (xpra)" title="Direct link to Headless Linux (xpra)" translate="no">​</a></h3>
<p>For remote/headless hosts, use the workspace launcher:</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:headless</span><br></span></code></pre></div></div>
<p>This launcher:</p>
<ul>
<li class="">starts or reuses an xpra display (<code>:121</code> by default),</li>
<li class="">uses an Xorg-backed xpra server by default (<code>IDLE_ENGINE_XPRA_BACKEND=xorg</code>) so Linux hosts can use hardware GL instead of llvmpipe,</li>
<li class="">runs Electron with <code>--no-sandbox</code> (needed on many rootless hosts),</li>
<li class="">enables the Chromium Vulkan feature (<code>--enable-features=Vulkan</code>) for Linux WebGPU adapter bring-up,</li>
<li class="">enables MCP by default (<code>http://127.0.0.1:8570/mcp/sse</code>).</li>
</ul>
<p>Smoke-test the MCP server from the same host:</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:mcp:smoke</span><br></span></code></pre></div></div>
<p>Stop the xpra session:</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:headless:stop</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="fast-gpu-checks">Fast GPU checks<a href="#fast-gpu-checks" class="hash-link" aria-label="Direct link to Fast GPU checks" title="Direct link to Fast GPU checks" translate="no">​</a></h3>
<p>Use these after launch to confirm hardware bring-up:</p>
<p>Inside Electron DevTools:</p>
<div class="language-js codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-js codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gpu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">requestAdapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> a</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">name</span><br></span></code></pre></div></div>
<p>On the host CLI:</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">vulkaninfo --summary</span><br></span></code></pre></div></div>
<p>Expected host signal: <code>GPU0</code> should report <code>Intel(R) Arc(tm) A310 Graphics (DG2)</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" translate="no">​</a></h3>
<ul>
<li class="">Enablement:<!-- -->
<ul>
<li class="">Env var: <code>IDLE_ENGINE_ENABLE_MCP_SERVER=1</code></li>
<li class="">Arg: <code>--enable-mcp-server</code></li>
</ul>
</li>
<li class="">Port override:<!-- -->
<ul>
<li class="">Env var: <code>IDLE_ENGINE_MCP_PORT=8571</code></li>
<li class="">Arg: <code>--mcp-port=8571</code></li>
</ul>
</li>
<li class="">Asset root override (for non-sample games):<!-- -->
<ul>
<li class="">Env var: <code>IDLE_ENGINE_COMPILED_ASSETS_ROOT=/abs/path/to/your/content/compiled</code></li>
</ul>
</li>
<li class="">Headless gateway mode:<!-- -->
<ul>
<li class="">Env var: <code>IDLE_ENGINE_MCP_GATEWAY_MODE=1</code> (defaults shell-desktop MCP port to <code>8571</code> when not explicitly set)</li>
</ul>
</li>
</ul>
<p>The endpoint is <code>/mcp/sse</code> (with <code>/mcp</code> accepted as an alias for streamable-HTTP clients).</p>
<h2 class="anchor anchorTargetStickyNavbar_pQUT" id="always-on-gateway-codex-friendly">Always-On Gateway (Codex-friendly)<a href="#always-on-gateway-codex-friendly" class="hash-link" aria-label="Direct link to Always-On Gateway (Codex-friendly)" title="Direct link to Always-On Gateway (Codex-friendly)" translate="no">​</a></h2>
<p>If you want Codex/Cursor MCP startup to succeed even before shell-desktop is running, run the MCP gateway on <code>8570</code> and let shell-desktop use <code>8571</code>.</p>
<p>Terminal A (keep running):</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:mcp:gateway</span><br></span></code></pre></div></div>
<p>Background daemon mode (recommended for frequent Codex usage):</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:mcp:gateway:daemon:start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:mcp:gateway:daemon:status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:mcp:gateway:daemon:stop</span><br></span></code></pre></div></div>
<p>The daemon stores state in:</p>
<ul>
<li class="">PID file: <code>/tmp/idle-engine-shell-desktop-mcp-gateway.pid</code></li>
<li class="">Log file: <code>/tmp/idle-engine-shell-desktop-mcp-gateway.log</code></li>
</ul>
<p>Optional overrides for the gateway:</p>
<ul>
<li class=""><code>IDLE_ENGINE_MCP_PORT</code> (gateway listen port, default <code>8570</code>)</li>
<li class=""><code>IDLE_ENGINE_MCP_BACKEND_PORT</code> (shell-desktop backend port, default <code>8571</code>)</li>
<li class=""><code>IDLE_ENGINE_MCP_BACKEND_URL</code> (full backend URL, overrides backend port; must use <code>http://</code> loopback)</li>
</ul>
<p>Terminal B (start shell-desktop later, backend on 8571):</p>
<div class="language-bash codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-bash codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm shell:desktop:headless:gateway-backend</span><br></span></code></pre></div></div>
<p>Behavior:</p>
<ul>
<li class="">Gateway on <code>8570</code> is always reachable.</li>
<li class=""><code>health</code> returns <code>ok: false</code> while shell-desktop backend is down.</li>
<li class="">Once shell-desktop comes up on <code>8571</code>, the gateway proxies all MCP calls and <code>health</code> returns backend <code>ok: true</code>.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_pQUT" id="tool-surface-mvp">Tool surface (MVP)<a href="#tool-surface-mvp" class="hash-link" aria-label="Direct link to Tool surface (MVP)" title="Direct link to Tool surface (MVP)" translate="no">​</a></h2>
<ul>
<li class=""><code>health</code>: basic health/capabilities snapshot.</li>
<li class=""><code>sim</code>: <code>sim.status</code>, <code>sim.start</code>, <code>sim.stop</code>, <code>sim.pause</code>, <code>sim.resume</code>, <code>sim.step</code>, <code>sim.enqueue</code>.</li>
<li class=""><code>window</code>: <code>window.info</code>, <code>window.resize</code>, <code>window.devtools</code>, <code>window.screenshot</code> (bounded, returns base64 PNG).</li>
<li class=""><code>input</code>: <code>input.controlEvent</code> (reuses <code>ShellControlEvent</code> semantics).</li>
<li class=""><code>asset</code>: <code>asset.list</code>, <code>asset.read</code> (scoped to compiled assets root with traversal protection).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_pQUT" id="client-setup">Client setup<a href="#client-setup" class="hash-link" aria-label="Direct link to Client setup" title="Direct link to Client setup" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="cursor">Cursor<a href="#cursor" class="hash-link" aria-label="Direct link to Cursor" title="Direct link to Cursor" translate="no">​</a></h3>
<p>Create <code>.cursor/mcp.json</code> (repo-local) and point it at the SSE URL:</p>
<div class="language-json codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-json codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;mcpServers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;idle-engine-shell-desktop&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://127.0.0.1:8570/mcp/sse&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Restart Cursor (or reload MCP servers) after editing the file.</p>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="claude-desktop">Claude Desktop<a href="#claude-desktop" class="hash-link" aria-label="Direct link to Claude Desktop" title="Direct link to Claude Desktop" translate="no">​</a></h3>
<p>Claude Desktop configures remote MCP servers via its UI (Settings → Connectors). Add a custom MCP server that points at:</p>
<div class="language-text codeBlockContainer_QSSF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_YGpJ"><pre tabindex="0" class="prism-code language-text codeBlock_Ap7y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_zA5F"><span class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:8570/mcp/sse</span><br></span></code></pre></div></div>
<p>If your Claude Desktop build does not support remote MCP servers (or refuses <code>http://localhost</code> URLs), use Cursor or an SSE→stdio bridge tool and then configure the bridge as a local stdio MCP server in Claude Desktop.</p>
<h2 class="anchor anchorTargetStickyNavbar_pQUT" id="example-workflows">Example workflows<a href="#example-workflows" class="hash-link" aria-label="Direct link to Example workflows" title="Direct link to Example workflows" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="regression-testing">Regression testing<a href="#regression-testing" class="hash-link" aria-label="Direct link to Regression testing" title="Direct link to Regression testing" translate="no">​</a></h3>
<p>Prompt template:</p>
<blockquote>
<p>Start the sim, pause it, step 120 frames, take a screenshot, and report <code>sim.status</code> plus the screenshot bytes count.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="debugging">Debugging<a href="#debugging" class="hash-link" aria-label="Direct link to Debugging" title="Direct link to Debugging" translate="no">​</a></h3>
<p>Prompt template:</p>
<blockquote>
<p>Call <code>window.info</code>, open devtools via <code>window.devtools</code>, then <code>sim.status</code>. If the sim is running, pause it and step 1 frame. Summarize what changed.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_pQUT" id="content-iteration">Content iteration<a href="#content-iteration" class="hash-link" aria-label="Direct link to Content iteration" title="Direct link to Content iteration" translate="no">​</a></h3>
<p>Prompt template:</p>
<blockquote>
<p>List assets under the compiled assets root (limit to the top 25 entries). If you find any JSON content, read one file (max 50KB) and summarize what knobs it exposes. Then enqueue a command that would exercise the change, and step 10 frames.</p>
</blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_zkN7"><a href="https://github.com/hansjm10/Idle-Game-Engine/edit/main/docs/../../docs/shell-desktop-mcp.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_URLU" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_DCA4"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Idle-Game-Engine/desktop-shell-webgpu-renderer-replay-design-issue-778"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Desktop Shell + WebGPU Renderer + Replay (Issue 778)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Idle-Game-Engine/runtime-event-pubsub-design"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Runtime Event Pub/Sub Design</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_7BTH thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#quickstart" class="table-of-contents__link toc-highlight">Quickstart</a><ul><li><a href="#headless-linux-xpra" class="table-of-contents__link toc-highlight">Headless Linux (xpra)</a></li><li><a href="#fast-gpu-checks" class="table-of-contents__link toc-highlight">Fast GPU checks</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li></ul></li><li><a href="#always-on-gateway-codex-friendly" class="table-of-contents__link toc-highlight">Always-On Gateway (Codex-friendly)</a></li><li><a href="#tool-surface-mvp" class="table-of-contents__link toc-highlight">Tool surface (MVP)</a></li><li><a href="#client-setup" class="table-of-contents__link toc-highlight">Client setup</a><ul><li><a href="#cursor" class="table-of-contents__link toc-highlight">Cursor</a></li><li><a href="#claude-desktop" class="table-of-contents__link toc-highlight">Claude Desktop</a></li></ul></li><li><a href="#example-workflows" class="table-of-contents__link toc-highlight">Example workflows</a><ul><li><a href="#regression-testing" class="table-of-contents__link toc-highlight">Regression testing</a></li><li><a href="#debugging" class="table-of-contents__link toc-highlight">Debugging</a></li><li><a href="#content-iteration" class="table-of-contents__link toc-highlight">Content iteration</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Idle-Game-Engine/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/Idle-Game-Engine/contributor-handbook">Contributor Handbook</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/hansjm10/Idle-Game-Engine/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issue Tracker<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_zgE_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/hansjm10/Idle-Game-Engine" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_zgE_"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Idle Engine.</div></div></div></footer></div>
</body>
</html>