# @idle-engine/content-sample

Sample content pack used by the prototype milestone. The definitions here will ultimately be generated by the content DSL compiler and referenced by automated validation tests. See the [Content DSL Usage Guidelines](../../docs/content-dsl-usage-guidelines.md) for the naming, versioning, and compatibility rules this package demonstrates in practice. The pack slug is `@idle-engine/sample-pack`, and all content IDs use the `sample-pack.*` namespace so they stay unique across the workspace.

## Content validation

- Authoring sources live in `content/pack.json`. Run `pnpm generate` after editing content to rebuild the compiled artifacts under `content/compiled/` and `src/generated/`.
- Follow the usage guide’s rules for slug casing and Semantic Versioning—`content/pack.json` keeps the scoped pack slug and `metadata.engine` range explicit so regeneration stays deterministic.
- The generated module (`src/generated/@idle-engine/sample-pack.generated.ts`) rehydrates a frozen `NormalizedContentPack`, exposes digest and artifact hash metadata, and ships positional indices so runtime consumers avoid recomputing lookup tables.
- `src/index.ts` re-exports the generated pack, digest, indices, and summary. It throws during import when the compiler recorded schema warnings, keeping the sample pack warning-free by default.
- The compiler emits structured `content_pack.*` log lines; treat any new warning as a regression and resolve it before committing.

## Package exports

The package.json exports configuration provides multiple entry points:

- **Main export** (`"."`) - The primary entry point at `dist/index.js` that re-exports the generated content pack, digest, indices, and summary metadata. Use this for standard imports: `import { samplePack } from '@idle-engine/content-sample'`
- **Dist wildcard** (`"./dist/*"`) - Direct access to compiled TypeScript output for advanced use cases
- **Generated sources** (`"./src/generated/*"`) - Forward-looking infrastructure for potential direct imports of generated content files from build tools like Vite. **Currently unused externally**—the generated module is only imported internally via `src/index.ts`. This export was added to support proper ESM module resolution and Vite path aliasing, but no packages currently import from this path.

## Runtime event manifests

Custom runtime events for the sample pack live in `content/event-types.json`. After editing the manifest (or associated schema files) run `pnpm generate` from the repository root to regenerate:

- the consolidated manifest hash used by the command recorder
- `packages/core/src/events/runtime-event-manifest.generated.ts`
- the `ContentRuntimeEventType` union exported by `@idle-engine/core`

`sampleEventDefinitions` and `sampleEventTypes` in `src/index.ts` mirror the generated output to keep tests and examples in sync with the manifest. If you add new event schemas, regenerate the manifest and commit the updated compiler artifacts alongside the changes.

## Progression sample data

The pack includes minimal but representative generators and upgrades to support the progression UI examples described in docs (see `docs/build-resource-generator-upgrade-ui-components-design.md`). Key entries and IDs:

- Generators: `sample-pack.reactor`, `sample-pack.harvester`
- Upgrades:
  - `sample-pack.reactor-insulation` (generator: reactor) — multiplies reactor output, unlocks at ≥50 Energy
  - `sample-pack.reactor-overclock` (generator: reactor) — multiplies reactor output, requires `reactor-insulation`, unlocks at ≥100 Energy
  - `sample-pack.harvester-efficiency` (generator: harvester) — multiplies harvester output, visible at ≥20 Crystal and unlocks at Harvester level ≥1

After editing content under `content/`, run `pnpm generate` to refresh `content/compiled/` and `src/generated/` artifacts and commit the changes. Keep IDs stable and names localized via the `name` field (default locale `en-US`).
